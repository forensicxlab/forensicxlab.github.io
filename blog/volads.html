<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">📦 Volatility3 : Alternate Data Stream Scan | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://forensicxlab.github.io/blog/volads"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="📦 Volatility3 : Alternate Data Stream Scan | Forensicxlab"><meta data-rh="true" name="description" content="Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis."><meta data-rh="true" property="og:description" content="Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-11-18T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="DFIR,Volatility,Memory Forensics"><link data-rh="true" rel="canonical" href="https://forensicxlab.github.io/blog/volads"><link data-rh="true" rel="alternate" href="https://forensicxlab.github.io/blog/volads" hreflang="en"><link data-rh="true" rel="alternate" href="https://forensicxlab.github.io/blog/volads" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://forensicxlab.github.io/blog/volads","mainEntityOfPage":"https://forensicxlab.github.io/blog/volads","url":"https://forensicxlab.github.io/blog/volads","headline":"📦 Volatility3 : Alternate Data Stream Scan","name":"📦 Volatility3 : Alternate Data Stream Scan","description":"Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis.","datePublished":"2023-11-18T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://forensicxlab.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.98b055e0.css">
<script src="/assets/js/runtime~main.e96229c2.js" defer="defer"></script>
<script src="/assets/js/main.d12984e2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/voliat">📦 Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/volads">📦 Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hibernation">📘 Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">📘 Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">🔦 Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/keepass">📦 Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/slug">Title</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">🔦 Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">🧬 Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anydesk">📦 Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">📦 Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">📦 Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">🖋 Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volaslib">📘 Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">📄 Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">📦 Volatility3 : Alternate Data Stream Scan</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-11-18T00:00:00.000Z">November 18, 2023</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-master-file-table">The Master File Table<a href="#the-master-file-table" class="hash-link" aria-label="Direct link to The Master File Table" title="Direct link to The Master File Table">​</a></h2>
<p>Forensic analysts utilize the MFT extensively as it provides a wealth of information during investigations. Every file or directory in an NTFS volume holds an entry in the MFT. Each MFT entry, also known as a record. By examining the MFT, one can acquire valuable insights into a system&#x27;s file activity, including deleted files or folders, timestamps, and access permissions. This information can be used to determine which files were created, accessed, modified, or deleted, and when these actions occurred for example.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-mft-records">The MFT records<a href="#the-mft-records" class="hash-link" aria-label="Direct link to The MFT records" title="Direct link to The MFT records">​</a></h3>
<p>MFT entries or records are typically 1,024 bytes in size and are divided into several fields. Here is a very nice representation by Jaked Atinkson of an MFT record.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/mftfilerecord-e4ce1712bb2c8229c41d79242b53edb4.png" title="MFT Record" width="1600" height="1219" class="img_ev3q"></p>
<ul>
<li>
<p><strong>Header:</strong> Holds information about the record itself, such as its address and links to other records.</p>
</li>
<li>
<p><strong>File Attributes:</strong> Reveal crucial details about the file or directory, including its name, timestamp, size, and permission. File attributes may either be resident, meaning they are stored directly within the MFT record, or non-resident, indicating that they are stored elsewhere on the disk with only a reference in the MFT entry.</p>
</li>
</ul>
<p>The <strong>$DATA</strong> attribute typically contains the actual contents of the file, the data can be <strong>resident</strong> or <strong>non-resident</strong>.</p>
<p>A resident $DATA attribute means that the data is stored directly within the MFT record. This is usually the case for small files, where the data can fit within the record. The data will be stored directly in the MFT entry along with the metadata. Whereas a non-resident $DATA attribute is present when the file is too large for the record and therefore will contain a pointer to the location on the disk where the data is actually stored.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alternate-data-streams-ads">Alternate Data Streams (ADS)<a href="#alternate-data-streams-ads" class="hash-link" aria-label="Direct link to Alternate Data Streams (ADS)" title="Direct link to Alternate Data Streams (ADS)">​</a></h3>
<p>NTFS is providing a feature called <strong>alternate data stream</strong> (ADS). Used by Windows, it consists of another stream of data that can be attached to a file without changing its size or content.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="data:image/gif;base64,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" title="ADS" width="492" height="234" class="img_ev3q"></p>
<p>One example of usage of this feature by Microsoft is the <strong>Zone.Identifier</strong> ADS. It is employed by Internet Explorer and other Windows applications to identify where a file was downloaded from and from a potentially unsafe zone (like the internet). This artefact is known to be very useful for forensics investigators. But it was also seen in the wild that some threat actors are abusing the ADS to hide malicious payloads. The ADS can be detected by the fact that a given record is holding multiple $DATA attributes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-volatility3-plugin">Creating a volatility3 plugin<a href="#creating-a-volatility3-plugin" class="hash-link" aria-label="Direct link to Creating a volatility3 plugin" title="Direct link to Creating a volatility3 plugin">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-mftscan-plugin">The MFTScan plugin<a href="#the-mftscan-plugin" class="hash-link" aria-label="Direct link to The MFTScan plugin" title="Direct link to The MFTScan plugin">​</a></h3>
<p>Even if the MFT entries are stored on disk, the latter also cached in memory, which motivated the creation of the “MFTScan” volatility3 plugin. This plugin is scanning for $STANDARD_INFORMATION and $FILE_NAME attributes providing a view of the files that were present in the volatile memory of the target system.</p>
<div class="language-zsh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-zsh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~» ./vol.py -r pretty  -f Triage-Memory.mem  windows.mftscan.MFTScan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Formatting...0.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   |         Offset | Record Type | Record Number | Link Count |  MFT Type |         Permissions |       Attribute Type |                     Created | ...|  Filename</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*  | 0xf88004477450 |        FILE |        146309 |          2 | Directory |                 N/A | STANDARD_INFORMATION | 2019-03-21 15:47:00.000000  | ...| N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">** | 0xf880044774b0 |        FILE |        146309 |          2 | Directory |                 0x0 |            FILE_NAME | 2019-03-21 15:47:00.000000  | ...| AM1080~1.175</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*  | 0xf88004477850 |        FILE |        146310 |          2 |      File |                 N/A | STANDARD_INFORMATION | 2019-03-21 15:47:00.000000  | ...| N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">** | 0xf880044778b0 |        FILE |        146310 |          2 |      File |             Archive |            FILE_NAME | 2019-03-21 15:47:00.000000  | ...| cfgmgr32.dll</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">** | 0xf88004477928 |        FILE |        146310 |          2 |      File |             Archive |            FILE_NAME | 2019-03-21 15:47:00.000000  | ...| cfgmgr32.dll</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*  | 0xf88004477c50 |        FILE |        146311 |          2 | Directory |                 N/A | STANDARD_INFORMATION | 2019-03-21 15:47:00.000000  | ...| N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">** | 0xf88004477cb0 |        FILE |        146311 |          2 | Directory |                 0x0 |            FILE_NAME | 2019-03-21 15:47:00.000000  | ...| AMEA70~1.175</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-ads-plugin">The ADS plugin<a href="#the-ads-plugin" class="hash-link" aria-label="Direct link to The ADS plugin" title="Direct link to The ADS plugin">​</a></h3>
<p>A new addition the capabilities of the MFT analysis in memory would be to scan for ADS inside the records looking for others $DATA attributes that are resident. This plugin was therefore created to detect ADS and extract the resident data to present it to the analyst. The output shows the file associated with the ADS found as well as a Hexdump and disassembled view. The latter could potentially help an analyst to identify a malicious code.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="proof-of-concept">Proof Of Concept<a href="#proof-of-concept" class="hash-link" aria-label="Direct link to Proof Of Concept" title="Direct link to Proof Of Concept">​</a></h4>
<p>The  example below is showing the output of the plugin. We can see that the “putty-64bit-0.70-installer.msi” for example was downloaded from the internet (see ZoneID=3 in the hexdump column).</p>
<div class="language-zsh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-zsh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~» ./vol.py -r pretty  -f Triage-Memory.mem  windows.mftscan.ADS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Formatting...0.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |         Offset | Record Type | Record Number | MFT Type |                      Filename |    ADS Filename |                          Hexdump |                                          Disasm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* | 0xf98001423650 |        FILE |         78477 |     DATA | putty-64bit-0.70-installer.msi | Zone.Identifier |                                  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 | 5b 5a 6f 6e 65 54 72 61 [ZoneTra |                             0x0:    pop     rbx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 | 6e 73 66 65 72 5d 0d 0a nsfer].. |                             0x1:    pop     rdx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 | 5a 6f 6e 65 49 64 3d 33 ZoneId=3 |             0x2:    outsd   dx, dword ptr [rsi]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |              0x3:    outsb   dx, byte ptr [rsi]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                             0x4:    push    rsp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                            0x6:    jb      0x69</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |              0x8:    outsb   dx, byte ptr [rsi]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                            0x9:    jae     0x71</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                            0xb:    jb      0x6b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                 0xe:    or      eax, 0x6e6f5a0a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* | 0xf98001432e40 |        FILE |         78539 |     DATA | PackageManagement_x64.msi     | Zone.Identifier |                                  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 | 5b 5a 6f 6e 65 54 72 61 [ZoneTra |                             0x0:    pop     rbx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 | 6e 73 66 65 72 5d 0d 0a nsfer].. |                             0x1:    pop     rdx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 | 5a 6f 6e 65 49 64 3d 33 ZoneId=3 |             0x2:    outsd   dx, dword ptr [rsi]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |              0x3:    outsb   dx, byte ptr [rsi]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                             0x4:    push    rsp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                            0x6:    jb      0x69</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |              0x8:    outsb   dx, byte ptr [rsi]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                            0x9:    jae     0x71</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                            0xb:    jb      0x6b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  |                |             |               |          |                               |                 |                                  |                 0xe:    or      eax, 0x6e6f5a0a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The ability to scan for Alternate Data Stream is a good way to identify whether a file was downloaded from the internet or not. One can also identify malicious hidden data to help analysts upon an investigation to shed light onto the attack chain. The source code of this plugin can be found on Github: <a href="https://github.com/forensicxlab/volatility3/tree/feature/ADS" target="_blank" rel="noopener noreferrer">https://github.com/forensicxlab/volatility3/tree/feature/ADS</a>, a pull request will be made to the volatility3 foundation for a potential integration to the framework.</p>
<blockquote>
<p>Do not hesitate to reach me at <a href="mailto:felix.guyard@forensicxlab.com" target="_blank" rel="noopener noreferrer">felix.guyard@forensicxlab.com</a> to enhance this article or to comment on the integration to the volatility framework.</p>
</blockquote></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/dfir">DFIR</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/volatility">Volatility</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory Forensics</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/voliat"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">📦 Volatility3 : Import Address Table</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/hibernation"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">📘 Volatility3: Modern Windows Hibernation file analysis</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-master-file-table" class="table-of-contents__link toc-highlight">The Master File Table</a><ul><li><a href="#the-mft-records" class="table-of-contents__link toc-highlight">The MFT records</a></li><li><a href="#alternate-data-streams-ads" class="table-of-contents__link toc-highlight">Alternate Data Streams (ADS)</a></li></ul></li><li><a href="#creating-a-volatility3-plugin" class="table-of-contents__link toc-highlight">Creating a volatility3 plugin</a><ul><li><a href="#the-mftscan-plugin" class="table-of-contents__link toc-highlight">The MFTScan plugin</a></li><li><a href="#the-ads-plugin" class="table-of-contents__link toc-highlight">The ADS plugin</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Forensicxlab</div></div></div></footer></div>
</body>
</html>