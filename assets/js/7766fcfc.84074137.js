"use strict";(self.webpackChunkexhume=self.webpackChunkexhume||[]).push([[4693],{2762:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/steam_1-d5e774bf4197e16ad2ebfddcdeabd52e.png"},3595:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var i=n(4314),s=n(4848),a=n(8453);const o={slug:"steam",title:"\ud83d\udd26 Video Games Forensics - Steam",authors:["k1nd0ne"],tags:["DFIR","Steam","Linux","Windows","Mac","Video Games"]},r="Steam integrated browser artifacts",l={authorsImageUrls:[void 0]},c=[{value:"Steam user account information",id:"steam-user-account-information",level:2},{value:"Recovering the user&#39;s Steam id",id:"recovering-the-users-steam-id",level:3},{value:"Friends",id:"friends",level:2},{value:"Owned and Installed games",id:"owned-and-installed-games",level:2},{value:"Connected device(s)",id:"connected-devices",level:2},{value:"Application logs",id:"application-logs",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Video games have become an integral part of our culture, providing entertainment and social opportunities. Unfortunately, criminals have also begun to take advantage of modern video games and their ever-growing capabilities to conduct illegal activities. Organized crime, hate spread, and pedophilia have been documented occurring within games, opening up the potential to a world of cybercrime."}),"\n",(0,s.jsx)(t.p,{children:"Digital forensics on the Steam application can be especially useful for law enforcement in tracking down and prosecuting these cybercriminals. By investigating video game applications like Steam, digital footprints that can be used to link individuals to games, transactions, and even other players. Once these links are established, they can then used to build a case against the perpetrators. In this article, the reader will learn about some artifacts that can give releavant information left on a disk during a post-mortem analysis."}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note :"})," All of the information about the investigated user displayed in the following findings are redacted."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"A dedicated web browser is built into the Steam software (the Steam application is just another derived version of chromium). It can even be accessed while playing in game. It is a convinient way for gamers to look for something online without quitting the game. Therefore, interesting artifacts can be retrieved in the same way a digital forensics investigator would do when performing a Chrome analysis."}),"\n",(0,s.jsx)(t.p,{children:"Locations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Windows 10 : ",(0,s.jsx)(t.code,{children:"%UserProfile%\\AppData\\Local\\Steam\\htmlcache\\"})]}),"\n",(0,s.jsxs)(t.li,{children:["Ubuntu : ",(0,s.jsx)(t.code,{children:"$HOME/.local/share/Steam/config/htmlcache/"})]}),"\n",(0,s.jsxs)(t.li,{children:["MacOS : ",(0,s.jsx)(t.code,{children:"$HOME/Library/Application Support/Steam/config/htmlcache/"})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["By using opensource investigation tools like Hindsight ",(0,s.jsx)(t.sup,{children:(0,s.jsx)(t.a,{href:"#user-content-fn-1-ffd9e8",id:"user-content-fnref-1-ffd9e8","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),", one can extract browser Cookies (and decrypt them), Cache, Session Storage, Local Storage, History, Visited Links, etc..."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(2762).A+"",title:"HindSight",width:"1187",height:"383"})}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["On Windows, a base64 encoded DPAPI key can be recovered in the following path : ",(0,s.jsx)(t.code,{children:"%UserProfile%\\AppData\\Local\\Steam\\htmlcache\\LocalProfs.json"})]}),"\n"]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"alt text",src:n(5457).A+"",title:"DPAPI",width:"917",height:"128"})," DPAPI encryption is based upon user password, therefore one may be able to retrive the cleartext value of encrypted cookies. Learn more about DPAPI here : ",(0,s.jsx)(t.a,{href:"https://www.passcape.com/index.php?section=docsys&cmd=details&id=28#32",children:"https://www.passcape.com/index.php?section=docsys&cmd=details&id=28#32"})]}),"\n"]}),"\n",(0,s.jsx)(t.h1,{id:"miscellaneous-friends-installed-games-playtime-and-game-sessions",children:"Miscellaneous: Friends, Installed games, Playtime and game sessions"}),"\n",(0,s.jsx)(t.p,{children:"As a digital forensics investigator, you might be interested about the Steam friends of the user you are investigating, the games he played and for how long.\nAll of the Steam users and games have unique IDs used to talk to the servers and get various information."}),"\n",(0,s.jsx)(t.h2,{id:"steam-user-account-information",children:"Steam user account information"}),"\n",(0,s.jsx)(t.p,{children:"The user has two assigned unique IDs :"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The Steam ID : Used to identify a profile on the Steam community website."}),"\n",(0,s.jsx)(t.li,{children:"The account ID : Used to link the account to other various information (subscription, owned games,...)"}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"recovering-the-users-steam-id",children:"Recovering the user's Steam id"}),"\n",(0,s.jsx)(t.p,{children:"Locations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Windows 10: ",(0,s.jsx)(t.code,{children:"%programfiles(x86)%\\Steam\\config\\loginusers.vdf"})]}),"\n",(0,s.jsxs)(t.li,{children:["Ubuntu: ",(0,s.jsx)(t.code,{children:"$HOME/.local/share/Steam/config/loginusers.vdf"})]}),"\n",(0,s.jsxs)(t.li,{children:["MacOS: ",(0,s.jsx)(t.code,{children:"$HOME/Library/Application Support/Steam/config/loginusers.vdf"})]}),"\n"]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note :"})," The VDF file format is the Valve's KeyValue text file format. It is similar to the json file format."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Content:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-JSON",children:'"users"\n{\n\t"76561199524123422232"\n\t{\n\t\t"AccountName"\t\t"Jean"\n\t\t"PersonaName"\t\t"superjean"\n\t\t"RememberPassword"\t\t"1"\n\t\t"WantsOfflineMode"\t\t"0"\n\t\t"SkipOfflineModeWarning"\t\t"0"\n\t\t"AllowAutoLogin"\t\t"1"\n\t\t"MostRecent"\t\t"1"\n\t\t"Timestamp"\t\t"1688740727"\n\t}\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Using the Steam ID, one can retrive more information about the community profile by browsing to ",(0,s.jsx)(t.code,{children:"https://steamcommunity.com/actions/ajaxresolveusers?steamids=[STEAM_ID]"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"JSON result:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-JSON",children:'[\n    {\n    "steamid":"765231213229864",\n    "accountid":15623422136,\n    "persona_name":"superjean",\n    "avatar_url":"0000000000000000000000000000000000000000",\n    "profile_url":"",\n    "persona_state":1,\n    "city":"Athabasca",\n    "state":"Alberta",\n    "country":"CA",\n    "real_name":"Jean Pierre",\n    "is_friend":false,\n    "friends_in_common":0\n    }\n]\n'})}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note :"})," there is no need to be authenticated to Steam to retrive those data."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"friends",children:"Friends"}),"\n",(0,s.jsx)(t.p,{children:"Locations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Windows 10 : ",(0,s.jsx)(t.code,{children:"%programfiles(x86)%\\Steam\\userdata\\[account ID]\\config\\localconfig.vdf"})]}),"\n",(0,s.jsxs)(t.li,{children:["Ubuntu : ",(0,s.jsx)(t.code,{children:"$HOME/.local/share/Steam/userdata/[account ID]/config/localconfig.vdf"})]}),"\n",(0,s.jsxs)(t.li,{children:["MacOS : ",(0,s.jsx)(t.code,{children:"$HOME/Library/Application Support/Steam/userdata/[account ID]/config/localconfig.vdf"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:'The user\'s friend list can be found at the begining of the file under the "friends" section.'}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-JSON",children:'[...]\n\t"friends"\n\t{\n\t\t"1232434343"\n\t\t{\n\t\t\t"NameHistory"\n\t\t\t{\n\t\t\t\t"0"\t\t"superjean"\n\t\t\t}\n\t\t\t"avatar"\t\t"8376ba022787d9a86309b7b2b68e9994056c06e7"\n\t\t\t"name"\t\t"superjean"\n\t\t}\n\t\t"PersonaName"\t\t"superjean"\n\t\t"communitypreferences"\t\t"1800280130013800"\n\n\t\t"11132322"\n\t\t{\n\t\t\t"name"\t\t"Pierre"\n\t\t\t"NameHistory"\n\t\t\t{\n\t\t\t\t"0"\t\t"Pierre"\n\t\t\t}\n\t\t\t"avatar"\t\t"9f0c155db20221ade1ca5e1de4a705049f540bac"\n\t\t}\n[...]\n    }\n'})}),"\n",(0,s.jsx)(t.p,{children:"The first ID is always the account ID of the user you are investigating (the user is friend with himself). Next, all of his friends are listed alongside with their ID."}),"\n",(0,s.jsx)(t.p,{children:"To recover more information about the user's friend one may use the following request :"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://steam-chat.com/miniprofile/ACCOUNT_ID/json/",children:"https://steam-chat.com/miniprofile/ACCOUNT_ID/json/"})}),"\n",(0,s.jsx)(t.p,{children:"This request has to be made online; it is usefull to see if the user changed his informations when performing the post-mortem analysis."}),"\n",(0,s.jsx)(t.p,{children:"With this, the investigator will be able to confirm :"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The user's friend name (may have changed  when performing the post-mortem analysis)"}),"\n",(0,s.jsx)(t.li,{children:"Retrive the profile picture (can be great to build a graph)."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"owned-and-installed-games",children:"Owned and Installed games"}),"\n",(0,s.jsxs)(t.p,{children:["Inside ",(0,s.jsx)(t.code,{children:"localconf.vdf"})," it is also indicated the games owned by the user, the last play time and how much time he spend on each game:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-JSON",children:'[...]\n"Software"\n\t{\n\t\t"valve"\n\t\t{\n\t\t\t"Steam"\n\t\t\t{\n\t\t\t\t"apps"\n\t\t\t\t{\n\t\t\t\t\t"7"\n\t\t\t\t\t{\n\t\t\t\t\t\t"cloud"\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t"last_sync_state"\t\t"synchronized"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t"760"\n\t\t\t\t\t{\n\t\t\t\t\t\t"cloud"\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t"quota_bytes"\t\t"20000000000"\n\t\t\t\t\t\t\t"quota_files"\t\t"50000"\n\t\t\t\t\t\t\t"used_bytes"\t\t"2177105"\n\t\t\t\t\t\t\t"used_files"\t\t"12"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n[...]\n                }\n            }\n        }\n    }\n'})}),"\n",(0,s.jsx)(t.p,{children:"Making a similar request with the Steam app id, one can retrive the metadata about the installed game to make better user profiling:"}),"\n",(0,s.jsxs)(t.p,{children:["Request : ",(0,s.jsx)(t.code,{children:"https://store.steampowered.com/api/libraryappdetails/?appid=[STEAM_APP_ID]&l=english"})]}),"\n",(0,s.jsx)(t.h2,{id:"connected-devices",children:"Connected device(s)"}),"\n",(0,s.jsx)(t.p,{children:"Locations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Windows 10 :  ",(0,s.jsx)(t.code,{children:"%programfiles(x86)%\\Steam\\config\\remoteclients.vdf"})]}),"\n",(0,s.jsxs)(t.li,{children:["Ubuntu : ",(0,s.jsx)(t.code,{children:"$HOME/.local/share/Steam/config/remoteclients.vdf"})]}),"\n",(0,s.jsxs)(t.li,{children:["MacOS : ",(0,s.jsx)(t.code,{children:"$HOME/Library/Application Support/Steam/config/remoteclients.vdf"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The remote client cache can tell us about the hostnames and public IP adresses that were recently used to connect to Steam (via browser or desktop application). It might be possible to even guess the operating system that were used if some default naming conventions were used. In the bellow example, we can guess that the source OS is probably Windows."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-JSON",children:'"RemoteClientCache"\n{\n\t"1012008522321213291784"\n\t{\n\t\t"hostname"\t\t"DESKTOP-3QEVFIQ"\n\t\t"lastupdated"\t\t"1688740718"\n\t\t"lastresult"\t\t"20"\n\t\t"ippublic"\t\t"193.43.70.103"\n\t\t"apps"\n\t\t{\n\t\t}\n\t}\n\t"32802461232113594"\n\t{\n\t\t"hostname"\t\t"DESKTOP-BNO4NTQ"\n\t\t"lastupdated"\t\t"1688740718"\n\t\t"lastresult"\t\t"20"\n\t\t"ippublic"\t\t"193.43.70.103"\n\t\t"apps"\n\t\t{\n\t\t}\n\t}\n}\n'})}),"\n",(0,s.jsx)(t.h2,{id:"application-logs",children:"Application logs"}),"\n",(0,s.jsx)(t.p,{children:"There is a lot of logs saved linked to the activity of the application. They can be usefull to obtain more context in some cases."}),"\n",(0,s.jsx)(t.p,{children:"Locations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Windows 10 :  ",(0,s.jsx)(t.code,{children:"%programfiles(x86)%\\Steam\\logs\\"})]}),"\n",(0,s.jsxs)(t.li,{children:["Ubuntu : ",(0,s.jsx)(t.code,{children:"$HOME/.local/share/Steam/logs/"})]}),"\n",(0,s.jsxs)(t.li,{children:["MacOS : ",(0,s.jsx)(t.code,{children:"$HOME/Library/Application Support/Steam/logs/"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Example :"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-r",children:"[...]\n[2023-07-07 18:44:03] Loaded store 'machineuser' from '[...]/Library/Application Support/Steam/local.vdf' successfully\n[2023-07-07 18:51:20] Flushed store 'userlocal' to '[...]/Library/Application Support/Steam/userdata/[...]/config/localconfig.vdf'\n[2023-07-07 19:06:57] Flushed store 'userlocal' to '[...]/Library/Application Support/Steam/userdata/[...]/config/localconfig.vdf'\n[2023-07-07 19:21:46] Flushed store 'userlocal' to '[...]/Library/Application Support/Steam/userdata/[...]/config/localconfig.vdf'\n[2023-07-07 19:35:46] Flushed store 'userlocal' to '[...]/Library/Application Support/Steam/userdata/[...]/config/localconfig.vdf'\n[2023-07-07 19:57:25] Flushed store 'install' to '[...]/Library/Application Support/Steam/config/config.vdf'\n"})}),"\n",(0,s.jsx)(t.h1,{id:"what-about-the-user-conversations-",children:"What about the user conversations ?"}),"\n",(0,s.jsx)(t.p,{children:"Unfortunately the user conversations are not saved on disk but on the Steam's servers. The channel used to send messages is encrypted through a socket using X509 certificates. You might be able to get those by collaborating with the Steam organization if you are law enforcement. It might be possible to retrieve conversations in the web browser cache or by using memory analysis though I did not dig into any of these hypotheses yet."}),"\n",(0,s.jsx)(t.h1,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsxs)(t.p,{children:["To conclude this article, we were able to retrieve a good amount of information about the user. Those artifacts were found from my own research, there might be more interesting artifacts that were missed when preparing this blog article. If you are looking to automate your artifacts collection, a python library ",(0,s.jsx)(t.sup,{children:(0,s.jsx)(t.a,{href:"#user-content-fn-2-ffd9e8",id:"user-content-fnref-2-ffd9e8","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})," exists to parse vdf files. Hopping it will help you when performing your investigations. Do not hesitate to reach me at ",(0,s.jsx)(t.a,{href:"mailto:felix.guyard@forensicxlab.com",children:"felix.guyard@forensicxlab.com"})," to enhance this article."]}),"\n","\n",(0,s.jsxs)(t.section,{"data-footnotes":!0,className:"footnotes",children:[(0,s.jsx)(t.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{id:"user-content-fn-1-ffd9e8",children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://github.com/obsidianforensics/hindsight/",children:"https://github.com/obsidianforensics/hindsight/"})," ",(0,s.jsx)(t.a,{href:"#user-content-fnref-1-ffd9e8","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{id:"user-content-fn-2-ffd9e8",children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://github.com/ValvePython/vdf",children:"https://github.com/ValvePython/vdf"})," ",(0,s.jsx)(t.a,{href:"#user-content-fnref-2-ffd9e8","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},4314:e=>{e.exports=JSON.parse('{"permalink":"/blog/steam","source":"@site/blog/2023-07-05-steam/index.md","title":"\ud83d\udd26 Video Games Forensics - Steam","description":"Video games have become an integral part of our culture, providing entertainment and social opportunities. Unfortunately, criminals have also begun to take advantage of modern video games and their ever-growing capabilities to conduct illegal activities. Organized crime, hate spread, and pedophilia have been documented occurring within games, opening up the potential to a world of cybercrime.","date":"2023-07-05T00:00:00.000Z","tags":[{"inline":true,"label":"DFIR","permalink":"/blog/tags/dfir"},{"inline":true,"label":"Steam","permalink":"/blog/tags/steam"},{"inline":true,"label":"Linux","permalink":"/blog/tags/linux"},{"inline":true,"label":"Windows","permalink":"/blog/tags/windows"},{"inline":true,"label":"Mac","permalink":"/blog/tags/mac"},{"inline":true,"label":"Video Games","permalink":"/blog/tags/video-games"}],"readingTime":5.93,"hasTruncateMarker":true,"authors":[{"name":"k1nd0ne","title":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","page":{"permalink":"/blog/authors/k-1-nd-0-ne"},"socials":{"x":"https://x.com/k1nd0ne","github":"https://github.com/k1nd0ne","bluesky":"https://bsky.app/profile/k1nd0ne.bsky.social"},"imageURL":"https://avatars.githubusercontent.com/u/27780432?v=4","key":"k1nd0ne"}],"frontMatter":{"slug":"steam","title":"\ud83d\udd26 Video Games Forensics - Steam","authors":["k1nd0ne"],"tags":["DFIR","Steam","Linux","Windows","Mac","Video Games"]},"unlisted":false,"prevItem":{"title":"\ud83d\udcd8 Volatility3 - Remote analysis on cloud object-storage.","permalink":"/blog/vols3"},"nextItem":{"title":"\ud83d\udce6 Volatility3 Windows Plugin - KeePass","permalink":"/blog/keepass"}}')},5457:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/3-44d51b8275a6a17c2a549ee3927113af.png"},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var i=n(6540);const s={},a=i.createContext(s);function o(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);