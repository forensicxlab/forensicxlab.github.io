<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">📦 Volatility3 : Import Address Table | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://forensicxlab.github.io/blog/voliat"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="📦 Volatility3 : Import Address Table | Forensicxlab"><meta data-rh="true" name="description" content="Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis."><meta data-rh="true" property="og:description" content="Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-12-16T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="DFIR,Volatility,Memory Forensics,Windows"><link data-rh="true" rel="canonical" href="https://forensicxlab.github.io/blog/voliat"><link data-rh="true" rel="alternate" href="https://forensicxlab.github.io/blog/voliat" hreflang="en"><link data-rh="true" rel="alternate" href="https://forensicxlab.github.io/blog/voliat" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://forensicxlab.github.io/blog/voliat","mainEntityOfPage":"https://forensicxlab.github.io/blog/voliat","url":"https://forensicxlab.github.io/blog/voliat","headline":"📦 Volatility3 : Import Address Table","name":"📦 Volatility3 : Import Address Table","description":"Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis.","datePublished":"2023-12-16T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://forensicxlab.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.98b055e0.css">
<script src="/assets/js/runtime~main.4d333bc2.js" defer="defer"></script>
<script src="/assets/js/main.2850891d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/thanatology">Thanatology</a><a class="navbar__item navbar__link" href="/docs/exhume">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.gg/AqkYgR5HEg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/voliat">📦 Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volads">📦 Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hibernation">📘 Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">📘 Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">🔦 Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/keepass">📦 Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/slug">Title</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">🔦 Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">🧬 Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anydesk">📦 Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">📦 Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">📦 Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">🖋 Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volaslib">📘 Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">📄 Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">📦 Volatility3 : Import Address Table</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-12-16T00:00:00.000Z">December 16, 2023</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Windows executable analysis is a key aspect of Digital Forensics and Reverse Malware Engineering. Identifying the capabilities of a program can help to target potential malicious code and orient the later reverse code analysis phase. In this blogpost, we will dive into the structure of the Windows Portable Executable (PE) and how we can extract the imported functions in the context of memory analysis.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows-pe-format">Windows PE Format<a href="#windows-pe-format" class="hash-link" aria-label="Direct link to Windows PE Format" title="Direct link to Windows PE Format">​</a></h2>
<p>A portable executable (PE) <sup><a href="#user-content-fn-1-efcee2" id="user-content-fnref-1-efcee2" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup> is a file format used by Windows to store executable programs, libraries (DLLs) and object files. It contains all the necessary information for the operating system to load and execute the program. The program is therefore well structured. Here is a representation of the PE structure for a Windows system <sup><a href="#user-content-fn-2-efcee2" id="user-content-fnref-2-efcee2" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>:</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/1-daca747f861ae57a39ac6507d382ad44.png" title="PE Structure (simplified)" width="318" height="558" class="img_ev3q"></p>
<p>The PE starts with the well-known DOS, Stub and NT headers. It is also composed of multiple sections. Each section as its own purpose, for example the .text section contains the byte codes corresponding to the instructions of the program. We will see that there are specific sections that exists which might help the analyst to identify the capabilities of an executable without starting the reverse code analysis phase. If you want to learn more about the PE format, the articles from 0xRick about the subject are very well explained <sup><a href="#user-content-fn-2-efcee2" id="user-content-fnref-2-efcee2-2" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="interactions-with-the-memory">Interactions with the memory<a href="#interactions-with-the-memory" class="hash-link" aria-label="Direct link to Interactions with the memory" title="Direct link to Interactions with the memory">​</a></h3>
<p>In the context of memory analysis, we need to understand what is happening when a Windows executable is loaded. The operating system will map the PE file from the disk to memory by first creating a dedicated virtual address space. Then, the headers are parsed and loaded to learn about important information about the sections (entry point, size, ...). Once parsed, the memory allocation is performed to load the actual content of the sections. The PE file often depends on external libraries, the operating system resolves the imports by looking up the required functions in the corresponding DLLs and update the memory addresses accordingly. A library can be “bound” to the PE which means it is directly integrated inside the code section. This is often used for better performances.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-import-address-table-iat">The Import Address Table (IAT)<a href="#the-import-address-table-iat" class="hash-link" aria-label="Direct link to The Import Address Table (IAT)" title="Direct link to The Import Address Table (IAT)">​</a></h3>
<p>The Import Address Table is located inside the “.idata” Section <sup><a href="#user-content-fn-3-efcee2" id="user-content-fnref-3-efcee2" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup> of a PE, it can be seen as a table of references indicating to the loader which functions are needed from the imported DLL by the program. This table is a copy of the Import Lookup Table (ILT), but once in memory, the IAT is overwritten with the actual addresses of the functions that are being imported which is interesting from the memory forensics standpoint.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extracting-the-iat-using-volatility3">Extracting the IAT using volatility3<a href="#extracting-the-iat-using-volatility3" class="hash-link" aria-label="Direct link to Extracting the IAT using volatility3" title="Direct link to Extracting the IAT using volatility3">​</a></h2>
<p>Carving the IAT during memory forensics can be very valuable for the analyst to look for API call patterns associated with malware behavior. For example, the OpenProcess, VirtualAllocEx, CreateRemoteThread function present inside the IAT of a PE can be a good indicator for potential code injection <sup><a href="#user-content-fn-4-efcee2" id="user-content-fnref-4-efcee2" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup>. The analyst can also pivot on some of the functions to identify for example the arguments that can be passed.</p>
<p>A volatility3 plugin can be made to extract the IAT information from the memory. Below is an example output of the created plugin named “windows.iat.IAT”. For each process, the associated PE sections are parsed in order to find the IAT. Next, all of the imported functions are displayed to the analyst as well as if the associated DLL is bounded or not to the executable.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~» vol </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> pretty </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> Triage-Memory.mem windows.iat </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pid</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility </span><span class="token number">3</span><span class="token plain"> Framework </span><span class="token number">2.5</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Formatting</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.0.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">|</span><span class="token plain">  PID </span><span class="token operator">|</span><span class="token plain">           Name </span><span class="token operator">|</span><span class="token plain">      Library </span><span class="token operator">|</span><span class="token plain"> Bound </span><span class="token operator">|</span><span class="token plain">                        Function </span><span class="token operator">|</span><span class="token plain">  Address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                            _iob </span><span class="token operator">|</span><span class="token plain"> 0x80c0c8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                _except_handler3 </span><span class="token operator">|</span><span class="token plain"> 0x80c0cc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                  __set_app_type </span><span class="token operator">|</span><span class="token plain"> 0x80c0d0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                      __p__fmode </span><span class="token operator">|</span><span class="token plain"> 0x80c0d4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                    __p__commode </span><span class="token operator">|</span><span class="token plain"> 0x80c0d8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                    _adjust_fdiv </span><span class="token operator">|</span><span class="token plain"> 0x80c0dc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                __setusermatherr </span><span class="token operator">|</span><span class="token plain"> 0x80c0e0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                       _initterm </span><span class="token operator">|</span><span class="token plain"> 0x80c0e4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                   __getmainargs </span><span class="token operator">|</span><span class="token plain"> 0x80c0e8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                   __p___initenv </span><span class="token operator">|</span><span class="token plain"> 0x80c0ec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                     _XcptFilter </span><span class="token operator">|</span><span class="token plain"> 0x80c0f0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                           _exit </span><span class="token operator">|</span><span class="token plain"> 0x80c0f4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                         _onexit </span><span class="token operator">|</span><span class="token plain"> 0x80c0f8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                     __dllonexit </span><span class="token operator">|</span><span class="token plain"> 0x80c0fc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                         strrchr </span><span class="token operator">|</span><span class="token plain"> 0x80c100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                         wcsncmp </span><span class="token operator">|</span><span class="token plain"> 0x80c104</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          _close </span><span class="token operator">|</span><span class="token plain"> 0x80c108</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          wcslen </span><span class="token operator">|</span><span class="token plain"> 0x80c10c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          wcscpy </span><span class="token operator">|</span><span class="token plain"> 0x80c110</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                        strerror </span><span class="token operator">|</span><span class="token plain"> 0x80c114</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                            modf </span><span class="token operator">|</span><span class="token plain"> 0x80c118</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          strspn </span><span class="token operator">|</span><span class="token plain"> 0x80c11c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                         realloc </span><span class="token operator">|</span><span class="token plain"> 0x80c120</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                    __p__environ </span><span class="token operator">|</span><span class="token plain"> 0x80c124</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                   __p__wenviron </span><span class="token operator">|</span><span class="token plain"> 0x80c128</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          _errno </span><span class="token operator">|</span><span class="token plain"> 0x80c12c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                            </span><span class="token function" style="color:rgb(80, 250, 123)">free</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> 0x80c130</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                         strncmp </span><span class="token operator">|</span><span class="token plain"> 0x80c134</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          strstr </span><span class="token operator">|</span><span class="token plain"> 0x80c138</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                         strncpy </span><span class="token operator">|</span><span class="token plain"> 0x80c13c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                           _ftol </span><span class="token operator">|</span><span class="token plain"> 0x80c140</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                           qsort </span><span class="token operator">|</span><span class="token plain"> 0x80c144</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                           fopen </span><span class="token operator">|</span><span class="token plain"> 0x80c148</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">3496</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> UWkpjFjDzM.exe </span><span class="token operator">|</span><span class="token plain">   MSVCRT.dll </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain">                          perror </span><span class="token operator">|</span><span class="token plain"> 0x80c14c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">TRUNCATED</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The extraction of the IAT can be very useful for the analyst to identify the capabilities of a process in memory and gather context to better orient the reverse code analysis phase. When the analyst is willing to understand some of the Windows API functions, the Microsoft documentation is often explaining everything <sup><a href="#user-content-fn-5-efcee2" id="user-content-fnref-5-efcee2" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup>. Trying to look for some of the functions in the text section and extracting the value of the arguments can be the subject of a future blogpost. The pluging is available here and a pull request is in progress <a href="https://github.com/forensicxlab/volatility3/tree/feature/IAT" target="_blank" rel="noopener noreferrer">https://github.com/forensicxlab/volatility3/tree/feature/IAT</a></p>
<blockquote>
<p>Do not hesitate to reach me at <a href="mailto:felix.guyard@forensicxlab.com" target="_blank" rel="noopener noreferrer">felix.guyard@forensicxlab.com</a> to enhance this article or to comment on the integration to the volatility framework.</p>
</blockquote>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-efcee2">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/debug/pe-format" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/windows/win32/debug/pe-format</a> <a href="#user-content-fnref-1-efcee2" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-efcee2">
<p><a href="https://0xrick.github.io/win-internals/pe2/#dos-header" target="_blank" rel="noopener noreferrer">https://0xrick.github.io/win-internals/pe2/#dos-header</a> <a href="#user-content-fnref-2-efcee2" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a> <a href="#user-content-fnref-2-efcee2-2" data-footnote-backref="" aria-label="Back to reference 2-2" class="data-footnote-backref">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-3-efcee2">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#import-address-table" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#import-address-table</a> <a href="#user-content-fnref-3-efcee2" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-4-efcee2">
<p><a href="https://www.apriorit.com/dev-blog/679-windows-dll-injection-for-api-hooks" target="_blank" rel="noopener noreferrer">https://www.apriorit.com/dev-blog/679-windows-dll-injection-for-api-hooks</a> <a href="#user-content-fnref-4-efcee2" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-5-efcee2">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/windows/win32/api/</a> <a href="#user-content-fnref-5-efcee2" data-footnote-backref="" aria-label="Back to reference 5" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/dfir">DFIR</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/volatility">Volatility</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory Forensics</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/windows">Windows</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/volads"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">📦 Volatility3 : Alternate Data Stream Scan</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#windows-pe-format" class="table-of-contents__link toc-highlight">Windows PE Format</a><ul><li><a href="#interactions-with-the-memory" class="table-of-contents__link toc-highlight">Interactions with the memory</a></li><li><a href="#the-import-address-table-iat" class="table-of-contents__link toc-highlight">The Import Address Table (IAT)</a></li></ul></li><li><a href="#extracting-the-iat-using-volatility3" class="table-of-contents__link toc-highlight">Extracting the IAT using volatility3</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Forensicxlab</div></div></div></footer></div>
</body>
</html>