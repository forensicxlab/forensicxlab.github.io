<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">ðŸ“˜ Using Volatility3 as a library | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.forensicxlab.com/blog/volaslib"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="ðŸ“˜ Using Volatility3 as a library | Forensicxlab"><meta data-rh="true" name="description" content="Being interested in memory forensic for a while now, I have learned a lot about the volatility3 framework. In this article, we will go through how you can use the framework&#x27;s libraries to automate your memory analysis tasks and directly exploit the results. I will assume in this article that the reader has a basic understanding of how volatility3 is exploiting memory to extract evidence. If you want to learn more about volatility3, you can check the links in the &quot;References&quot; section."><meta data-rh="true" property="og:description" content="Being interested in memory forensic for a while now, I have learned a lot about the volatility3 framework. In this article, we will go through how you can use the framework&#x27;s libraries to automate your memory analysis tasks and directly exploit the results. I will assume in this article that the reader has a basic understanding of how volatility3 is exploiting memory to extract evidence. If you want to learn more about volatility3, you can check the links in the &quot;References&quot; section."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-05-30T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="DFIR,Volatility,Memory Forensics"><link data-rh="true" rel="canonical" href="https://www.forensicxlab.com/blog/volaslib"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/volaslib" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/volaslib" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.forensicxlab.com/blog/volaslib","mainEntityOfPage":"https://www.forensicxlab.com/blog/volaslib","url":"https://www.forensicxlab.com/blog/volaslib","headline":"ðŸ“˜ Using Volatility3 as a library","name":"ðŸ“˜ Using Volatility3 as a library","description":"Being interested in memory forensic for a while now, I have learned a lot about the volatility3 framework. In this article, we will go through how you can use the framework's libraries to automate your memory analysis tasks and directly exploit the results. I will assume in this article that the reader has a basic understanding of how volatility3 is exploiting memory to extract evidence. If you want to learn more about volatility3, you can check the links in the \"References\" section.","datePublished":"2022-05-30T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.forensicxlab.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.02888316.css">
<script src="/assets/js/runtime~main.a403f75f.js" defer="defer"></script>
<script src="/assets/js/main.161b8aa0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/thanatology">Thanatology</a><a class="navbar__item navbar__link" href="/docs/exhume">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://discord.gg/AqkYgR5HEg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-2025">ðŸŽŠ Thanatology Project - 2025 wrap up and goals</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-4">ðŸ¦‰ Thanatology part 4: Filesystem Forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volweb-3-15">ðŸ“¦ VolWeb v3.15 July 2025 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-3">ðŸ¦‰ Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-2">ðŸ¦‰ Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vmdk">ðŸ”¦ A quick walkthrough in the VMDK format</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology">ðŸ¦‰ Thanatology Part 1 - Introducing the Thanatology project</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/voliat">ðŸ“¦ Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volads">ðŸ“¦ Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hibernation">ðŸ“˜ Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">ðŸ“˜ Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">ðŸ”¦ Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/keepass">ðŸ“¦ Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">ðŸ”¦ Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">ðŸ§¬ Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anydesk">ðŸ“¦ Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">ðŸ“¦ Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">ðŸ“¦ Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">ðŸ–‹ Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/volaslib">ðŸ“˜ Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">ðŸ“„ Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">ðŸ“˜ Using Volatility3 as a library</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-05-30T00:00:00.000Z">May 30, 2022</time> Â· <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://bsky.app/profile/k1nd0ne.bsky.social" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="Bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 226" class="authorSocialLink_owbf"><path fill="#1185FE" d="M55.491 15.172c29.35 22.035 60.917 66.712 72.509 90.686 11.592-23.974 43.159-68.651 72.509-90.686C221.686-.727 256-13.028 256 26.116c0 7.818-4.482 65.674-7.111 75.068-9.138 32.654-42.436 40.983-72.057 35.942 51.775 8.812 64.946 38 36.501 67.187-54.021 55.433-77.644-13.908-83.696-31.676-1.11-3.257-1.63-4.78-1.637-3.485-.008-1.296-.527.228-1.637 3.485-6.052 17.768-29.675 87.11-83.696 31.676-28.445-29.187-15.274-58.375 36.5-67.187-29.62 5.041-62.918-3.288-72.056-35.942C4.482 91.79 0 33.934 0 26.116 0-13.028 34.314-.727 55.491 15.172Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Being interested in memory forensic for a while now, I have learned a lot about the volatility3 framework. In this article, we will go through how you can use the framework&#x27;s libraries to automate your memory analysis tasks and directly exploit the results. I will assume in this article that the reader has a basic understanding of how volatility3 is exploiting memory to extract evidence. If you want to learn more about volatility3, you can check the links in the &quot;References&quot; section.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility3-cli">Volatility3 CLI<a href="#volatility3-cli" class="hash-link" aria-label="Direct link to Volatility3 CLI" title="Direct link to Volatility3 CLI">â€‹</a></h2>
<p>When using the volatility3 framework on a memory image, the analyst is typically using the command line interface (CLI) component of the framework. It is one of the best way to interact with the framework quickly and get results. In the below example, we are executing the PsList plugin on a memory dump using the CLI.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Â» vol </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> pretty </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> Triage-Memory.mem windows.pslist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Volatility </span><span class="token number">3</span><span class="token plain"> Framework </span><span class="token number">2.0</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Formatting</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.0.00		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">  PID </span><span class="token operator">|</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(189, 147, 249)">PPID</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  ImageFileName </span><span class="token operator">|</span><span class="token plain">      Offset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">V</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> Threads </span><span class="token operator">|</span><span class="token plain"> Handles </span><span class="token operator">|</span><span class="token plain"> SessionId </span><span class="token operator">|</span><span class="token plain"> Wow64 </span><span class="token operator">|</span><span class="token plain">                  CreateTime </span><span class="token operator">|</span><span class="token plain"> ExitTime </span><span class="token operator">|</span><span class="token plain"> File output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">    </span><span class="token number">4</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         System </span><span class="token operator">|</span><span class="token plain"> 0xfa8003c72b30 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">87</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">547</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">       N/A </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:55.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">252</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    </span><span class="token number">4</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">       smss.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa8004616040 </span><span class="token operator">|</span><span class="token plain">       </span><span class="token number">2</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">30</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">       N/A </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:55.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">332</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">324</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">      csrss.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa80050546b0 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">516</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:58.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">372</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">364</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">      csrss.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa800525a9e0 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">11</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">557</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:58.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">380</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">324</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    wininit.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa8005259060 </span><span class="token operator">|</span><span class="token plain">       </span><span class="token number">3</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">78</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:58.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">416</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">364</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">   winlogon.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa8005268b30 </span><span class="token operator">|</span><span class="token plain">       </span><span class="token number">3</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">110</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:58.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">476</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">380</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">   services.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa8005680910 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">12</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">224</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:31:59.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">484</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">380</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">      lsass.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa80056885e0 </span><span class="token operator">|</span><span class="token plain">       </span><span class="token number">7</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">650</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:00.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">492</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">380</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">        lsm.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa8005696b30 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">10</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">155</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:00.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">592</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">476</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    svchost.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa80056e1060 </span><span class="token operator">|</span><span class="token plain">       </span><span class="token number">9</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">375</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:01.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">672</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">476</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    svchost.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa800570d060 </span><span class="token operator">|</span><span class="token plain">       </span><span class="token number">7</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">341</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:02.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">764</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">476</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    svchost.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa800575e5b0 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">20</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">447</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:02.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">796</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">476</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    svchost.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa8005775b30 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">15</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">     </span><span class="token number">368</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:03.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">820</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">  </span><span class="token number">476</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    svchost.exe </span><span class="token operator">|</span><span class="token plain"> 0xfa800577db30 </span><span class="token operator">|</span><span class="token plain">      </span><span class="token number">33</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">    </span><span class="token number">1073</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">         </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> False </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2019</span><span class="token plain">-03-22 05:32:03.000000  </span><span class="token operator">|</span><span class="token plain">      N/A </span><span class="token operator">|</span><span class="token plain">    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">etc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>Having those results is a great way to help you during an investigation, but what if we want to make the framework perform more specific tasks to include it to another platform ? For example, you may want to integrate the results directly inside a sandbox or a Web UI. Behind the scene of the execution of this command, volatility3 is using multiple libraries from the framework to produce its results. It&#x27;s simply parsing the user&#x27;s arguments and perform the following steps :</p>
<ul>
<li>Create an empty memory context for the memory image;</li>
<li>Determine if the requested plugin exists in the available list of plugins;</li>
<li>Determine what configuration options the plugin requires;</li>
<li>Complete the context configuration using the plugin requirements, automagics and the user&#x27;s arguments;</li>
<li>Run the plugin;</li>
<li>Render the result into the desired format.</li>
</ul>
<p>Great, now you have a high level understanding of what&#x27;s going on in the background when attempting to run a plugin. Using the Volatility3 documentation, let&#x27;s try to write a simple sample of code to run the PsList plugin with volatility3 as a library.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="constructing-and-running-a-plugin">Constructing and running a plugin<a href="#constructing-and-running-a-plugin" class="hash-link" aria-label="Direct link to Constructing and running a plugin" title="Direct link to Constructing and running a plugin">â€‹</a></h2>
<p>In this section we will take a look at how we can run the PsList pluging using volatility3 as a library. Let&#x27;s first take a look at the following code sample :</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> contexts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> logging</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">basicConfig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">level</span><span class="token operator">=</span><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logger </span><span class="token operator">=</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getLogger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">require_interface_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx </span><span class="token operator">=</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">## Construct a blank context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">failures </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">import_files</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">##Load the framework plugins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> failures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Some volatility3 plugin couldn&#x27;t be loaded : </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">failures</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Plugins are loaded without failure&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plugin_list </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">list_plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugin_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>OUTPUT :</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:__main__:Plugins are loaded without failure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:__main__:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;windows.statistics.Statistics&#x27;: ,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;timeliner.Timeliner&#x27;: ,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;windows.pslist.PsList&#x27;: ,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>In this first step, we have constructed a blank context and loaded the native framework plugins. Next, we need to choose which plugin we want to run and construct the appropriate context based on its requirements. For this, I propose we create a function which can construct a simple plugin with no specific arguments.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">1    def build_context(image_name ,context, base_config_path, plugin):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2        available_automagics = automagic.available(context)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3        plugin_config_path = interfaces.configuration.path_join(base_config_path, plugin.__name__)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4        automagics = automagic.choose_automagic(available_automagics, plugin)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5        context.config[&#x27;automagic.LayerStacker.stackers&#x27;] = automagic.stacker.choose_os_stackers(plugin)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6        context.config[&#x27;automagic.LayerStacker.single_location&#x27;] = &quot;file://&quot; + os.getcwd() + &quot;/&quot; + image_name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7        constructed = construct_plugin(context, automagics, plugin, base_config_path, None, None)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8        return constructed</span><br></span></code></pre></div></div>
<p>Let&#x27;s decompose the function :</p>
<ul>
<li>The <strong>image_name</strong> : The name or relative path of the memory image you want to analyse.</li>
<li>The <strong>context</strong> : The object in which the memory context, plugin configuration and requirements will be stored.</li>
<li>The <strong>base_config_path</strong> : The path within the context&#x27;s config containing the plugin&#x27;s configuration. By default, this value is set to &quot;plugins&quot;</li>
<li>The <strong>plugin</strong> : The plugin object choosen from the list of plugins.</li>
</ul>
<p>Volatility3 is using what is called &quot;automagics&quot; to help with plugin construction. Indeed it is helping a lot to automatically determine specific stack layers.
Line 2, 4 and 5 of the code are determining what automagics are available, choose the automagics that apply to the operating system and update the context configuration.</p>
<p>Line 6 is simply giving the memory image location to the context configuration.</p>
<p>Once the context is ready, we can construct the plugin using the framework built-in function &quot;construct_plugin&quot;.
This function will check that all the plugin&#x27;s requirements are fulfilled and if so, will return the constructed plugin (which is an object). The sample code and output below allows us to see a bit more of what happened behind the scene and construct the &#x27;PsList&#x27; plugin.
Notice that our logger also displays the volatility3 logs !</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> interfaces</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> automagic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">plugins </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> construct_plugin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">basicConfig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">level</span><span class="token operator">=</span><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logger </span><span class="token operator">=</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getLogger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">require_interface_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">build_context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">image_name </span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   available_automagics </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">available</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Available automagics : </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">available_automagics</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   plugin_config_path </span><span class="token operator">=</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">configuration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path_join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   automagics </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">choose_automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">available_automagics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;automagic.LayerStacker.stackers&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stacker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">choose_os_stackers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;automagic.LayerStacker.single_location&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file://&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getcwd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> image_name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   constructed </span><span class="token operator">=</span><span class="token plain"> construct_plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> automagics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Contructed plugin : </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">constructed</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> constructed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx </span><span class="token operator">=</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">## Construct a blank context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">failures </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">import_files</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">##Load the framework plugins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> failures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Some volatility3 plugin couldn&#x27;t be loaded : </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">failures</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Plugins are loaded without failure&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plugin_list </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">list_plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">base_config_path </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;plugins&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">constructed </span><span class="token operator">=</span><span class="token plain"> build_context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Triage-Memory.mem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;windows.pslist.PsList&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Context configuration </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">ctx</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">config</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>OUTPUT :</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:__main__:Plugins are loaded without failure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:__main__:Available automagics :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> [volatility3.framework.automagic.symbol_cache.SymbolBannerCache object at 0x1052d9e20,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   volatility3.framework.automagic.mac.MacBannerCache object at 0x1052d9eb0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   volatility3.framework.automagic.linux.LinuxBannerCache object at 0x1052d9f40,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   volatility3.framework.automagic.construct_layers.ConstructionMagic object at 0x1063a6340,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   volatility3.framework.automagic.stacker.LayerStacker object at 0x1063b4280,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:volatility3.framework.automagic:Detected a windows category plugin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:volatility3.framework.automagic:Running automagic: ConstructionMagic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:volatility3.framework.automagic:Running automagic: LayerStacker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:volatility3.framework.automagic:Running automagic: WinSwapLayers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:volatility3.framework.automagic:Running automagic: KernelPDBScanner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:volatility3.framework.automagic:Running automagic: KernelModule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:__main__:Contructed plugin : volatility3.plugins.windows.pslist.PsList object at 0x1063c1ee0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> INFO:__main__:Context configuration {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;automagic.LayerStacker.single_location&quot;: &quot;file:///REDACTED/REDACTED/REDACTED/REDACTED/REDACTED/REDACTED/Triage-Memory.mem&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;automagic.LayerStacker.stackers&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;AVMLStacker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;LimeStacker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;Elf64Stacker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;QemuStacker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;WindowsCrashDumpStacker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;VmwareStacker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     &quot;WindowsIntelStacker&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.dump&quot;: false,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel&quot;: &quot;kernel&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.class&quot;: &quot;volatility3.framework.contexts.Module&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name&quot;: &quot;layer_name&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.class&quot;: &quot;volatility3.framework.layers.intel.WindowsIntel32e&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.kernel_virtual_offset&quot;: 272678925664256,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.memory_layer&quot;: &quot;memory_layer&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.memory_layer.class&quot;: &quot;volatility3.framework.layers.physical.FileLayer&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.memory_layer.location&quot;: &quot;file:///REDACTED/REDACTED/REDACTED/REDACTED/REDACTED/REDACTED/Triage-Memory.mem&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.page_map_offset&quot;: 1601536,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.swap_layers&quot;: true,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.layer_name.swap_layers.number_of_elements&quot;: 0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.offset&quot;: 272678925664256,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.symbol_table_name&quot;: &quot;symbol_table_name1&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.symbol_table_name.class&quot;: &quot;volatility3.framework.symbols.windows.WindowsKernelIntermedSymbols&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.symbol_table_name.isf_url&quot;: &quot;file:///REDACTED/REDACTED/REDACTED/REDACTED/python/site-packages/volatility3/symbols/windows/ntkrnlmp.pdb/2E37F962D699492CAAF3F9F4E9770B1D-2.json.xz&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.kernel.symbol_table_name.symbol_mask&quot;: 0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.physical&quot;: false,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   &quot;plugins.PsList.pid&quot;: []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> }</span><br></span></code></pre></div></div>
<p>Once our plugin is constructed, we can run it. However, we need to specify to volatility how we want to render the output. The framework is providing us with multiple renderers. Let&#x27;s use the &quot;pretty text renderer&quot; that we have used with the CLI at the begining of the blog and run the plugin.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> interfaces</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> automagic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">plugins </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> construct_plugin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cli </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> text_renderer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">basicConfig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">level</span><span class="token operator">=</span><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logger </span><span class="token operator">=</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getLogger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">require_interface_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">build_context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">image_name </span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   available_automagics </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">available</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   plugin_config_path </span><span class="token operator">=</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">configuration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path_join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   automagics </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">choose_automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">available_automagics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;automagic.LayerStacker.stackers&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stacker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">choose_os_stackers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;automagic.LayerStacker.single_location&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file://&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getcwd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> image_name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   constructed </span><span class="token operator">=</span><span class="token plain"> construct_plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> automagics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> constructed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx </span><span class="token operator">=</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">## Construct a blank context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">failures </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">import_files</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">##Load the framework plugins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> failures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Some volatility3 plugin couldn&#x27;t be loaded : </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">failures</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Plugins are loaded without failure&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plugin_list </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">list_plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">base_config_path </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;plugins&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">constructed </span><span class="token operator">=</span><span class="token plain"> build_context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Triage-Memory.mem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;windows.pslist.PsList&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> constructed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   result </span><span class="token operator">=</span><span class="token plain"> text_renderer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">PrettyTextRenderer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">render</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">constructed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>OUTPUT :</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:__main__:Plugins are loaded without failure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Detected a windows category plugin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: ConstructionMagic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: LayerStacker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: WinSwapLayers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: KernelPDBScanner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: KernelModule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Formatting...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> |  PID | PPID |  ImageFileName |      Offset(V) | Threads | Handles | SessionId | Wow64 |                  CreateTime | ExitTime | File output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |    4 |    0 |         System | 0xfa8003c72b30 |      87 |     547 |       N/A | False | 2019-03-22 05:31:55.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |  252 |    4 |       smss.exe | 0xfa8004616040 |       2 |      30 |       N/A | False | 2019-03-22 05:31:55.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |  332 |  324 |      csrss.exe | 0xfa80050546b0 |      10 |     516 |         0 | False | 2019-03-22 05:31:58.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |  372 |  364 |      csrss.exe | 0xfa800525a9e0 |      11 |     557 |         1 | False | 2019-03-22 05:31:58.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |  380 |  324 |    wininit.exe | 0xfa8005259060 |       3 |      78 |         0 | False | 2019-03-22 05:31:58.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |  416 |  364 |   winlogon.exe | 0xfa8005268b30 |       3 |     110 |         1 | False | 2019-03-22 05:31:58.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* |  476 |  380 |   services.exe | 0xfa8005680910 |      12 |     224 |         0 | False | 2019-03-22 05:31:59.000000  |      N/A |    Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Going further</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Great, we now know how to run a simple plugin with no specfic configuration and a default text renderer. In this section, we&#x27;ll try to dump a specific process using the capabilities of the PsList plugin.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">If you take a look at the context configuration displayed earlier, you&#x27;ll notice that some options about the PsList plugin are set by default. What if we want to try to dump a specific process ? With the volatility3 CLI, the command is the following :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Â» vol -f Triage-Memory.mem windows.pslist --pid 252 --dump                                                                                                                             k1nd0ne@MacBook-Pro-de-Felix</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  100.00		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PID	PPID	ImageFileName	Offset(V)	Threads	Handles	SessionId	Wow64	CreateTime	ExitTime	File output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">252	4	smss.exe	0xfa8004616040	2	30	N/A	False	2019-03-22 05:31:55.000000 	N/A	pid.252.0x48430000.dmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The arguments we specified are the PID, which is the process ID we want to filter, and the DUMP option, which means that we want to dump the list of the filtered processes.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">If we take a look at the plugin context configuration, the entries reponsible are the following :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;plugins.PsList.pid&quot;: []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;plugins.PsList.dump&quot;: false In our code, we just have to clarify those two values:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx.config[&quot;plugins.PsList.pid&quot;] = [252]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx.config[&quot;plugins.PsList.dump&quot;] = True</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">constructed = build_context(&quot;Triage-Memory.mem&quot;, ctx, base_config_path, plugin_list[&#x27;windows.pslist.PsList&#x27;])</span><br></span></code></pre></div></div>
<p>OUTPUT :</p>
<div class="language-1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-1 codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:__main__:Plugins are loaded without failure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Detected a windows category plugin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: ConstructionMagic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: LayerStacker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: WinSwapLayers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: KernelPDBScanner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO:volatility3.framework.automagic:Running automagic: KernelModule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Formatting...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| PID | PPID | ImageFileName |      Offset(V) | Threads | Handles | SessionId | Wow64 |                  CreateTime | ExitTime |            File output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* | 252 |    4 |      smss.exe | 0xfa8004616040 |       2 |      30 |       N/A | False | 2019-03-22 05:31:55.000000  |      N/A | pid.252.0x48430000.dmp</span><br></span></code></pre></div></div>
<p>This code will be interpreted without error. However you&#x27;ll never find your process on your drive ! Why ? Well, in the &quot;build_context&quot; function, I have called the volatility3 framework&#x27;s &quot;construct_plugin&quot; function with no File Handler Interface. By default, the volatility3 framework lets you decide how to handle files by rewritting the methods (open, write, ...). In this example, we want the file to be directly written in the current directory from where the script is executed. The following code is using the CLIDirectFileHandler from the native framework with a little bit of tweaking. Once integrated into our code, the final result looks like this :</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> interfaces</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> plugins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> automagic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">plugins </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> construct_plugin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cli </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> text_renderer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> io</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tempfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">file_handler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">CLIFileHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">interfaces</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">FileHandlerInterface</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;The FileHandler from Volatility3 CLI&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">_get_final_filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;Gets the final filename&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> output_dir </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">raise</span><span class="token plain"> TypeError</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Output directory is not a string&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">makedirs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> exist_ok </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           pref_name_array </span><span class="token operator">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">preferred_filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> extension </span><span class="token operator">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">pref_name_array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pref_name_array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           output_filename </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">filename</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">extension</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           counter </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">remove</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">output_filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> output_filename</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">CLIDirectFileHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">CLIFileHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;We want to save our files directly to disk&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__init__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           fd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_name </span><span class="token operator">=</span><span class="token plain"> tempfile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mkstemp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">suffix </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;.vol3&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> prefix </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;tmp_&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">dir</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> output_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file </span><span class="token operator">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mode </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;w+b&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           CLIFileHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> item </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;_&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">and</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> item </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;closed&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;close&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;mode&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;name&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                   </span><span class="token builtin" style="color:rgb(189, 147, 249)">setattr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">getattr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__getattr__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">getattr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">@property</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">closed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">closed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">@property</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">@property</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">close</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;Closes and commits the file (by moving the temporary file to the correct name&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token comment" style="color:rgb(98, 114, 164)">## Don&#x27;t overcommit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">closed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">close</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           output_filename </span><span class="token operator">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_get_final_filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> output_filename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> CLIDirectFileHandler</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">build_context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">image_name </span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   available_automagics </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">available</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   plugin_config_path </span><span class="token operator">=</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">configuration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path_join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   automagics </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">choose_automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">available_automagics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;automagic.LayerStacker.stackers&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> automagic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stacker</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">choose_os_stackers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;automagic.LayerStacker.single_location&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file://&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getcwd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> image_name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   constructed </span><span class="token operator">=</span><span class="token plain"> construct_plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> automagics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> file_handler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getcwd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> constructed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">basicConfig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">level</span><span class="token operator">=</span><span class="token plain">logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">logger </span><span class="token operator">=</span><span class="token plain"> logging</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getLogger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">require_interface_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx </span><span class="token operator">=</span><span class="token plain"> contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">## Construct a blank context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">failures </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">import_files</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">##Load the framework plugins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> failures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Some volatility3 plugin couldn&#x27;t be loaded : </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">failures</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Plugins are loaded without failure&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plugin_list </span><span class="token operator">=</span><span class="token plain"> volatility3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">list_plugins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">base_config_path </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;plugins&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;plugins.PsList.pid&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">252</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;plugins.PsList.dump&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">constructed </span><span class="token operator">=</span><span class="token plain"> build_context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Triage-Memory.mem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> base_config_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plugin_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;windows.pslist.PsList&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> constructed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   result </span><span class="token operator">=</span><span class="token plain"> text_renderer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">PrettyTextRenderer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">render</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">constructed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<p>There we go, when interpreted, this script will dump the process with PID 252 using the PsList plugin. Now that you know more about how to use the volatility3 framework libraries, you can imagine any application you want to a real case scenario!
Conclusion</p>
<p>I hope you now have a better understanding of how the volatility3 framework is working behind the scene, how easy it is to exploit and integrate it inside your investigation tools. You can of course write your own renderers to directly inject the results inside a database or any format that suite your needs. VolWeb is using volatility3 as a library and this article is directly linked to the latest release exploiting this capability.
You can check VolWeb by clicking the link below.</p>
<blockquote>
<p>This article is written from my own understanding of this subject and any critics you may have are welcomed to make this article evolve. You can contact me at <a href="mailto:felix.guyard@forensicxlab.com" target="_blank" rel="noopener noreferrer">felix.guyard@forensicxlab.com</a>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">â€‹</a></h2>
<ul>
<li>Volatility3 Documentation : <a href="https://volatility3.readthedocs.io/en/stable/using-as-a-library.html" target="_blank" rel="noopener noreferrer">https://volatility3.readthedocs.io/en/stable/using-as-a-library.html</a></li>
<li>Volatility3 Project : <a href="https://github.com/volatilityfoundation/volatility3" target="_blank" rel="noopener noreferrer">https://github.com/volatilityfoundation/volatility3</a></li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/dfir">DFIR</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/volatility">Volatility</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory Forensics</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/cb-brave"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">ðŸ–‹ Cyberdefenders - Writeup - Brave</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/macisf"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">ðŸ“„ Volatility3 - ISF for MacOs</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#volatility3-cli" class="table-of-contents__link toc-highlight">Volatility3 CLI</a></li><li><a href="#constructing-and-running-a-plugin" class="table-of-contents__link toc-highlight">Constructing and running a plugin</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 Forensicxlab</div></div></div></footer></div>
</body>
</html>