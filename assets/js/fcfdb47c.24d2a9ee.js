"use strict";(self.webpackChunkexhume=self.webpackChunkexhume||[]).push([[3468],{3060:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"exhume_exfat/library","title":"Exhume exFAT as a library","description":"This document provides guidance on how to use the exhume_exfat crate as a library in your Rust projects. You will learn how to integrate the library, its basic usage, and a sample minimalist main code example. Exhume exFAT is also part of Exhume FileSystem.","source":"@site/docs/exhume_exfat/library.md","sourceDirName":"exhume_exfat","slug":"/exhume_exfat/library","permalink":"/docs/exhume_exfat/library","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/docs/exhume_exfat/getting-started"},"next":{"title":"\ud83e\udd89 Thanatology (in progress)","permalink":"/docs/thanatology"}}');var a=t(4848),s=t(8453);const r={sidebar_position:2},o="Exhume exFAT as a library",l={},d=[{value:"Install",id:"install",level:2},{value:"\ud83d\udce6 Adding Exhume ExtFS as a Dependency",id:"-adding-exhume-extfs-as-a-dependency",level:2},{value:"\ud83d\udee0\ufe0f Basic Usage",id:"\ufe0f-basic-usage",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"exhume-exfat-as-a-library",children:"Exhume exFAT as a library"})}),"\n",(0,a.jsxs)(n.p,{children:["This document provides guidance on how to use the ",(0,a.jsx)(n.code,{children:"exhume_exfat"})," crate as a library in your Rust projects. You will learn how to integrate the library, its basic usage, and a sample minimalist main code example. Exhume exFAT is also part of ",(0,a.jsx)(n.a,{href:"https://www.forensicxlab.com/docs/category/exhume---filesystem",children:"Exhume FileSystem"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,a.jsx)(n.p,{children:"Create a project:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cargo new exfat_test\ncd exfat_test/src\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-adding-exhume-extfs-as-a-dependency",children:"\ud83d\udce6 Adding Exhume ExtFS as a Dependency"}),"\n",(0,a.jsxs)(n.p,{children:["To use the ",(0,a.jsx)(n.code,{children:"exhume_exfat"})," library in your Rust project, you need to add it as a dependency in your ",(0,a.jsx)(n.code,{children:"Cargo.toml"})," file. Below is the sections you need to include:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-toml",children:'[dependencies]\nexhume_body = "=0.3.1"\nexhume_exfat= ">=0.1.1"\n\n# Required crates to log events\nlog = "0.4.25"\nenv_logger = "0.11.6"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\ufe0f-basic-usage",children:"\ud83d\udee0\ufe0f Basic Usage"}),"\n",(0,a.jsxs)(n.p,{children:["Below is a sample code illustrating how to use ",(0,a.jsx)(n.code,{children:"exhume_exfat"})," as a library in the newly created Rust project."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-rust",children:'use exhume_body::{Body, BodySlice};\nuse exhume_exfat::ExFatFS;\n\nfn main() {\n    // Connect our log env\n    env_logger::Builder::new()\n        .filter_level(log::LevelFilter::Info)\n        .init();\n\n    // We create an exhume body object to fetch our image.\n    let mut body = Body::new("/path/to/evidence.E01".to_string(), "auto");\n\n    // These values (offset & size in sectors) are typically discovered with "exhume partitions"\n    let offset: u64 = 0x100000;        // exFAT partition start (bytes)\n    let part_sectors: u64 = 0x9c00000; // exFAT partition size (in sectors)\n    let partition_size = part_sectors * body.get_sector_size() as u64;\n\n    // Create a slice over the exFAT partition\n    let mut slice = match BodySlice::new(&mut body, offset, partition_size) {\n        Ok(sl) => sl,\n        Err(e) => {\n            eprintln!("Could not create BodySlice: {}", e);\n            return;\n        }\n    };\n\n    // Open the filesystem\n    let mut fs = match ExFatFS::new(&mut slice) {\n        Ok(v) => v,\n        Err(e) => {\n            eprintln!("Couldn\'t open exFAT: {}", e);\n            return;\n        }\n    };\n\n    // ---- Examples of basic usage ----\n\n    // 1) Print BPB / super info (human friendly table)\n    println!("{}", fs.bpb.to_string());\n\n    // 2) List root directory entries with their fake inode numbers\n    match fs.list_root_with_inodes() {\n        Ok(list) => {\n            println!("\\n# Root directory:");\n            for (inode, f) in list {\n                println!(\n                    "inode=0x{:016x}  {:>10}  cluster {:>8}  {}{}",\n                    inode,\n                    f.size,\n                    f.first_cluster,\n                    f.name,\n                    if f.is_dir() { " /" } else { "" }\n                );\n            }\n        }\n        Err(e) => eprintln!("Root listing failed: {}", e),\n    }\n\n    // 3) Resolve a path to an inode and print its metadata\n    //    (change the path below to something that exists on your image)\n    let sample_path = "Documents/Report.txt";\n    match fs.resolve_path_to_inode_num(sample_path) {\n        Ok((ino, inode)) => {\n            println!("\\n# Resolved \'{}\':", sample_path);\n            println!("Fake inode: 0x{:016x}", ino);\n            println!("{}", inode.to_string());\n\n            // 4) If it\'s a regular file, read its content\n            if inode.is_regular_file() {\n                match fs.read_inode(&inode) {\n                    Ok(bytes) => {\n                        println!("Read {} bytes from \'{}\'", bytes.len(), sample_path);\n                        // Do something with `bytes` (hash, carve, save, \u2026)\n                    }\n                    Err(e) => eprintln!("read_inode failed: {}", e),\n                }\n            }\n        }\n        Err(e) => eprintln!("resolve_path_to_inode_num(\'{}\') failed: {}", sample_path, e),\n    }\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);