<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">ğŸ“¦ Volatility3 Windows Plugin - KeePass | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.forensicxlab.com/blog/keepass"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="ğŸ“¦ Volatility3 Windows Plugin - KeePass | Forensicxlab"><meta data-rh="true" name="description" content="On May 1st, 2023, vdhoney raised concerns about a flaw he found impacting KeePass 2.X.. Vdhoney claimed to be able to reconstruct the master password from memory."><meta data-rh="true" property="og:description" content="On May 1st, 2023, vdhoney raised concerns about a flaw he found impacting KeePass 2.X.. Vdhoney claimed to be able to reconstruct the master password from memory."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-05-19T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="DFIR,Memory Forensics,KeePass,Windows"><link data-rh="true" rel="canonical" href="https://www.forensicxlab.com/blog/keepass"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/keepass" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/keepass" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.forensicxlab.com/blog/keepass","mainEntityOfPage":"https://www.forensicxlab.com/blog/keepass","url":"https://www.forensicxlab.com/blog/keepass","headline":"ğŸ“¦ Volatility3 Windows Plugin - KeePass","name":"ğŸ“¦ Volatility3 Windows Plugin - KeePass","description":"On May 1st, 2023, vdhoney raised concerns about a flaw he found impacting KeePass 2.X.. Vdhoney claimed to be able to reconstruct the master password from memory.","datePublished":"2023-05-19T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.forensicxlab.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.02888316.css">
<script src="/assets/js/runtime~main.bb668528.js" defer="defer"></script>
<script src="/assets/js/main.c83c3a33.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/thanatology">Thanatology</a><a class="navbar__item navbar__link" href="/docs/exhume">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://discord.gg/AqkYgR5HEg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/exhume-aff4">ğŸ”¦ Debunking the Cellebrite (MacQuisition) Advanced Forensics File Format Version 4 (AFF4) implementation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-2025">ğŸŠ Thanatology Project - 2025 wrap up and goals</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-4">ğŸ¦‰ Thanatology part 4: Filesystem Forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volweb-3-15">ğŸ“¦ VolWeb v3.15 July 2025 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-3">ğŸ¦‰ Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-2">ğŸ¦‰ Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vmdk">ğŸ”¦ A quick walkthrough in the VMDK format</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology">ğŸ¦‰ Thanatology Part 1 - Introducing the Thanatology project</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/voliat">ğŸ“¦ Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volads">ğŸ“¦ Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hibernation">ğŸ“˜ Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">ğŸ“˜ Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">ğŸ”¦ Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/keepass">ğŸ“¦ Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">ğŸ”¦ Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">ğŸ§¬ Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anydesk">ğŸ“¦ Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">ğŸ“¦ Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">ğŸ“¦ Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">ğŸ–‹ Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volaslib">ğŸ“˜ Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">ğŸ“„ Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">ğŸ“¦ Volatility3 Windows Plugin - KeePass</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-05-19T00:00:00.000Z">May 19, 2023</time> Â· <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://bsky.app/profile/k1nd0ne.bsky.social" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="Bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 226" class="authorSocialLink_owbf"><path fill="#1185FE" d="M55.491 15.172c29.35 22.035 60.917 66.712 72.509 90.686 11.592-23.974 43.159-68.651 72.509-90.686C221.686-.727 256-13.028 256 26.116c0 7.818-4.482 65.674-7.111 75.068-9.138 32.654-42.436 40.983-72.057 35.942 51.775 8.812 64.946 38 36.501 67.187-54.021 55.433-77.644-13.908-83.696-31.676-1.11-3.257-1.63-4.78-1.637-3.485-.008-1.296-.527.228-1.637 3.485-6.052 17.768-29.675 87.11-83.696 31.676-28.445-29.187-15.274-58.375 36.5-67.187-29.62 5.041-62.918-3.288-72.056-35.942C4.482 91.79 0 33.934 0 26.116 0-13.028 34.314-.727 55.491 15.172Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>On May 1st, 2023, vdhoney<sup><a href="#user-content-fn-1-8d99df" id="user-content-fnref-1-8d99df" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup> raised concerns about a flaw he found impacting KeePass 2.X.<sup><a href="#user-content-fn-2-8d99df" id="user-content-fnref-2-8d99df" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>. Vdhoney claimed to be able to reconstruct the master password from memory.
A POC <sup><a href="#user-content-fn-3-8d99df" id="user-content-fnref-3-8d99df" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup> was later released by the researcher not only in dotnet but also in python3<sup><a href="#user-content-fn-4-8d99df" id="user-content-fnref-4-8d99df" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup>.</p>
<p>Today in this blog post we will describe the vulnerability and see how we can create a volatility3 plugin to help forensics investigators to retrieve passwords from memory.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vulnerability-description">Vulnerability description<a href="#vulnerability-description" class="hash-link" aria-label="Direct link to Vulnerability description" title="Direct link to Vulnerability description">â€‹</a></h2>
<p>The vulnerability (CVE-2023-32784 <sup><a href="#user-content-fn-5-8d99df" id="user-content-fnref-5-8d99df" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup>) resides in the basic KeePass version 2.X written in .NET. This version utilizes its own custom-made text box named SecureTextBoxEx, not only for the master password entry dialog but also in other parts of the program such as password edit boxes. Though this use case is not likely to be used by users as it is a bad practice, it should be noted that the flaw does not cover the scenario where the master password was copied from a clipboard.
From this observation, Vdohney built up a method to recover that scattered information from memory. Indeed, this text box produces left over strings when a password is entered. For example, when â€œHelloâ€ is typed, the following strings remain present in memory â€œâ€¢e, â€¢â€¢l, â€¢â€¢â€¢l, â€¢â€¢â€¢â€¢oâ€. One can find more details about this vulnerability on vdhoneyâ€™s github <sup><a href="#user-content-fn-3-8d99df" id="user-content-fnref-3-8d99df-2" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-keepass-volatility3-plugin">The KeePass volatility3 plugin<a href="#the-keepass-volatility3-plugin" class="hash-link" aria-label="Direct link to The KeePass volatility3 plugin" title="Direct link to The KeePass volatility3 plugin">â€‹</a></h2>
<p>As a forensics investigator, you might have actual (or past) cases where KeePass 2.X process activities were retrieved. Using volatility3, it is possible to list the running processes using the â€œpslistâ€ or â€œpsscanâ€ plugin.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/Memory Analysis/MemoryImages/KeePassMachine Â» vol -f KeePassMachine.mem windows.pslist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.4.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  100.00		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PID	PPID	ImageFileName	Offset(V)	Threads	Handles	SessionId	Wow64	CreateTime	ExitTime	File output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4	0	System	0x9908d5a87040	136	-	N/A	False	2023-05-19 14:20:08.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">108	4	Registry	0x9908d5af6080	4	-	N/A	False	2023-05-19 14:20:04.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">412	4	smss.exe	0x9908dabd8040	2	-	N/A	False	2023-05-19 14:20:08.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">532	516	csrss.exe	0x9908dac800c0	11	-	0	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">628	516	wininit.exe	0x9908db831080	3	-	0	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">648	620	csrss.exe	0x9908db847140	13	-	1	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">700	628	services.exe	0x9908db894080	7	-	0	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">740	620	winlogon.exe	0x9908db8a4080	3	-	1	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">796	628	lsass.exe	0x9908db8c8080	6	-	0	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">912	700	svchost.exe	0x9908db936240	13	-	0	False	2023-05-19 14:20:32.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1716	912	dllhost.exe	0x9908de764080	5	-	1	False	2023-05-19 14:23:07.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4888	700	SgrmBroker.exe	0x9908df512080	7	-	0	False	2023-05-19 14:23:08.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7820	912	WmiPrvSE.exe	0x9908da4f7080	4	-	0	False	2023-05-19 14:23:26.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4272	4528	FTK Imager.exe	0x9908da509080	12	-	1	False	2023-05-19 14:23:42.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4100	700	WUDFHost.exe	0x9908de9a3080	5	-	0	False	2023-05-19 14:23:43.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2868	912	ShellExperienc	0x9908dec2c080	9	-	1	False	2023-05-19 14:23:45.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7684	912	RuntimeBroker.	0x9908d7f0d2c0	3	-	1	False	2023-05-19 14:23:46.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">752	4528	KeePass.exe	0x9908da51b300	4	-	1	False	2023-05-19 14:25:34.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6344	700	svchost.exe	0x9908dd88a080	5	-	0	False	2023-05-19 14:25:49.000000 	N/A	Disabled</span><br></span></code></pre></div></div>
<p>In this example we can see that the KeePass process was running on the host machine. The PID retrieved is â€œ752â€.
Using volatility3, one can dump this process layer and retrieve all the sections linked to the virtual address spaces. Once completed, one can map virtual pages to physical pages and extract the residing data.</p>
<p>A custom plugin allows to parse the data to isolate the relevant patterns (in this case â€œâ—â€) seeking to further attempt the reconstruction of the master KeePass password entered by a user. The plugin can be found here: <a href="https://github.com/forensicxlab/volatility3_plugins/blob/main/keepass.py" target="_blank" rel="noopener noreferrer">https://github.com/forensicxlab/volatility3_plugins/blob/main/keepass.py</a></p>
<p>By passing the PID of the process to the volatility3 KeePass plugin, one can try to reconstruct the master password:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/Memory Analysis/MemoryImages/KeePassMachine Â» vol -f KeePassMachine.mem windows.keepass --pid 752                                                                                                          k1nd0ne@MacBook-Pro-de-Felix</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.4.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  100.00		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Offset	Size	Constructed_Password</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3ba6000	0x1000	u</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3ba7000	0x1000	up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3ba7000	0x1000	upe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3ba8000	0x1000	uper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3ba9000	0x1000	uperM</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3ba9000	0x1000	uperMa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3baa000	0x1000	uperMa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3baa000	0x1000	uperMas</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bab000	0x1000	uperMast</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bab000	0x1000	uperMaste</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bac000	0x1000	uperMaste</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bac000	0x1000	uperMaster</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPas</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPassw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPasswo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPasswor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x3bad000	0x7000	uperMasterPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffbf8ac5000	0x1000	uperMasterPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x96e545bd2000	0x1000	{u,,}perMasterPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xc58000400000	0x200000	{u,&amp;,o}perMasterPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xf80564600000	0x1200000	{u,&amp;,,,J}perMasterPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xf805737d3000	0x1f000	{u,&amp;,,,o, }perMasterPassword</span><br></span></code></pre></div></div>
<p>Even if the first character of the password is not store in memory, the latter can be however easily brute forced.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">â€‹</a></h2>
<p>To conclude this article, we demonstrated that the reconstruction of a master password of Keepass can be implemented into volatility3 framework via a custom plugin. The discovery of new memory extraction techniques is helping the field of digital forensics and specially law enforcement agencies that are now able to access memory from devices in a more efficient and non-destructive way. This methodology could be valuable in solving actual incident cases, including past ones where the memory was retrieved and stored and keepass master password remained unbroke.</p>
<blockquote>
<p>This plugin was tested on a Win10 22H2 memory image. Do not hesitate to reach me at <a href="mailto:felix.guyard@forensicxlab.com" target="_blank" rel="noopener noreferrer">felix.guyard@forensicxlab.com</a> to enhance this article.</p>
</blockquote>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">â€‹</a></h2>
<ol>
<li id="user-content-fn-1-8d99df">
<p><a href="https://sourceforge.net/u/v2023/profile/" target="_blank" rel="noopener noreferrer">https://sourceforge.net/u/v2023/profile/</a> <a href="#user-content-fnref-1-8d99df" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">â†©</a></p>
</li>
<li id="user-content-fn-2-8d99df">
<p><a href="https://sourceforge.net/p/keepass/discussion/329220/thread/f3438e6283/" target="_blank" rel="noopener noreferrer">https://sourceforge.net/p/keepass/discussion/329220/thread/f3438e6283/</a> <a href="#user-content-fnref-2-8d99df" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">â†©</a></p>
</li>
<li id="user-content-fn-3-8d99df">
<p><a href="https://github.com/vdohney/keepass-password-dumper" target="_blank" rel="noopener noreferrer">https://github.com/vdohney/keepass-password-dumper</a> <a href="#user-content-fnref-3-8d99df" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">â†©</a> <a href="#user-content-fnref-3-8d99df-2" data-footnote-backref="" aria-label="Back to reference 3-2" class="data-footnote-backref">â†©<sup>2</sup></a></p>
</li>
<li id="user-content-fn-4-8d99df">
<p><a href="https://github.com/CMEPW/keepass-dump-masterkey" target="_blank" rel="noopener noreferrer">https://github.com/CMEPW/keepass-dump-masterkey</a> <a href="#user-content-fnref-4-8d99df" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">â†©</a></p>
</li>
<li id="user-content-fn-5-8d99df">
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32784" target="_blank" rel="noopener noreferrer">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32784</a> <a href="#user-content-fnref-5-8d99df" data-footnote-backref="" aria-label="Back to reference 5" class="data-footnote-backref">â†©</a></p>
</li>
</ol>
</section></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/dfir">DFIR</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory Forensics</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/kee-pass">KeePass</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/windows">Windows</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/steam"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">ğŸ”¦ Video Games Forensics - Steam</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/ewf"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">ğŸ”¦ Debunking the Expert Witness Compression Format (EWF)</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vulnerability-description" class="table-of-contents__link toc-highlight">Vulnerability description</a></li><li><a href="#the-keepass-volatility3-plugin" class="table-of-contents__link toc-highlight">The KeePass volatility3 plugin</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 Forensicxlab</div></div></div></footer></div>
</body>
</html>