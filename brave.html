<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v5.6.3, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v5.6.3, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/forensicxlab-350x122.png" type="image/x-icon">
  <meta name="description" content="">

  <title>Cyberdefenders - Brave</title>
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

  <section data-bs-version="5.1" class="menu cid-t0PzKLYkxn" once="menu" id="menu1-17">
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                        <img src="assets/images/forensicxlab-350x122.png" alt="Mobirise Website Builder" style="height: 4.6rem;">
                    </a>
                </span>

            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="blog.html">Blog</a></li>
                    <li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="contact.html">Contact</a></li></ul>


            </div>
        </div>
    </nav>

</section>

<section data-bs-version="5.1" class="image3 cid-t6Fuq6URr9" id="image3-1o">




    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-4">
                <div class="image-wrapper">
                    <img src="assets/images/brave/brave-logo.jpg" alt="">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-1">Writeup</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content4 cid-t6Fuq7pofY" id="content4-1q">


    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-12">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-5">Cyberdefenders</h3>
                <h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-7">Félix Guyard - 11.07.2022</h4>

            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-t6Fuq7xmx8" id="content5-1r">

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-12">
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-3 display-5">Brave</h4>
                <p class="mbr-text mbr-fonts-style display-7">This writeup is covering the <a href="https://cyberdefenders.org/blueteam-ctf-challenges/67">cyberdefenders.org</a> challenge named "Brave".
                  Today we are going to solve this challenge using the VolWeb memory analysis platform. &nbsp;
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-t6Fuq7P3ne" id="content5-1u">

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-12">

                <h4 class="mbr-section-subtitle mbr-fonts-style mb-3 display-5">Scenario</h4>
                <p class="mbr-text mbr-fonts-style display-7">
                  A memory image was taken from a seized Windows machine. Analyze the image and answer the provided questions.
                </p>

                <h4 class="mbr-section-subtitle mbr-fonts-style mb-3 display-5">Analysis creation</h4>
                <p class="mbr-text mbr-fonts-style display-7">
                  After fireing up your instance of VolWeb, login to the platform, create a new Windows investigation and upload the challenge memory image.
                  Once the image is uploaded, launch the analysis from the "Analysis" menu. Once it's finished, select the analysis and click the "Review results" button.
                </p>
                  <img src="assets/images/brave/1.png" alt="">

<p class="mbr-text mbr-fonts-style display-7">
  From there, we can start our investigation of the memory image using the left panel by clicking on the "Plugins" button.
  From the first default displayed menu named "Case", we have the information we need to answer question #2 about the SHA256 value of the RAM image which is : <b>9db01b1e7b19a3b2113bfb65e860fffd7a1630bdf2b18613d206ebf2aa0ea172</b>
</p>
<img src="assets/images/brave/2.png" alt="">


<h4 class="mbr-section-subtitle mbr-fonts-style mb-3 display-5">Process Analysis</h4>

<p class="mbr-text mbr-fonts-style display-7">
Let's try to find what tool were used to dump the memory of this machine and at the same time, identify the PID of "brave.exe" to answer question #1 & #3. For this we are going to go throught the process tree graph.
</p>
</div>
<div class="col-md-6">
<img src="assets/images/brave/4.png" alt="">
</div>
<div class="col-md-6">
  <img src="assets/images/brave/5.png" alt="">
</div>
<div class="col-md-12">
<p class="mbr-text mbr-fonts-style display-7">
Using this plugin, we immediately have the process ID of brave.exe which is <b>4856</b> and thus, is the answer for question <b>#3</b>.
If we look deeper into the tree we can also spot "FTK Imager" which is a known forensic tool that can be used to dump memory from a live system.
</p>

<p class="mbr-text mbr-fonts-style display-7">
To answer question #1, we need to find the time at which the RAM image was fully acquired.
For this, I like to use the timeline plugin.
It's always good to take a look at the timeline to have a good view of the activities registered on the machine.
 We can try to identify the time at which the memory dump was finished by looking for the FTK Imager activities.
 We know that when the dumping procedure is finished, we have no more information registered, which means we need to identify the last event timestamp recorded.<br>
 Looking at the timeline, we find the following :
</p>
<img src="assets/images/brave/7.png" alt="">

<p class="mbr-text mbr-fonts-style display-7">
This timestamp 2021-04-30 17:52:18 is the latest identified. By looking at the cyberdefenders challenge, we know that the last digit of the answer is "19" which is one second greater than our result.
The answer for question <b>#1</b> is indeed <b>2021-04-30 17:52:19</b>.
</p>

<h4 class="mbr-section-subtitle mbr-fonts-style mb-3 display-5">Network analysis</h4>

</div>

<div class="col-6 mb-4">
<p class="mbr-text mbr-fonts-style display-7">
To answer question <b>#4</b>, we can use the <b>netscan</b> and the <b>netstat</b> plugin. By using the search bar, we can look for the key word "ESTABLISHED" and count how many connections are identified :
For this question, the "netstat" plugin is returning 10 connections marked as ESTABLISHED, and only 9 connections for the "netscan" plugin. The answer for question #4 is indeed <b>10</b>.
</p>
</div>
<div class="col-6 mb-4">
<img src="assets/images/brave/8.png" alt="">
</div>
<div class="col-6">

<p class="mbr-text mbr-fonts-style display-7">
For the next question, we are looking for a FQDN that the chrome process established a connection with.
By looking at the IP contacted by the chrome processes, we can extract some public IP addresses.
</p>
</div>


<div class="col-6">
<img src="assets/images/brave/9.png" alt="">

</div>

<div class="col-md-12 col-lg-12">
  <p class="mbr-text mbr-fonts-style display-7">
  Using the tool of your choice, you can search for the FQDN linked to IP addresses we have found.
  To conclude, the domain is <b>protonmail.ch</b>, which is the right answer for question <b>#5</b>.
  </p>
<img src="assets/images/brave/10.png" alt="">
<p class="mbr-text mbr-fonts-style display-7">
The next question is asking us the MD5 hash value of process memory for PID 6988. For this one, we are going to use the "DumpProcess" option of VolWeb, enter the PID, download the process and calculate the signature.
</p>
</div>
<div class="col-4">
  <img src="assets/images/brave/11.png" alt="">
</div>
<div class="col-8">
  <img src="assets/images/brave/12.png" alt="">
  <img src="assets/images/brave/13.png" alt="">
</div>


<div class="col-md-12 col-lg-12">
  <p class="mbr-text mbr-fonts-style display-7">
  Then answer for question <b>#6</b> is indeed <b>0b493d8e26f03ccd2060e0be85f430af</b>.
  </p>


  <p class="mbr-text mbr-fonts-style display-7">
    For the next question we need to go fetch the word starting at offset 0x45BE876 with a length of 6 bytes in the memory dump. We can write a simple python3 script to do this.
  </p>

  <pre><code class="python">
import sys
with open(sys.argv[1],"rb") as process:
    process.seek(0x45BE876)
    word = process.read(6)
    print(word)

OUTPUT :
~/work/DFIR/Cyberdefender/c49-AfricanFalls2 » python3 extract.py 20210430-Win10Home-20H2-64bit-memdump.mem                                                                                                           k1nd0ne@MacBook-Pro-de-Felix
b'hacker'
  </code></pre>

  <p class="mbr-text mbr-fonts-style display-7">
The answer is indeed <b>hacker</b> for question <b>#7</b>.

  </p>

</div>
<div class="col-md-8">
  <p class="mbr-text mbr-fonts-style display-7">
    Question <b>#8</b> is pretty straight forward, just go back to using the ProcessTree plugin and fetch the PPID of "powershell.exe".
  </p>
</div>
<div class="col-md-4">
  <img src="assets/images/brave/14.png" alt="">
</div>


<div class="col-md-4 mt-4">
<p class="mbr-text mbr-fonts-style display-7">
For question <b>#9</b>, we need to investigate to find the full path and name of the last file opened in notepad. The CmdLine plugin is the way to go for this question.
Indeed, we can look for the keyword "notepad" in the Cmdline search bar and extract the answer which is <b>C:\Users\JOHNDO~1\AppData\Local\Temp\7zO4FB31F24\accountNum</b>.
</p>
</div>
<div class="col-md-8 mt-4">
  <img src="assets/images/brave/15.png" alt="">
</div>


<div class="col-md-4 mt-4">
<p class="mbr-text mbr-fonts-style display-7">
  The last question is a little bit more tricky. Windows systems maintain a set of keys in the registry database (UserAssist keys) to keep track of programs that executed.
We can use the UserAssist plugin and look for the execution of brave and how long it was used (Time Focused). The answer is <b>04:01:54</b>
</p>
</div>
<div class="col-md-8 mt-4">
  <img src="assets/images/brave/16.png" alt="">
</div>

<div class="col-md-12 mt-4">
<h4 class="mbr-section-subtitle mbr-fonts-style mb-3 display-5">Conclusion</h4>
<p class="mbr-text mbr-fonts-style display-7">
To conclude this writeup, we were able to use the VolWeb platform to easly get answers and make our investigation more efficient.
VolWeb is based on volatility3 and therefore doesn't fully cover all the cyberdefenders.org memory analysis challenges questions at the moment.
Happy hunting !
</p>
</div>
      </div>
        </div>
    </div>
</section>
<section data-bs-version="5.1" class="footer7 cid-t6Fuq9n1au" once="footers" id="footer7-20">
    <div class="container">
        <div class="media-container-row align-center mbr-white">
            <div class="col-12">
                <p class="mbr-text mb-0 mbr-fonts-style display-7">
                    © Copyright 2022 forensicxlab - All Rights Reserved
                </p>
            </div>
        </div>
    </div>
</section>
</html>
