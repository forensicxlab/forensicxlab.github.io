"use strict";(self.webpackChunkexhume=self.webpackChunkexhume||[]).push([[6936],{3036:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/4-ba0b473b2a4ed4f1921a064e585e9729.svg"},4434:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/2-f6ba1c6a3eb9bd3f8dfeb223712c714d.svg"},5120:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/7-ad5ea370e0b35f21b49d81f37bc4db05.png"},5655:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/8-dc231c20772e9df0bc19102207dac8d1.png"},5673:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/6-5cf28d6e4da70ca7519e63aa3c6638d9.png"},6713:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/9-5eb32b6bde0a1336e45ed22102408a43.svg"},6769:e=>{e.exports=JSON.parse('{"permalink":"/blog/thanatology-4","source":"@site/blog/2025-12-25-thanatology-4/index.md","title":"\ud83e\udd89 Thanatology part 4: Filesystem Forensics with the Exhume ToolKit.","description":"This blog post is part of the Thanatology blog post series. If you haven\u2019t checked it out, I recommend reading the following first:","date":"2025-12-25T00:00:00.000Z","tags":[{"inline":true,"label":"Thanatology","permalink":"/blog/tags/thanatology"},{"inline":true,"label":"Exhume","permalink":"/blog/tags/exhume"},{"inline":true,"label":"Digital Forensics","permalink":"/blog/tags/digital-forensics"},{"inline":true,"label":"Filesystem","permalink":"/blog/tags/filesystem"}],"readingTime":14.41,"hasTruncateMarker":true,"authors":[{"name":"k1nd0ne","title":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","page":{"permalink":"/blog/authors/k-1-nd-0-ne"},"socials":{"x":"https://x.com/k1nd0ne","github":"https://github.com/k1nd0ne","bluesky":"https://bsky.app/profile/k1nd0ne.bsky.social"},"imageURL":"https://avatars.githubusercontent.com/u/27780432?v=4","key":"k1nd0ne"}],"frontMatter":{"slug":"thanatology-4","title":"\ud83e\udd89 Thanatology part 4: Filesystem Forensics with the Exhume ToolKit.","authors":["k1nd0ne"],"tags":["Thanatology","Exhume","Digital Forensics","Filesystem"],"draft":false},"unlisted":false,"nextItem":{"title":"\ud83d\udce6 VolWeb v3.15 July 2025 Release","permalink":"/blog/volweb-3-15"}}')},6852:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/10-542fd060aa2532b698d7983767bd34a7.png"},7075:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/3-a3ea9f2c5638f1bb7f93d22dee2d3989.svg"},7490:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/5-d7a5bb91ee764ecb2e4a5af72cb864d0.png"},7981:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/11-1f314c01a0703157dca22d05bc4a004e.png"},7992:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var s=i(6769),n=i(4848),o=i(8453);const a={slug:"thanatology-4",title:"\ud83e\udd89 Thanatology part 4: Filesystem Forensics with the Exhume ToolKit.",authors:["k1nd0ne"],tags:["Thanatology","Exhume","Digital Forensics","Filesystem"],draft:!1},l=void 0,r={authorsImageUrls:[void 0]},d=[{value:"Filesystems",id:"filesystems",level:2},{value:"File systems in digital forensics",id:"file-systems-in-digital-forensics",level:3},{value:"Kinds of Filesystems",id:"kinds-of-filesystems",level:2},{value:"The Exhume ToolKit - Filesystem investigation",id:"the-exhume-toolkit---filesystem-investigation",level:2},{value:"Exhume Filesystem modules",id:"exhume-filesystem-modules",level:3},{value:"An Example",id:"an-example",level:4},{value:"Exhume Filesystem abstraction module",id:"exhume-filesystem-abstraction-module",level:3},{value:"Example",id:"example",level:4},{value:"Bridge to the Thanatology project",id:"bridge-to-the-thanatology-project",level:2},{value:"Step 1: Filesystem identification",id:"step-1-filesystem-identification",level:3},{value:"Step 2: Filesystem indexation",id:"step-2-filesystem-indexation",level:3},{value:"Step 3: Visualisation",id:"step-3-visualisation",level:3},{value:"Conclusion",id:"conclusion",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"This blog post is part of the Thanatology blog post series. If you haven\u2019t checked it out, I recommend reading the following first:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://www.forensicxlab.com/blog/thanatology",children:"Thanatology part 1: Introduction to the Thanatology project"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://www.forensicxlab.com/blog/thanatology-2",children:"Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://www.forensicxlab.com/blog/thanatology-3",children:"Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit."})}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"In the previous part, we discovered how to perform partition discovery for the MBR and GPT layouts. The next step in our digital forensics examination process of a disk image is to identify the type of Filesystem present on a given partition and extract relevant data. In this blog post, we will first dive into the concept of file systems in general. Next, we will explore how the Exhume toolkit is designed to propose a way to understand multiple kinds of file systems and introduce an abstraction module. Finally, some updates on the Thanatology project will be proposed."}),"\n",(0,n.jsx)(t.h2,{id:"filesystems",children:"Filesystems"}),"\n",(0,n.jsx)(t.p,{children:"As humans, we began to keep everything recorded and organised in the physical world to track our actions over time. If you are looking for a payment you made three months ago to someone who is claiming you didn't, you will be able to prove that the accusation is wrong by looking inside the record containing all of your expenses in time. If you forgot one ingredient for how to cook your favourite recipe, you'll be happy to check the record containing the recipe. In the end, to record and keep things organised, you need a physical and trustworthy tool, such as a pen and paper or a book."}),"\n",(0,n.jsx)(t.p,{children:"Well, a book is fine for keeping your recipes, but the amount of information we have to keep track of is now enormous, and computers are addressing this need with success. Instead of having an enormous room with a lot of books, everything can now be shrunk and stored in digital long-term memory storage objects (Hard drives, SSDs, etc.)."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(8977).A+"",title:"From Lib to Hardrive",width:"964",height:"504"})}),"\n",(0,n.jsx)(t.p,{children:"Now, how would you keep your library organised? How would you sort, categorise, and access them? What would you do if you wanted to get rid of the content of a book? Would you burn it? Just remove what was written on each pages to be able to write in the same book again?"}),"\n",(0,n.jsxs)(t.p,{children:['The fact is that now, as a user of an operating system, you don\'t really control the organisation of your "library" anymore; you are bound to ask to manipulate the data you want to interact with, with no say on how it is stored or organised. You could say: "',(0,n.jsx)(t.em,{children:"On my machine, I'm managing my files and folders as you would in a library"}),'". But it is you working with a layer of abstraction provided by the operating system to manipulate data. When you click on the "Delete" button to remove a file from your disk, you are not really in control of how the file will be deleted (how your book will be destroyed); you are just "asking" your ',(0,n.jsx)(t.strong,{children:"operating system"})," to do it for you. It's as if you are now interacting with a librarian. You ask for information from a book, and the librarian will take care of it for you. They know the organisation of the library and how to access the information you want, so you don't have to worry about it anymore. You are trusting this person to manage the library well."]}),"\n",(0,n.jsxs)(t.p,{children:["In our digital world now, ",(0,n.jsx)(t.strong,{children:"a filesystem is an organisational methodology used to keep your files organised on a digital storage solution"}),". An like there are different ways to keep a library organised, there is different ways to manage files on a storage medium. Therefore, other kinds of file systems exist. The operating system's job is to understand how to work with the file system to provide data to the end user. In our case, the librarian is the operating system."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(4434).A+"",title:"The librarian",width:"1096",height:"715"})}),"\n",(0,n.jsx)(t.h3,{id:"file-systems-in-digital-forensics",children:"File systems in digital forensics"}),"\n",(0,n.jsx)(t.p,{children:"Let's say you are an investigator. A person is under arrest for a crime; the information that he is guilty is potentially stored in his personal library, managed by his librarian. However, you will not be able to ask the librarian anything, as you have frozen the place, and the librarian of the suspect cannot be approached. You now need to understand how the library is organised: how books are stored and accessed, and how they are shelved. If they are not well shredded, you can maybe retrieve some pages."}),"\n",(0,n.jsx)(t.p,{children:"In the digital forensics world, the same principle applies; you cannot directly investigate using the suspect's operating system. Instead, you freeze the data to ensure integrity is preserved."}),"\n",(0,n.jsx)(t.p,{children:'I\'m using the word "freeze" , but in practice, in the digital forensics field, that means we perform analysis in a way that does not modify the evidence:'}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"We keep access read-only (write-blocking for physical drives, or read-only handling for images)."}),"\n",(0,n.jsx)(t.li,{children:"We avoid using the suspect operating system to interpret the disk, and we avoid any operation that could modify metadata."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Then, you need to understand what kind of file system is used and how it manages the records (files) and organises them. The better understanding you have of a filesystem, the better you'll be able to retrieve information. By design, some file systems do not completely delete records for performance reasons, for example."}),"\n",(0,n.jsx)(t.p,{children:"Returning to our library metaphor, if you had multiple library experts on your team who understand various library organisations, you could ask them to retrieve a specific record for you. In the digital forensics, that would be the toolsets of a digital forensics tools to understand multiple kinds of file systems."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(7075).A+"",title:"Versus",width:"1402",height:"1145"})}),"\n",(0,n.jsxs)(t.p,{children:["The first quick conclusion we can make is: ",(0,n.jsx)(t.strong,{children:"the better a digital forensics investigator understands how a filesystem works and its inner workings, the better they will be able to extract the data they need to build their case."})]}),"\n",(0,n.jsx)(t.h2,{id:"kinds-of-filesystems",children:"Kinds of Filesystems"}),"\n",(0,n.jsxs)(t.p,{children:['There are many file system types, each providing ways to store data depending on the goals. Not all of the filesystems can be "understood" by a single operating systems. Operating systems are usually built to work with some specific file systems. For example, Microsoft Windows, by default, works with the New Technology File System (NTFS) but cannot work with the Extended Filesystem Version 4 (ext4) by default, whereas the Linux Operating system, for example, can work with ext4. As a digital forensics investigator, the better we understand a file system and how the operating system uses it to store information, the better we can build the dedicated tools to extract artefacts. There are many file system types, you can find an exhaustive list here: ',(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/List_of_file_systems",children:"https://en.wikipedia.org/wiki/List_of_file_systems"})]}),"\n",(0,n.jsx)(t.h2,{id:"the-exhume-toolkit---filesystem-investigation",children:"The Exhume ToolKit - Filesystem investigation"}),"\n",(0,n.jsx)(t.p,{children:"To be able to interact with these types of filesystems from a digital forensics perspective, we have architected the exhume framework to provide the digital forensics experts and investigators with the following capabilities:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Dive into a file system type and extract information related to its specific characteristics."}),"\n",(0,n.jsx)(t.li,{children:"Propose API functions for each module to develop specific extraction modules that automate artefact collection."}),"\n",(0,n.jsx)(t.li,{children:"Provide a higher level of abstraction that normalises information across filesystem types."}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"exhume-filesystem-modules",children:"Exhume Filesystem modules"}),"\n",(0,n.jsx)(t.p,{children:"The principle is as follows: for each filesystem type, an exhume module is created, providing a Command Line Interface for some investigators and API functions for investigators with developing skills. This way, each exhume module can be customised to propose unique features related to this specific file system type. An expert in a particular kind of file system can contribute to developing specific functionalities that enhance its capabilities for a particular digital forensic task."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(3036).A+"",title:"Exhume Modules",width:"1372",height:"372"})}),"\n",(0,n.jsx)(t.p,{children:"The Exhume Toolkit currently propose three filesystem modules:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"ExFAT (exhume_exfat)"}),"\n",(0,n.jsx)(t.li,{children:"Extended Filesystem (exhume_extfs)"}),"\n",(0,n.jsx)(t.li,{children:"New Technology Filesystem (exhume_ntfs)"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Each is capable of understanding the associated file systems and can extract specific data. They can be enhanced by the community at any point, making them very flexible."}),"\n",(0,n.jsx)(t.h4,{id:"an-example",children:"An Example"}),"\n",(0,n.jsx)(t.p,{children:"Let's see an example. I have here a digital forensics disk image. I have discovered it is using a Linux Filesystem using the exhume_partitions module's CLI."}),"\n",(0,n.jsxs)(t.p,{children:["Using the following command: ",(0,n.jsx)(t.code,{children:"exhume_partitions --body workshop-kali.E01"})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(7490).A+"",title:"Exhume Modules",width:"5505",height:"2376"})}),"\n",(0,n.jsxs)(t.p,{children:["In this situation, the Linux Filesystem starts at the absolute address offset ",(0,n.jsx)(t.strong,{children:"0x100000"})," and has a size of ",(0,n.jsx)(t.strong,{children:"0x9c00000"})," sectors. Let's try to use the exhume_extfs module. First, we need to install it with the following command:"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"cargo install exhume_extfs"})}),"\n",(0,n.jsx)(t.p,{children:"Next, we can get information about the cli using the following command:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"exhume_extfs --help"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"Exhume artefacts from an EXTFS partition.\n\nUsage: exhume_extfs [OPTIONS] --body <body> --offset <offset> --size <size>\n\nOptions:\n  -b, --body <body>            The path to the body to exhume.\n  -f, --format <format>        The format of the file, either 'raw' or 'ewf'.\n  -o, --offset <offset>        The extfs partition starts at address (decimal or hex).\n  -s, --size <size>            The size of the extfs partition in sectors (decimal or hex).\n  -i, --inode <inode>          Display the metadata about a specific inode number (>=2).\n  -d, --dir_entry              If --inode is specified, and it is a directory, list its directory entries.\n      --dump                   If --inode is specified, dump its content to a file named 'inode_<N>.bin'.\n      --superblock             Display the superblock information.\n      --journal                Display the journal block listing (jls).\n  -j, --json                   Output specific structures (superblock, inode) in JSON format.\n  -l, --log-level <log_level>  Set the log verbosity level [default: info] [possible values: error, warn, info, debug, trace]\n      --recover                Scan all free inodes and carve deleted files\n  -t, --timeline               Print a JSON timeline assembled from the ext4 journal\n  -h, --help                   Print help\n  -V, --version                Print version\n"})}),"\n",(0,n.jsx)(t.p,{children:"In the Extended File System, the superblock holds important metadata about how this file system stores files. Let's try to print the superblock information using the following command:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"exhume_extfs --body workshop-kali.E01 --offset 0x100000 --size 0x9c00000 --superblock"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(5673).A+"",title:"Exhume Modules",width:"3507",height:"6216"})}),"\n",(0,n.jsx)(t.p,{children:"To fully understand the output, the digital forensics investigator must be educated on the internals of this specific file system. Therefore, the exhume module dedicated to this file system aims to provide everything the experts need to retrieve the information."}),"\n",(0,n.jsx)(t.p,{children:'In the extended file system world, files and directories are all represented and identified as "inodes". The root directory has the inode number 2. We can display the Inode 2 directory entry members with the following command:'}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"exhume_extfs --body workshop_kali.E01 --offset 0x100000 --size 0x9c00000 --inode 2 --dir_entry"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(5120).A+"",title:"Exhume Modules",width:"3213",height:"2256"})}),"\n",(0,n.jsx)(t.p,{children:"Here we are witnessing the list of inodes in the directory entry of the inode number 2. We can also, for example, retrieve the metadata about  inode two just with the following:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"exhume_extfs --body workshop_kali.E01 --offset 0x100000 --size 0x9c00000 --inode 2"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(5655).A+"",title:"Exhume Modules",width:"3231",height:"3876"})}),"\n",(0,n.jsxs)(t.p,{children:["Finally, we can utilise the ",(0,n.jsx)(t.strong,{children:"--recover"})," unique flag of this module to attempt to recover files based on research conducted on this filesystem."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"[2025-12-25T15:00:15Z INFO  exhume_body] Detected an EWF disk image.\n[2025-12-25T15:00:15Z INFO  exhume_extfs::superblock] Extended FileSystem Journaling feature is on.\n[2025-12-25T15:00:15Z INFO  exhume_extfs] Scanning filesystem for deleted files\u2026\n[2025-12-25T15:09:54Z INFO  exhume_extfs] Recovered 5 deleted file(s)\ninode 4458900  inode_4458900.bin               (131072\u202fbytes)\ninode 4458901  inode_4458901.bin               (1892\u202fbytes)\ninode 4458902  inode_4458902.bin               (1892\u202fbytes)\ninode 4458907  inode_4458907.bin               (1892\u202fbytes)\ninode 4458908  inode_4458908.bin               (1892\u202fbytes)\n"})}),"\n",(0,n.jsx)(t.h3,{id:"exhume-filesystem-abstraction-module",children:"Exhume Filesystem abstraction module"}),"\n",(0,n.jsx)(t.p,{children:"The filesystem-specific modules are functional for experts who have a deep understanding of their layout. However, digital investigators usually want to be able to quickly extract files to index them in a normalised way and get into details maybe later, depending on the context."}),"\n",(0,n.jsx)(t.p,{children:"For this, I had to think of a top-level filesystem extraction module to automatically detect the filesystem and propose basic digital forensics features that can be achieved by combining the shared characteristics across filesystems. The following was identified:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Filesystem metadata extraction"}),"\n",(0,n.jsx)(t.li,{children:"Filesystem enumeration"}),"\n",(0,n.jsx)(t.li,{children:"File metadata extraction"}),"\n",(0,n.jsx)(t.li,{children:"File content extraction"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"We have abstracted the concepts of a File and a DirectoryEntry using the power of Rust traits. Using this methodology, each filesystem type implemented in the future can also implement the Filesystem Trait of exhume_filesystem."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(6713).A+"",title:"Exhume Modules",width:"1388",height:"699"})}),"\n",(0,n.jsxs)(t.admonition,{type:"info",children:[(0,n.jsx)(t.p,{children:"exhume_filesystem provides a unified interface across multiple filesystems. However, a normalised model will always hide important filesystem-specific semantics. For example:"}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:'Timestamps are not equivalent across file systems (and even within a single file system). "Deletion time" may not exist or may have different update rules.'}),"\n",(0,n.jsx)(t.li,{children:"Identity differs: ext4 uses inodes, NTFS uses MFT record, and exFAT uses directory entry structures. We use the identification system of the filesystem itself when present and create our own when it is not present."}),"\n",(0,n.jsx)(t.li,{children:"Some features are filesystem-specific (e.g., NTFS Alternate Data Streams) and have no direct equivalent in other file systems."}),"\n"]}),(0,n.jsx)(t.p,{children:"For this reason, the abstraction layer focuses on everyday operations (enumeration, basic metadata, content extraction) while each filesystem module can expose extended/raw metadata for deeper analysis."})]}),"\n",(0,n.jsx)(t.h4,{id:"example",children:"Example"}),"\n",(0,n.jsx)(t.p,{children:"To use exhume_filesystem, we can install it with the following command:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"cargo install exhume_filesystem"})}),"\n",(0,n.jsxs)(t.p,{children:["Similarly, we can execute this module on our disk image and enumerate all files using the ",(0,n.jsx)(t.code,{children:"--enum"})," flag."]}),"\n",(0,n.jsxs)(t.p,{children:["Using our previous disk image following command is used: ",(0,n.jsx)(t.code,{children:"exhume_filesystem --body workshop-kali.E01 --offset 0x100000 --size 0x9c00000 --enum"})]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(6852).A+"",title:"Exhume Modules",width:"3444",height:"3156"})}),"\n",(0,n.jsx)(t.p,{children:"You can see that exhume_filesystem detects the filesystem used and, if compatible, executes the filesystem enumeration function related to the extended filesystem in that case. The following output is the result ran on an NTFS file system."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"alt text",src:i(7981).A+"",title:"Exhume Modules",width:"3138",height:"2316"})}),"\n",(0,n.jsx)(t.h2,{id:"bridge-to-the-thanatology-project",children:"Bridge to the Thanatology project"}),"\n",(0,n.jsx)(t.p,{children:"As mentioned in the first part of this series, one of my goals is to create a high-level Digital Forensics investigation tool for investigators, usable by people with different levels of expertise. The Exhume Toolkit API is used as the core engine for this project."}),"\n",(0,n.jsx)(t.p,{children:"The decision was made to divide the investigation of the disk image into multiple stages, which I will describe below."}),"\n",(0,n.jsx)(t.h3,{id:"step-1-filesystem-identification",children:"Step 1: Filesystem identification"}),"\n",(0,n.jsx)(t.p,{children:"When choosing the partition to process by the Thanatology engine, the exhume_filesystem detection library is used to check if the targeted filesystem is supported."}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/11.png",alt:"Partition discovery and selection in Thanatology"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"Partition discovery and selection in Thanatology"})})]}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/12.png",alt:"Filesystem detection in Thanatology"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"Filesystem detection in Thanatology"})})]}),"\n",(0,n.jsx)(t.h3,{id:"step-2-filesystem-indexation",children:"Step 2: Filesystem indexation"}),"\n",(0,n.jsx)(t.p,{children:"Using the exhume_filesystem API, we can enumerate every file and index them in a SQLite database to perform other actions on them later and display the extracted metadata to the user."}),"\n",(0,n.jsx)(t.p,{children:"Thanatology will first discover and index all the files in the SQLite database, then execute other analysis dedicated modules, such as file type identification, artefact extraction, and more, in due time."}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/13.png",alt:"Filesystem detection in Thanatology"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"Filesystem file discovery and indexation"})})]}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/14.png",alt:"Filesystem detection in Thanatology"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"Filesystem detection in Thanatology"})})]}),"\n",(0,n.jsx)(t.h3,{id:"step-3-visualisation",children:"Step 3: Visualisation"}),"\n",(0,n.jsx)(t.p,{children:"Now that the files are indexed, we can provide the user with a visualisation interface. He will be able to interact with the file. If the investigator wants to fetch the content of a file, he will be able to do so. The exhume_filesystem API will be used behind the scenes to fetch the data."}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/15.png",alt:"Filesystem data visualisation"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"Filesystem metadata visualisation"})})]}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/16.png",alt:"Filesystem data visualisation"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"Filesystem listing"})})]}),"\n",(0,n.jsxs)("figure",{style:{border:"1px solid #888",padding:20},children:[(0,n.jsx)("img",{src:"/img/thanatology-4/17.png",alt:"Filesystem data visualisation"}),(0,n.jsx)("figcaption",{children:(0,n.jsx)("i",{children:"File content investigation."})})]}),"\n",(0,n.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(t.p,{children:"In this part, we moved from partition discovery to filesystem-level forensics:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"We introduced why investigators need to understand filesystem on-disk structures."}),"\n",(0,n.jsx)(t.li,{children:"We showed how Exhume\u2019s filesystem modules expose deep, filesystem-specific views and capabilities."}),"\n",(0,n.jsx)(t.li,{children:"We presented exhume_filesystem, a higher-level layer that can detect supported file systems and provide standard capabilities, such as enumeration, basic metadata extraction, and file content extraction."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The abstraction layer intentionally focuses on common denominators; some filesystem-specific semantics (multiple timestamp sources, NTFS ADS, special metadata) are best handled in the dedicated modules."}),"\n",(0,n.jsx)(t.p,{children:"In the next part of the series, we will build on the indexed filesystem view to automate artefact extraction and analysis modules (file type identification, targeted parsers, and timeline-oriented workflows). We will link to Thanatology\u2019s database-backed approach."}),"\n",(0,n.jsxs)(t.p,{children:["If you want to get involved into this project, we have created a Discord Community Server that you can join using the following ",(0,n.jsx)(t.a,{href:"https://discord.com/invite/AqkYgR5HEg",children:"link"}),"."]})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>l});var s=i(6540);const n={},o=s.createContext(n);function a(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(o.Provider,{value:t},e.children)}},8977:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/1-230d759f47edd088d3bcf7857b429af1.svg"}}]);