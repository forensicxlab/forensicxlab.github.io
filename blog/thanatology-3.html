<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">ü¶â Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit. | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.forensicxlab.com/blog/thanatology-3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="ü¶â Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit. | Forensicxlab"><meta data-rh="true" name="description" content="This blogpost is part of the Thanatology blogpost series. If you haven‚Äôt check it out, I recommend reading the following first:"><meta data-rh="true" property="og:description" content="This blogpost is part of the Thanatology blogpost series. If you haven‚Äôt check it out, I recommend reading the following first:"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-07-07T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="Thanatology,Exhume,Digital Forensics"><link data-rh="true" rel="canonical" href="https://www.forensicxlab.com/blog/thanatology-3"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/thanatology-3" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.forensicxlab.com/blog/thanatology-3" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.forensicxlab.com/blog/thanatology-3","mainEntityOfPage":"https://www.forensicxlab.com/blog/thanatology-3","url":"https://www.forensicxlab.com/blog/thanatology-3","headline":"ü¶â Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.","name":"ü¶â Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.","description":"This blogpost is part of the Thanatology blogpost series. If you haven‚Äôt check it out, I recommend reading the following first:","datePublished":"2025-07-07T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.forensicxlab.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.02888316.css">
<script src="/assets/js/runtime~main.dff2b000.js" defer="defer"></script>
<script src="/assets/js/main.fb8e9ba9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/thanatology">Thanatology</a><a class="navbar__item navbar__link" href="/docs/exhume">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://discord.gg/AqkYgR5HEg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-4">ü¶â Thanatology part 4: Filesystem Forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volweb-3-15">üì¶ VolWeb v3.15 July 2025 Release</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/thanatology-3">ü¶â Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology-2">ü¶â Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vmdk">üî¶ A quick walkthrough in the VMDK format</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/thanatology">ü¶â Thanatology Part 1 - Introducing the Thanatology project</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/voliat">üì¶ Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volads">üì¶ Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hibernation">üìò Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">üìò Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">üî¶ Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/keepass">üì¶ Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">üî¶ Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">üß¨ Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anydesk">üì¶ Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">üì¶ Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">üì¶ Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">üñã Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volaslib">üìò Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">üìÑ Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">ü¶â Thanatology part 3: MBR and GPT forensics with the Exhume ToolKit.</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-07-07T00:00:00.000Z">July 7, 2025</time> ¬∑ <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://bsky.app/profile/k1nd0ne.bsky.social" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="Bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 226" class="authorSocialLink_owbf"><path fill="#1185FE" d="M55.491 15.172c29.35 22.035 60.917 66.712 72.509 90.686 11.592-23.974 43.159-68.651 72.509-90.686C221.686-.727 256-13.028 256 26.116c0 7.818-4.482 65.674-7.111 75.068-9.138 32.654-42.436 40.983-72.057 35.942 51.775 8.812 64.946 38 36.501 67.187-54.021 55.433-77.644-13.908-83.696-31.676-1.11-3.257-1.63-4.78-1.637-3.485-.008-1.296-.527.228-1.637 3.485-6.052 17.768-29.675 87.11-83.696 31.676-28.445-29.187-15.274-58.375 36.5-67.187-29.62 5.041-62.918-3.288-72.056-35.942C4.482 91.79 0 33.934 0 26.116 0-13.028 34.314-.727 55.491 15.172Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>This blogpost is part of the Thanatology blogpost series. If you haven‚Äôt check it out, I recommend reading the following first:</p>
<ul>
<li><a href="https://www.forensicxlab.com/blog/thanatology" target="_blank" rel="noopener noreferrer">Thanatology part 1: Introduction to the Thanatology project</a></li>
<li><a href="https://www.forensicxlab.com/blog/thanatology-2" target="_blank" rel="noopener noreferrer">Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit</a></li>
</ul>
<p>In this blogpost, we will dive into the concepts of GPT and MBR partition schemes and explore them using <a href="https://www.forensicxlab.com/docs/category/-exhume---partitions" target="_blank" rel="noopener noreferrer">Exhume Partitions</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="discovering-a-disk-image-layout">Discovering a Disk Image Layout<a href="#discovering-a-disk-image-layout" class="hash-link" aria-label="Direct link to Discovering a Disk Image Layout" title="Direct link to Discovering a Disk Image Layout">‚Äã</a></h2>
<p>In the last blogpost we presented how <a href="https://www.forensicxlab.com/docs/category/-exhume---body" target="_blank" rel="noopener noreferrer">Exhume Body</a> is providing us with an easy way of reading sectors on multiple disk image formats. Now that we have this module, the next step when performing the digital forensic analysis of a disk image is to discover its layout.</p>
<p>In order for any computer to load an operating system when powering it up, the processor must locate and execute bootstrapping code stored in a well-defined location on the disk. This code is typically found in the Master Boot Record (MBR) for legacy BIOS systems or the GUID Partition Table (GPT) for modern UEFI-based systems.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/1-7ecbce5c156857ed6b6a473b3980db6f.svg" width="3015" height="1357" class="img_ev3q"></p>
<p>These structures define how the disk is divided into partitions. Partitions are simply set of logical segments that can each contain a filesystem. Proper partition analysis helps forensic investigators understand how the disk was used, identify hidden or suspicious partitions, and extract meaningful artifacts. It also provides context, such as whether the disk uses a standard layout or one that suggests tampering or obfuscation.</p>
<p>Understanding the partitioning scheme is critical as an investigator, as it determines how data structures are interpreted in subsequent analysis phases. Once the partition layout is identified, each partition can be parsed individually for deeper inspection of its filesystem contents. In the later blogposts of this series we will dive into a lot of filesystems like extfs, NTFS, exFAT, and more!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metric-used-in-this-series">Metric used in this series<a href="#metric-used-in-this-series" class="hash-link" aria-label="Direct link to Metric used in this series" title="Direct link to Metric used in this series">‚Äã</a></h3>
<p>A bit of vocabulary so we are on the same page. In this blogpost and all of the others of this series:</p>
<p>A <strong>sector</strong> is the smallest addressable unit of data on a disk or other block storage device. Usually, a sector is <strong>512 bytes in size</strong>, though modern devices may use 4,096-byte (or 4K) sectors for improved efficiency. <strong>Unless specified, we will always use a 512 bytes size when mentioning sector size</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-master-boot-record-mbr">The Master Boot Record (MBR)<a href="#the-master-boot-record-mbr" class="hash-link" aria-label="Direct link to The Master Boot Record (MBR)" title="Direct link to The Master Boot Record (MBR)">‚Äã</a></h2>
<p>The Master Boot Record (MBR) is a special boot sector located at the very beginning of a storage device, typically the first 512 bytes (1 sector). It plays a crucial role in the booting process of legacy BIOS systems. The MBR consists of three main components: the bootloader code (usually the first 446 bytes), the partition table (the next 64 bytes), and a boot signature (the last 2 bytes, typically 0x55AA). The bootloader contains the machine code that initiates the process of loading the operating system. The partition table holds information about <strong>up to four primary partitions</strong>, including their type, starting sector, and size.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2-c2d11f075e2d5e51d238c43a4084cdd7.svg" width="2214" height="2000" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="partition-entries-in-mbr">Partition entries in MBR<a href="#partition-entries-in-mbr" class="hash-link" aria-label="Direct link to Partition entries in MBR" title="Direct link to Partition entries in MBR">‚Äã</a></h3>
<p>As you can see, an MBR partition entry is 16 bytes long and describes one partition on the disk. The partition table in the MBR contains space for up to four partition entries, located between byte 446 and 509 of the 512-byte MBR sector. In MBR, a partition entry is composed of metadata providing the necessary metadata to the system in order to continue the booting process.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/3-eb916d7ba80e31db2fd75eec66fd6279.svg" width="2188" height="1250" class="img_ev3q"></p>
<p>The boot indicator gives the information on whether the partition is bootable (active) with the value 0x80 or not bootable (inactive) with the value 0x00. Note that only one partition should be marked as active. Multiple active partitions should trigger your interest as a digital forensic investigator.
The Starting and Ending <a href="https://en.wikipedia.org/wiki/Cylinder-head-sector" target="_blank" rel="noopener noreferrer">CHS</a> Addresses are legacy special addresses used to locate the partition starting point. CHS stands for Cylinder-Head-Sector and is a legacy value divided into 3 bytes indicating the 3D coordinates and was used back in time when all disks were just a pile of cylinders with a head to read the data. It is very interesting to learn about CHS just to understand where all of those terms we are using are coming from.</p>
<p>Well, CHS is deprecated now, and the values you might find nowadays can be false because it‚Äôs deprecated. Instead, we know rely on the Logical Byte Addressing (LBA) metric. LBA is not a coordinate system but simply a linear numbering system to specify the location of (sectors) on a storage. In MBR the Start LBA is referring to the address of the beginning of the partition in sectors. A value of 0x800 means that the sector number 0x800  of the disk is the start of the partition. With this information we can compute the physical address in the entire disk in bytes as:</p>
<p style="text-align:center"><i>Absolute Address = LBA x SizeOfOneSector</i></p>
<p>In our example, the absolute address of the beginning of our partition would be 0x800 * 0x200 = 0x100000.  But where does the partition ends? Well, instead of using the end CHS address that is deprecated, we use the sector count field which represent the number of sectors taken by the partition. We just have to multiply this value by the size of one sector, and we have the size in bytes of the partition.</p>
<p style="text-align:center"><i>PartitionSize = SectorsCount * SizeOfOneSector</i></p>
<p>Another very important field is the <strong>partition type</strong> number. This number indicates the partition type or rather the &quot;filesystem type&quot;. In MBR, each filesystem type is assigned to a unique value between (0x00 to 0xFF). Originally, in the 1980s and early 90s, the field had just a few defined values like 0x01 for FAT12, 0x04 for FAT16 As more operating systems and filesystems emerged (e.g., NTFS, Linux ext, swap, HPFS, etc.) new values were assigned which was still manageable. Eventually, third parties started overloading the values ‚Äî meaning one type of code might refer to multiple possible formats. For example, the value 0x07 can be used for NTFS, HPFS, exFAT and QNX. Well this is a mess and in digital forensics we can use this field as an information but as this is not authoritative, we rely on partition identification validation using other methods that we will describe in the next blogpost of this series.</p>
<p>Finally, the MBR signature field. It occupies the last 2 bytes of the 512-byte MBR sector with the constant value of <strong>0x55AA</strong> (in hex) (or AA 55 as it appears in little-endian order in a hex editor). Just overwriting this field will lead to an unbootable system using a legacy BIOS. Malware authors can target the MBR when writing Wipers. Malware like  <a href="https://www.recordedfuture.com/research/whispergate-malware-corrupts-computers-ukraine" target="_blank" rel="noopener noreferrer">Whispergate</a> is a real-world example that is overriding the MBR bootloader section with a custom code to display a ransom note and override the first 199 bytes of each partition entry found.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ebr-the-ugly-fix-for-the-partition-entries-limitation">EBR: The ‚Äúugly‚Äù fix for the partition entries limitation<a href="#ebr-the-ugly-fix-for-the-partition-entries-limitation" class="hash-link" aria-label="Direct link to EBR: The ‚Äúugly‚Äù fix for the partition entries limitation" title="Direct link to EBR: The ‚Äúugly‚Äù fix for the partition entries limitation">‚Äã</a></h2>
<p>If you followed everything until now, well first: congrats and thank you. Secondly, you noticed that the MBR is limiting the number of partition entries to 4. That is not enought nowadays as modern systems are using way more partition entries like dualboot systems, servers with multiple partitions to separate system functions, and more.</p>
<p>To counteract this, IBM and Microsoft introduced the Extended Boot Record. EBR is a special partition table that is pointed by a standard MBR partition entry and is holding metadata for one logical partition at a time. It follows a scheme very similar to MBR (with the same signature) and holds only 2 partition entries:</p>
<ul>
<li>The first one is describing a logical partition</li>
<li>The second one is describing the location of another EBR partition</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/4-ef49a87b2763d90ec2ba4d2be1cedc84.svg" width="3406" height="2246" class="img_ev3q"></p>
<p>With this method you can chain as many partition as you wish and ‚Äúextend‚Äù the number of partitions you can fit into MBR. But this comes at the price of complexity and unused fields like the bootloader section of each EBR records. I haven‚Äôt been digging into research, but I guess letting these empty unused bootloader sections could be used by malware to hide malicious code in there. Might be worth investigating this possibility.</p>
<p>The MBR‚Äôs simplicity makes it widely supported, but also susceptible to tampering and limited in scalability compared to newer schemes like <strong>GPT</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="guid-partition-table-gpt-the-modern-layout">GUID Partition Table (GPT): The modern layout<a href="#guid-partition-table-gpt-the-modern-layout" class="hash-link" aria-label="Direct link to GUID Partition Table (GPT): The modern layout" title="Direct link to GUID Partition Table (GPT): The modern layout">‚Äã</a></h2>
<p>The GUID Partition Table (GPT) is the modern partitioning scheme that replaces MBR, offering greater flexibility, scalability, and reliability. It was introduced as part of the UEFI (Unified Extensible Firmware Interface) standard, GPT supports disks larger than 2 terabytes and allows for an almost unlimited number of partitions (up to 128 by default, compared to MBR‚Äôs limit of 4 primary partitions). Unlike MBR, we will use the LBA metric to describe the structure. As a reminder, 1 LBA = 1 Sector = 512 (0x200) bytes in our blog post series context.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/5-e8e50d50624ee2091b04bf299c2ac447.svg" width="1944" height="1823" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protective-mbr">Protective MBR<a href="#protective-mbr" class="hash-link" aria-label="Direct link to Protective MBR" title="Direct link to Protective MBR">‚Äã</a></h3>
<p>The Protective MBR (PMBR) is a compatibility trick used in the in GPT to protect GPT disks from being misinterpreted by older, MBR-only tools. That‚Äôs why the GPT Header is located at LBA 1. The PMBR is non-bootable and has a partition type value of 0xEE with a start LBA address at 0x1 and a number of sectors equal to the entire disk (or 0xFFFFFFF if the disk is too large). Its whole purpose is to prevents MBR-only tools (like old versions of fdisk or BIOS utilities) from thinking the disk is unpartitioned and say ‚ÄúThis is a GPT disk. Don‚Äôt mess with it.‚Äù It also gives us as a Digital Forensics Investigator the clue that we are dealing with GPT. We can also check the PMBR to see if it was corrupted or messed up with by a potential malware.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-gpt-header">The GPT Header<a href="#the-gpt-header" class="hash-link" aria-label="Direct link to The GPT Header" title="Direct link to The GPT Header">‚Äã</a></h3>
<p>The GPT Header is a 512-byte structure (typically) that sits at LBA 1 (right after the Protective MBR at LBA 0). It describes:
‚Ä¢	The layout of the GPT partition table
‚Ä¢	Where to find partition entries
‚Ä¢	How many partition entries exist
‚Ä¢	Redundant (backup) GPT structures</p>
<p><img decoding="async" loading="lazy" src="/assets/images/6-b1be6347a5427c2d87589a24a60f03ad.svg" width="2272" height="2758" class="img_ev3q"></p>
<p>The GPT Header is very helpful in order for the Investigator to identify the partitions but if it was tampered with or corrupted, we can still rely on the fact that the backup information are still present at the end of the volume. We will see how we can do that with Exhume in a later section.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-gpt-partition-entries">The GPT Partition entries<a href="#the-gpt-partition-entries" class="hash-link" aria-label="Direct link to The GPT Partition entries" title="Direct link to The GPT Partition entries">‚Äã</a></h3>
<p>Each partition entry in GPT includes a Globally Unique Identifier (GUID), a partition name, and CRC32 checksums for integrity verification that make GPT more robust and resistant to corruption than MBR. It also has attributes that can give us more specific information about the kind of filesystem and operating system we are dealing with.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/7-7fe9fb5a2e39f0dce1df3ee5773917d4.svg" width="1992" height="1292" class="img_ev3q"></p>
<p>GPT is now the default partitioning method for Windows, Linux, and macOS on UEFI-enabled hardware. However you can and you will still find a lot of MBR.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exhume-partitions-disk-layout-investigation">Exhume Partitions: Disk Layout Investigation<a href="#exhume-partitions-disk-layout-investigation" class="hash-link" aria-label="Direct link to Exhume Partitions: Disk Layout Investigation" title="Direct link to Exhume Partitions: Disk Layout Investigation">‚Äã</a></h2>
<p>We integrated MBR/EBR and GPT partition investigation capabilities into the Exhume ToolKit inside the &quot;exhume_partitions&quot; module. Let&#x27;s see how you can investigate a disk image layout using the CLI.</p>
<p>After installing <a href="https://www.forensicxlab.com/docs/exhume_partitions/getting-started" target="_blank" rel="noopener noreferrer">exhume partitions</a>, we can view the different options we can pass to the program using the <code>--help</code> argument.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/8-2cfed74f73eb4b0d4d5360eae41561f9.png" width="3936" height="1116" class="img_ev3q"></p>
<p>Let&#x27;s investigate a corrupted GPT Disk Image. In this case the main GPT Header at LBA 1 is no longer available. On the screenshot bellow, we can see the GPT Signature that is suppoed to be &quot;EFI PART&quot; in ASCII was modified to corrupt it.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/9-126e70f54fe8c3c99bd3852b14c0bfec.png" width="1260" height="732" class="img_ev3q"></p>
<p>Exhume as the capability to try to parse the backup GPT header and entries if the LBA 1 metadata are corrupted. Let&#x27;s witness it by using exhume_partition on this disk image.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/10-129db9e01b8fade6433b984e011884ba.png" width="7254" height="3396" class="img_ev3q"></p>
<p>We can see that the tool identified the PMBR, and didn&#x27;t successfully parse the GPT signature. It as reverted to the backup Header thus making the parsing possible.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="json-output">JSON output<a href="#json-output" class="hash-link" aria-label="Direct link to JSON output" title="Direct link to JSON output">‚Äã</a></h3>
<p>Let&#x27;s now say we want to use this output for our custom tool. We can use the <code>--json</code> argument to have the results of the disk layout in JSON. In the example bellow, we pipe the resulted output into jq to fetch some interesting info.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/11-ee38e0453d6103221db1930dc4cc53e4.png" width="4749" height="816" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-as-a-library">Using as a library<a href="#using-as-a-library" class="hash-link" aria-label="Direct link to Using as a library" title="Direct link to Using as a library">‚Äã</a></h3>
<p>Like all Exhume modules, you can use it as a library in your own rust based tools ! Learn more with the documentation: <a href="https://www.forensicxlab.com/docs/exhume_partitions/library" target="_blank" rel="noopener noreferrer">https://www.forensicxlab.com/docs/exhume_partitions/library</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">‚Äã</a></h2>
<p>We now have a new exhume module builded on top of Exhume Body to discover the layout of a disk image. In the next blogpost, we will dive into the forensic of the Extended FileSystem with Exhume ExtFS! We hope you enjoyed and learn things about MBR and GPT ! Join us on Discord if you want to participate to the project.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/thanatology">Thanatology</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/exhume">Exhume</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/digital-forensics">Digital Forensics</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/volweb-3-15"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">üì¶ VolWeb v3.15 July 2025 Release</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/thanatology-2"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">ü¶â Thanatology part 2: Multiple disk images formats handling using the Exhume ToolKit</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#discovering-a-disk-image-layout" class="table-of-contents__link toc-highlight">Discovering a Disk Image Layout</a><ul><li><a href="#metric-used-in-this-series" class="table-of-contents__link toc-highlight">Metric used in this series</a></li></ul></li><li><a href="#the-master-boot-record-mbr" class="table-of-contents__link toc-highlight">The Master Boot Record (MBR)</a><ul><li><a href="#partition-entries-in-mbr" class="table-of-contents__link toc-highlight">Partition entries in MBR</a></li></ul></li><li><a href="#ebr-the-ugly-fix-for-the-partition-entries-limitation" class="table-of-contents__link toc-highlight">EBR: The ‚Äúugly‚Äù fix for the partition entries limitation</a></li><li><a href="#guid-partition-table-gpt-the-modern-layout" class="table-of-contents__link toc-highlight">GUID Partition Table (GPT): The modern layout</a><ul><li><a href="#protective-mbr" class="table-of-contents__link toc-highlight">Protective MBR</a></li><li><a href="#the-gpt-header" class="table-of-contents__link toc-highlight">The GPT Header</a></li><li><a href="#the-gpt-partition-entries" class="table-of-contents__link toc-highlight">The GPT Partition entries</a></li></ul></li><li><a href="#exhume-partitions-disk-layout-investigation" class="table-of-contents__link toc-highlight">Exhume Partitions: Disk Layout Investigation</a><ul><li><a href="#json-output" class="table-of-contents__link toc-highlight">JSON output</a></li><li><a href="#using-as-a-library" class="table-of-contents__link toc-highlight">Using as a library</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 Forensicxlab</div></div></div></footer></div>
</body>
</html>