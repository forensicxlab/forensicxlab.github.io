<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">📘 Volatility3: Modern Windows Hibernation file analysis | Forensicxlab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://forensicxlab.github.io/blog/hibernation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="📘 Volatility3: Modern Windows Hibernation file analysis | Forensicxlab"><meta data-rh="true" name="description" content="In the Digital Forensics ecosystem, the field of memory forensics can help uncover artifacts that can’t be found anywhere else. That can include deleted files, network connections, running processes, rootkits, code injection, fileless malware and many more."><meta data-rh="true" property="og:description" content="In the Digital Forensics ecosystem, the field of memory forensics can help uncover artifacts that can’t be found anywhere else. That can include deleted files, network connections, running processes, rootkits, code injection, fileless malware and many more."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-10-27T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/k1n0ne"><meta data-rh="true" property="article:tag" content="DFIR,Volatility,Memory Forensics,Hibernation"><link data-rh="true" rel="canonical" href="https://forensicxlab.github.io/blog/hibernation"><link data-rh="true" rel="alternate" href="https://forensicxlab.github.io/blog/hibernation" hreflang="en"><link data-rh="true" rel="alternate" href="https://forensicxlab.github.io/blog/hibernation" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://forensicxlab.github.io/blog/hibernation","mainEntityOfPage":"https://forensicxlab.github.io/blog/hibernation","url":"https://forensicxlab.github.io/blog/hibernation","headline":"📘 Volatility3: Modern Windows Hibernation file analysis","name":"📘 Volatility3: Modern Windows Hibernation file analysis","description":"In the Digital Forensics ecosystem, the field of memory forensics can help uncover artifacts that can’t be found anywhere else. That can include deleted files, network connections, running processes, rootkits, code injection, fileless malware and many more.","datePublished":"2023-10-27T00:00:00.000Z","author":{"@type":"Person","name":"k1nd0ne","description":"Digital Forensics Spiderman","url":"https://github.com/k1n0ne","image":"https://avatars.githubusercontent.com/u/27780432?v=4"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://forensicxlab.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Forensicxlab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Forensicxlab Atom Feed"><link rel="stylesheet" href="/assets/css/styles.98b055e0.css">
<script src="/assets/js/runtime~main.626d0577.js" defer="defer"></script>
<script src="/assets/js/main.2850891d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/27780432?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ForensicXlab Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/thanatology">Thanatology</a><a class="navbar__item navbar__link" href="/docs/exhume">Exhume</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/forensicxlab" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://discord.gg/AqkYgR5HEg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/voliat">📦 Volatility3 : Import Address Table</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volads">📦 Volatility3 : Alternate Data Stream Scan</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/hibernation">📘 Volatility3: Modern Windows Hibernation file analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vols3">📘 Volatility3 - Remote analysis on cloud object-storage.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/steam">🔦 Video Games Forensics - Steam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/keepass">📦 Volatility3 Windows Plugin - KeePass</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/slug">Title</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ewf">🔦 Debunking the Expert Witness Compression Format (EWF)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/vision">🧬 Malware Analysis with VISION-ProcMon</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anydesk">📦 Volatility3 Windows Plugin - AnyDesk</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inodes">📦 Volatility3 Linux Plugin - Inodes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prefetch">📦 Volatility3 Windows Plugin - Prefetch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cb-brave">🖋 Cyberdefenders - Writeup - Brave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/volaslib">📘 Using Volatility3 as a library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/macisf">📄 Volatility3 - ISF for MacOs</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">📘 Volatility3: Modern Windows Hibernation file analysis</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-10-27T00:00:00.000Z">October 27, 2023</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/k-1-nd-0-ne"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/27780432?v=4" alt="k1nd0ne"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/k-1-nd-0-ne"><span class="authorName_yefp">k1nd0ne</span></a></div><small class="authorTitle_nd0D" title="Digital Forensics Spiderman">Digital Forensics Spiderman</small><div class="authorSocials_rSDt"><a href="https://x.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/k1nd0ne" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>In the Digital Forensics ecosystem, the field of memory forensics can help uncover artifacts that can’t be found anywhere else. That can include deleted files, network connections, running processes, rootkits, code injection, fileless malware and many more.</p>
<p>Microsoft introduced the hibernation feature in Windows 2000, allowing systems to be powered down while preserving their volatile state. This is achieved by saving RAM contents and processor context to a file called hiberfil.sys before shutting down inside the root folder of the filesystem drive. When the computer is turned on again, the system restores the volatile state from the saved file. Hibernation files are valuable for digital forensic professionals as they store temporary data from RAM to non-volatile storage, eliminating the requirement for specialized tools on the target device.</p>
<p>The Hibernation file structure has evolved in time. In this blog post, we will dive into the structure of the modern Windows hibernation file and propose a new translation layer for the volatility3 framework to create a raw memory image from a hibernation file.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-structure-of-a-modern-hibernation-file">The structure of a modern hibernation file<a href="#the-structure-of-a-modern-hibernation-file" class="hash-link" aria-label="Direct link to The structure of a modern hibernation file" title="Direct link to The structure of a modern hibernation file">​</a></h2>
<p>The structure of the hibernation file can be divided into two variations:</p>
<ul>
<li>From Windows XP to Windows 7 (old)</li>
<li>From Windows 8 to Windows 11 (modern)</li>
</ul>
<p>The following image represent the modern structure.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/1-724f00b186f3fc6032dc7c20875e1f64.png" title="Structure" width="3585" height="5621" class="img_ev3q"></p>
<p>In this blog post we will focus on the modern hibernation structure<sup><a href="#user-content-fn-1-602a43" id="user-content-fnref-1-602a43" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>, though you’ll notice that the underlying principle remains the same which is to compress and store the physical memory pages of the hibernated system in specific data structures called “restoration sets”.
 </p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-file-header">The file header<a href="#the-file-header" class="hash-link" aria-label="Direct link to The file header" title="Direct link to The file header">​</a></h3>
<p>The hibernation files start with a header called PO_MEMORY_IMAGE. The structure of this header may differ slightly depending on the operating system version, but its definition is publicly available in the kernel&#x27;s debugging symbols, which is very nice. The vergiliusproject<sup><a href="#user-content-fn-2-602a43" id="user-content-fnref-2-602a43" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup> gives us a nice description of this structure for each Windows version. Below is an example of the structure of the header.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/2-5829bdfa225b7b984b67e4f53f213111.png" title="Header" width="1139" height="1059" class="img_ev3q"></p>
<p>The signature of the file for an exploitable hibernation file is ‘<em>HIBR</em>’. The ‘<em>RSTR</em>’ signature indicates that the system is resuming from the file, making it apparently useless when this is the case. Valuable forensics artifacts are available like the system time when it was put into the hibernation state.</p>
<p>Notice the “<strong>FirstBootRestorePage</strong>” and “<strong>FirstKernelRestorePage</strong>” attributes. Those values are storing the page number of the first restoration sets. Mutiplying those values by the size of a Windows x64 page (4096) we get the offset of the sections.</p>
<p>Windows currently divide the storage of the memory pages in 2 locations :</p>
<ul>
<li>The boot section.</li>
<li>The kernel section.</li>
</ul>
<blockquote>
<p>You might notice the “SecureRestorePage” section, however this value seems to be always 0 and there is no publicly available explanation on what those pages are used for. It might be used in the future though to encrypt memory pages so only the host machine can decrypt them via its TPM?</p>
</blockquote>
<p>To know how many pages are stored for each sections the information can be retrieved from specific attributes:</p>
<ul>
<li>&quot;<strong>NumPagesForLoader</strong>&quot;: The number of pages in the &quot;Boot&quot; section</li>
<li>&quot;<strong>PerfInfo-&gt;KernelPagesProcessed</strong>&quot;: The number of pages in the &quot;Kernel&quot; section</li>
</ul>
<p>Unfortunately for us, the attribute storing the location and number of pages for the Kernel section did change with the Windows OS updates. Below is a table tracking those changes.</p>
<table><thead><tr><th>Windows Versions</th><th style="text-align:center">FirstKernelRestorePage  offset</th><th style="text-align:center">KernelPagesProcessed offset</th></tr></thead><tbody><tr><td>Windows 8/8.1</td><td style="text-align:center">0x68</td><td style="text-align:center">0x1C8</td></tr><tr><td>Windows 10 2016 1507-1511</td><td style="text-align:center">0x70</td><td style="text-align:center">0x218</td></tr><tr><td>Windows 10 2016 1607</td><td style="text-align:center">0x70</td><td style="text-align:center">0x220</td></tr><tr><td>Windows 10 2016 1703 - Windows 11 23H2</td><td style="text-align:center">0x70</td><td style="text-align:center">0x230</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-compression-sets">The compression sets.<a href="#the-compression-sets" class="hash-link" aria-label="Direct link to The compression sets." title="Direct link to The compression sets.">​</a></h3>
<p>A restoration set contains multiple <strong>compression sets</strong>. Each compression set contains a header structure giving information about how many page descriptors it contains, the compression algorithm used and the size of the compressed concatenated pages of the set.</p>
<p>The compression algorithm used can be one the following:</p>
<ul>
<li>None: the pages are stored uncompressed</li>
<li>Xpress: The pages are stored using the Microsoft Xpress LZ77 Algorithm <sup><a href="#user-content-fn-3-602a43" id="user-content-fnref-3-602a43" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></li>
<li>HuffmanXpress: The pages are stored using the Microsoft Xpress LZ77+Huffman Algorithm <sup><a href="#user-content-fn-3-602a43" id="user-content-fnref-3-602a43-2" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup> <sup><a href="#user-content-fn-4-602a43" id="user-content-fnref-4-602a43" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup></li>
</ul>
<p>All the page descriptors are located after the header and are describing where the pages reside in the decompressed data.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/3-29821d9c21906fce8efff01858ec9f6d.png" title="Structure" width="3111" height="2428" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-volatility3-translation-layer">Creating a volatility3 translation layer<a href="#creating-a-volatility3-translation-layer" class="hash-link" aria-label="Direct link to Creating a volatility3 translation layer" title="Direct link to Creating a volatility3 translation layer">​</a></h2>
<p>To be able to read multiple memory image formats, the volatility3 framework is using what’s called “Translation Layers”.  Each layer in volatility3 focuses on a particular aspect of memory forensics, such as parsing specific data structures, analyzing various kinds of artifacts, or understanding specific evidence formats. The layers can be seen as individual building blocks that can be stacked on top of each other in a specific order to build the right context before extracting data for analysis. As an example, a memory image with the &quot;vmem&quot; format will induce the stacking of the &quot;VmwareLayer&quot; to be able to read such file format and extract memory pages.</p>
<p>In our case, when the framework is requesting several bytes at a specific physical address, it needs to understand the structure of the hibernation file and how to extract the right pages. For this, we have to indicate to the framework for a given memory “segment”, the corresponding set of pages.</p>
<p>The Hibernation layer role is to provide the volatility framework with the following information :</p>
<ul>
<li>Check the file header to see if the layer needs to be stacked (check the signature to verify it is a hibernation file)</li>
<li>Build a list of segments: A segment is here to translates a given physical address to an offset inside of the uncompressed data of the relevant compression set.</li>
<li>Provide the decompression method for a given segment: Our layer needs to be able to decompress a given compression set and returns the number of bytes requested by the upper layer.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/4-e402600b47ddbcae56e7987da7377cab.png" title="Structure" width="2854" height="2402" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-of-the-different-compression-algorithms">Implementation of the different compression algorithms<a href="#implementation-of-the-different-compression-algorithms" class="hash-link" aria-label="Direct link to Implementation of the different compression algorithms" title="Direct link to Implementation of the different compression algorithms">​</a></h3>
<p>Windows is using two proprietary compression algorithms to compress the pages:</p>
<ul>
<li>Xpress: The Microsoft Xpress LZ77 Decompression Algorithm <sup><a href="#user-content-fn-3-602a43" id="user-content-fnref-3-602a43-3" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></li>
<li>HuffmanXpress: Microsoft Xpress LZ77+Huffman Decompression Algorithm <sup><a href="#user-content-fn-3-602a43" id="user-content-fnref-3-602a43-4" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup> <sup><a href="#user-content-fn-4-602a43" id="user-content-fnref-4-602a43-2" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup></li>
</ul>
<p>Those two algorithms were implemented and added to the volatility3 framework codecs without the needs of using the Windows API via cstruct (making this layer OS independant). Those algorithms are well documented but python3 is not really the best programming language to perform bitwise operations. Thus the developpement of those two algorithm took time to make sure that the decompressed page using our implementation is giving the same result as the native API <sup><a href="#user-content-fn-5-602a43" id="user-content-fnref-5-602a43" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="proof-of-concept">Proof Of Concept<a href="#proof-of-concept" class="hash-link" aria-label="Direct link to Proof Of Concept" title="Direct link to Proof Of Concept">​</a></h3>
<p>After implementing this new translation layer, it was time to test it against multiple hibernation files. Knowing that we need to do a lot of decompressions operations, the hibernation layer is meant to be combine with the “layerwriter” plugin to create a raw memory image and then analyze it with the windows plugins. Indeed, the decompression of a set takes time and most of the plugin need to scan the entire memory dump pages making a lot of decompression operations thus slowing the framework. Creating a raw memory dump first is the best approach here for performances. To this end, 2 new plugins were added to the volatility3 framework:</p>
<ul>
<li><strong>windows.hibernation.Info</strong> : Display the basic information about the hibernation file and if it seems exploitable.</li>
<li><strong>windows.hibernation.Dump</strong> : Convert the hibernation file into a raw memory dump (based on the layerwriter plugin)</li>
</ul>
<p>The generation of the raw memory file was performed on 8 hibernations files from different versions of Windows:</p>
<table><thead><tr><th>Version / Target</th><th style="text-align:center">hiberfile size</th><th style="text-align:center">Conversion time</th></tr></thead><tbody><tr><td>Windows 8 x64 / Laptop</td><td style="text-align:center">8GB</td><td style="text-align:center">~30 minutes</td></tr><tr><td>Windows 10 1507 x64 / Laptop</td><td style="text-align:center">8GB</td><td style="text-align:center">~20 minutes</td></tr><tr><td>Windows 10 1607 x64 / Laptop</td><td style="text-align:center">8GB</td><td style="text-align:center">~20 minutes</td></tr><tr><td>Windows 10 1809 x64 / KVM</td><td style="text-align:center">8GB</td><td style="text-align:center">~10 minutes</td></tr><tr><td>Windows 10 1809 x64 / KVM</td><td style="text-align:center">4GB</td><td style="text-align:center">~5 minutes</td></tr><tr><td>Windows 10 22H02 x64 / Laptop</td><td style="text-align:center">8GB</td><td style="text-align:center">~60 minutes</td></tr><tr><td>Windows 10 22H02 x64 / Laptop</td><td style="text-align:center">16GB</td><td style="text-align:center">~100 minutes</td></tr><tr><td>Windows 11 23H02 x64 / Laptop</td><td style="text-align:center">8GB</td><td style="text-align:center">~100 minutes</td></tr></tbody></table>
<blockquote>
<p><strong>Note :</strong> On Windows 1809 hiberfile from a KVM, it was found that pages were located only in the boot section and none in the kernel section. The compressed data were either using the Xpress LZ77 compression or were not compressed but the Huffman variant was not identified. On Windows 22H2, most of the pages are located inside the kernel section using both plain LZ77 and LZ77+Huffman compression. It is not clear how Microsoft decides which compression algorithm is used and if both sections are used to store the pages.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usage--conversion">Usage : Conversion<a href="#usage--conversion" class="hash-link" aria-label="Direct link to Usage : Conversion" title="Direct link to Usage : Conversion">​</a></h4>
<p>Firstly, we check if the hibernation file seems exploitable :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/volatility3» ./vol.py -f hiberfil_Win10_1507.sys windows.hibernation.Info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  100.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Variable        Value</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Signature       b&#x27;HIBR&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PageSize        4096</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Comment The hibernation file header signature is correct.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System Time     2023-11-03 20:32:25</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FirstBootRestorePage    0x23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NumPagesForLoader       32199</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, we can try to convert the hibernation file to a raw file:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/volatility3» ./vol.py -f hiberfil_Win10_1507.sys windows.hibernation.Dump -h</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">usage: volatility windows.hibernation.Dump [-h] --version VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">optional arguments:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -h, --help         show this help message and exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --version VERSION  The Windows version of the hibernation file :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        0=&gt;[Windows 10 1703 to Windows 11 23H2]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        1=&gt;[Windows 8/8.1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        2=&gt;[Windows 10 1507 to 1511]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        3=&gt;[Windows 10 1607]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/volatility3» ./vol.py -f hiberfil_Win10_1507.sys windows.hibernation.Dump --version 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:   99.99               Writing layer memory_layer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The hibernation file was converted to memory_layer.raw</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-pslist">Example: pslist<a href="#example-pslist" class="hash-link" aria-label="Direct link to Example: pslist" title="Direct link to Example: pslist">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/volatility3» ./vol.py -f memory_layer.raw windows.pslist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  100.00		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PID	PPID	ImageFileName	Offset(V)	Threads	Handles	SessionId	Wow64	CreateTime	ExitTime	File output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4	0	System	0xe5072e280300	182	-	N/A	False	2023-09-30 14:52:10.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">136	4	Registry	0xe5072e2ee040	4	-	N/A	False	2023-09-30 14:52:09.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">400	4	smss.exe	0xe507322aa0c0	3	-	N/A	False	2023-09-30 14:52:10.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">532	484	csrss.exe	0xe50732242140	13	-	0	False	2023-09-30 14:52:11.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">628	484	wininit.exe	0xe50734c6a080	5	-	0	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">636	620	csrss.exe	0xe50734c6f140	13	-	1	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">700	628	services.exe	0xe50734cf0100	17	-	0	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">708	628	lsass.exe	0xe50734d25080	9	-	0	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">840	700	svchost.exe	0xe50734d8e280	29	-	0	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">868	628	fontdrvhost.ex	0xe50734db9180	5	-	0	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">932	700	svchost.exe	0xe50734b25540	13	-	0	False	2023-09-30 14:52:12.000000 	N/A	Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[TRUNCATED]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example--netscan">Example : netscan<a href="#example--netscan" class="hash-link" aria-label="Direct link to Example : netscan" title="Direct link to Example : netscan">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~/work/DFIR/volatility3» ./vol.py -f memory_layer.raw windows.netscan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Volatility 3 Framework 2.5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Progress:  100.00		PDB scanning finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Offset	Proto	LocalAddr	LocalPort	ForeignAddr	ForeignPort	State	PID	Owner	Created</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe507320e1b00	TCPv4	127.0.0.1	49743	127.0.0.1	49742	ESTABLISHED	6660	RiotClientServ	2023-09-30 14:52:33.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50733c5ba60	TCPv4	192.168.122.74	49883	8.247.201.124	443	ESTABLISHED	6660	RiotClientServ	2023-09-30 14:52:38.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734ab2d00	TCPv4	0.0.0.0	135	0.0.0.0	0	LISTENING	932	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734ab2d00	TCPv6	::	135	::	0	LISTENING	932	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734ab2e50	TCPv4	0.0.0.0	49664	0.0.0.0	0	LISTENING	628	wininit.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734ab2e50	TCPv6	::	49664	::	0	LISTENING	628	wininit.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734ab34e0	TCPv4	0.0.0.0	49664	0.0.0.0	0	LISTENING	628	wininit.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734ab38d0	TCPv4	0.0.0.0	135	0.0.0.0	0	LISTENING	932	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe50734d624e0	TCPv4	192.168.122.74	49687	20.223.46.67	443	ESTABLISHED	2552	MsMpEng.exe	2023-09-30 14:52:17.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540a990	TCPv4	192.168.122.74	139	0.0.0.0	0	LISTENING	4	System	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540b410	TCPv4	0.0.0.0	49665	0.0.0.0	0	LISTENING	952	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540b800	TCPv4	0.0.0.0	49666	0.0.0.0	0	LISTENING	1416	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540c130	TCPv4	0.0.0.0	49666	0.0.0.0	0	LISTENING	1416	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540c130	TCPv6	::	49666	::	0	LISTENING	1416	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540c3d0	TCPv4	0.0.0.0	49665	0.0.0.0	0	LISTENING	952	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xe5073540c3d0	TCPv6	::	49665	::	0	LISTENING	952	svchost.exe	2023-09-30 14:52:12.000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[TRUNCATED]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>For all tested files, the framework was able to extract and decompress all of the pages in each restoration sets. The hibernation layer <strong>currently only support Windows 8 x64 to Windows 11 23H2 x64 hibernation files</strong>. Windows server hibernation analysis was not tested yet but it will come in time. Hopping the forensics community will also test this new addition and give some feedback to improve this layer. You can find the feature here: <a href="https://github.com/forensicxlab/volatility3/tree/feature/hibernation-layer" target="_blank" rel="noopener noreferrer">https://github.com/forensicxlab/volatility3/tree/feature/hibernation-layer</a>.</p>
<p>Hoping this article will bring back the interests of the Digital Forensics community to hibernation files which are very valuable when available.</p>
<p>Special thanks to Chad Tilbury @chadtilbury who gave me the motivation to dive into this project and the team of researchers behind the Hibernation file structure analysis (Joe T. Sylve, Vico Marziale, Golden G. Richard III).</p>
<blockquote>
<p>Do not hesitate to reach me at <a href="mailto:felix.guyard@forensicxlab.com" target="_blank" rel="noopener noreferrer">felix.guyard@forensicxlab.com</a> to enhance this article or to comment on the integration to the volatility framework.</p>
</blockquote>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-602a43">
<p><a href="https://www.cct.lsu.edu/~golden/Papers/sylvehiber.pdf" target="_blank" rel="noopener noreferrer">https://www.cct.lsu.edu/~golden/Papers/sylvehiber.pdf</a> <a href="#user-content-fnref-1-602a43" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-602a43">
<p><a href="https://www.vergiliusproject.com/kernels/x64/Windows%2011/Insider%20Preview%20(Jun%202021)/PO_MEMORY_IMAGE" target="_blank" rel="noopener noreferrer">https://www.vergiliusproject.com/kernels/x64/Windows%2011/Insider%20Preview%20(Jun%202021)/PO_MEMORY_IMAGE</a> <a href="#user-content-fnref-2-602a43" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-3-602a43">
<p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-xca/a8b7cb0a-92a6-4187-a23b-5e14273b96f8" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-xca/a8b7cb0a-92a6-4187-a23b-5e14273b96f8</a> <a href="#user-content-fnref-3-602a43" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a> <a href="#user-content-fnref-3-602a43-2" data-footnote-backref="" aria-label="Back to reference 3-2" class="data-footnote-backref">↩<sup>2</sup></a> <a href="#user-content-fnref-3-602a43-3" data-footnote-backref="" aria-label="Back to reference 3-3" class="data-footnote-backref">↩<sup>3</sup></a> <a href="#user-content-fnref-3-602a43-4" data-footnote-backref="" aria-label="Back to reference 3-4" class="data-footnote-backref">↩<sup>4</sup></a></p>
</li>
<li id="user-content-fn-4-602a43">
<p><a href="https://raw.githubusercontent.com/Velocidex/go-prefetch/master/lzxpress.go" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/Velocidex/go-prefetch/master/lzxpress.go</a> <a href="#user-content-fnref-4-602a43" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">↩</a> <a href="#user-content-fnref-4-602a43-2" data-footnote-backref="" aria-label="Back to reference 4-2" class="data-footnote-backref">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-5-602a43">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/cmpapi/using-the-compression-api" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/windows/win32/cmpapi/using-the-compression-api</a> <a href="#user-content-fnref-5-602a43" data-footnote-backref="" aria-label="Back to reference 5" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/dfir">DFIR</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/volatility">Volatility</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/memory-forensics">Memory Forensics</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/hibernation">Hibernation</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/volads"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">📦 Volatility3 : Alternate Data Stream Scan</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/vols3"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">📘 Volatility3 - Remote analysis on cloud object-storage.</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-structure-of-a-modern-hibernation-file" class="table-of-contents__link toc-highlight">The structure of a modern hibernation file</a><ul><li><a href="#the-file-header" class="table-of-contents__link toc-highlight">The file header</a></li><li><a href="#the-compression-sets" class="table-of-contents__link toc-highlight">The compression sets.</a></li></ul></li><li><a href="#creating-a-volatility3-translation-layer" class="table-of-contents__link toc-highlight">Creating a volatility3 translation layer</a><ul><li><a href="#implementation-of-the-different-compression-algorithms" class="table-of-contents__link toc-highlight">Implementation of the different compression algorithms</a></li><li><a href="#proof-of-concept" class="table-of-contents__link toc-highlight">Proof Of Concept</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Forensicxlab</div></div></div></footer></div>
</body>
</html>